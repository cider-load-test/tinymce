# MODx Database Script for New/Upgrade Installations
#
# Each sql command is separated by double lines


#
# Dumping data for table `keyword_xref`
#


REPLACE INTO `{PREFIX}keyword_xref` VALUES ('5','1');


REPLACE INTO `{PREFIX}keyword_xref` VALUES ('4','1');


#
# Dumping data for table `documentgroup_names`
#


REPLACE INTO `{PREFIX}document_groups` VALUES ('15','2','3');


REPLACE INTO `{PREFIX}documentgroup_names` VALUES ('2','Site Admin Pages','0','0');


#
# Dumping data for table `site_content`
#


REPLACE INTO `{PREFIX}site_content` VALUES ('1','document','text/html','Home','Welcome to MODx','Introduction to MODx','index','1','0','0','0','0','Create and do amazing things with MODx','<h3>Install Successful!</h3>\r\n<p>You have successfully installed and configured MODx. We hope you find this site an adequate starting configuration for many small business, organization or personal websites; just change out the template and you\'ll be good to go! This site is preconfigured with a variety of options we hope are helpful, relevant and just plain cool for many marketing or personal sites. Click the bold title links to learn more about the following features:</p>\r\n<ul>\r\n    <li><strong><a href=\"[~2~]\">Simple Blog</a>.</strong> When logged into your site, you\'ll be able to create new entries from the front end. This can also be turned into a News publishing or PR publishing system.</li>\r\n    <li><strong><a href=\"[~9~]\">Easy Comments</a>.</strong> When logged into your site, your registered site users can comment on your posts. </li>\r\n    <li><strong><a href=\"[~11~]\">RSS Feeds</a>.</strong> Feeds for your site automatically get pushed out so your site visitors can stay up to date. </li>\r\n    <li><strong><a href=\"[~5~]\">Automatic User Registration</a>.</strong> Those that wish to comment on blogs must first create an account. This comes pre-configured with a &quot;Captcha&quot; anti-robot registration feature.</li>\r\n    <li><strong><a href=\"[~14~]\">QuickEdit</a>.</strong> When you\'re logged into the manager, you can edit a page directly from the front end!. </li>\r\n    <li><strong><a onclick=\"new Effect.Highlight(\'search\')\" href=\"#search\">Integrated Site Search</a>.</strong> Allows visitors to search only the pages you wish them to search. </li>\r\n    <li><strong><a href=\"[~22~]\">Powerful UL-based Navigation Builder</a>.</strong> Duplicate or build virtually any CSS-based unordered list navigation system with our dynamic menu builder code.</li>\r\n    <li><strong><a href=\"[~16~]\">Scrip.aculo.us enabled</a>.</strong> You\'re on your way to Web 2.0 and AJAX goodness!</li>\r\n    <li><strong><a href=\"[~7~]\">Custom &quot;page not found (404)&quot; page</a>.</strong> Help visitors who go astray to find what they\'re looking for. </li>\r\n    <li><strong><a href=\"[~6~]\">Contact Us form</a>.</strong> A highly configurable contact form you <em>should</em> customize to point to the right email address. Comes pre-configured to prevent mail-form-injection so your site does <em>not</em> become a source for spam. </li>\r\n    <li><strong><a onclick=\"new Effect.Highlight(\'navlist\')\" href=\"#navlist\">Related Links on each page</a>.</strong> Link your site pages together using keywords. </li>\r\n    <li><strong><a onclick=\"new Effect.Highlight(\'recentdocs\')\" href=\"#recentdocs\">Newest documents list</a>.</strong> Shows your visitor the three most recently added pages (configurable). </li>\r\n</ul>\r\n<p><strong>To log into the MODx Control Panel and start customizing this site, point your browser to <a href=\"manager\">[(site_url)]manager/</a>.</strong></p>','1','1','1','1','1','1','1087155171','4','1130051393','0','0','0','Home','0','1','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('3','document','text/html','Add a Blog Entry','Add a Blog Entry','','add-a-blog-entry','1','0','0','2','0','','[!NewsPublisher? &folder=`2` &canpost=`Site Admins` &formtpl=`FormBlog` &footertpl=`FormBlogComments` &makefolder=`1` &rtcontent=`tvblogContent`!]','0','1','2','0','0','1','1126035172','3','1130011360','0','0','0','Add Blog Entry','1','0','0','1','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('2','document','text/html','Blog','My Blog','','blog','1','0','0','0','1','','[[NewsLister? &amp;startID=`2` &amp;summarize=`2` &amp;total=`20` &amp;commentschunk=`FormBlogComments`]]','1','1','1','0','0','1','1090963494','2','1130166294','0','0','0','Blog','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('4','document','text/html','[*loginName*]','Login to Enable to Comments','','login','1','0','0','0','0','','<p>In order to comment on blog entries, you must be a registered user of [(site_name)]. If you haven\'t already registered, you can  <a href=\"[~5~]\">request an account</a>.</p>\r\n<div> [!WebLogin? &amp;formtpl=`FormLogin` &loginhomeid=`2`!] </div>','1','1','99','0','0','1','1126037994','2','1130167015','0','0','0','[*loginName*]','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('6','document','text/html','Contact Us','Contact [(site_name)]','','contact-us','1','0','0','0','0','','[[ContactForm? &sendTo=`[(emailsender)]`]]','0','1','5','1','0','1','1126048618','1','1129750946','0','0','0','Contact us','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('7','document','text/html','404 - Document Not Found','Uh oh ... it\'s a 404! (Page Not Found)','','doc-not-found','1','0','0','0','0','','<p>Looks like you tried to go somewhere that does not exist... perhaps you <a href=\"\">need to login</a> or you\'d like one of the following pages instead:</p>\r\n\r\n[[DropMenu? &showDescription=`1`]]\r\n\r\n<h3>Want to find it the old fashioned way? Search away:</h3>\r\n\r\n[!FlexSearchForm? &FSF_landing=`8`!]\r\n\r\n\r\n<h3>Still not finding what you\'re looking for? Let us know:</h3>\r\n\r\n[!404form!]\r\n\r\n','1','1','6','0','1','1','1126065379','2','1128967591','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('5','document','text/html','Request an Account','Sign Up for Full Site Priveleges','','request-an-account','1','0','0','0','0','','[[WebSignup? &formtpl=`FormSignup` &groups=`Registered Users`]]','1','1','4','0','0','1','1126038533','2','1129906384','0','0','0','','0','1','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('8','document','text/html','Search Results','Your Search Results','','search-results','1','0','0','0','0','','[[FlexSearchForm? &FSF_showForm=`0`]]','0','1','7','0','0','1','1126079515','1','1126079619','0','0','0','','1','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('9','document','text/html','Mini-Blog HOWTO','How to Start Posting with MODx Mini-Blogs','','article-1126081344','1','0','0','2','1','','<p>Setting up a mini-blog is relatively simple. Here\'s what you need to do to get started with making new posts:</p>\r\n<ol>\r\n    <li>Login to the <a target=\"_blank&quot;\" href=\"[(site_url)]manager/\">MODx Control Panel</a>.</li>\r\n    <li>Create a new Webuser by clicking the <strong>Users &gt; Manage web users</strong> link.</li>\r\n    <li>Make sure to check the <strong>Site Admins</strong> Webuser Group at the bottom of the page.</li>\r\n    <!-- splitter -->\r\n    <li>Go to the <a target=\"_blank&quot;\" href=\"[~4~]\">login page</a> and login using this newly created Webuser information.</li>\r\n    <li>You should now notice a new <a target=\"_blank&quot;\" href=\"[~3~]\">Add a Blog Entry</a> menu item that automatically appeared under the Blog Page link in the right column.</li>\r\n</ol>\r\n{{FormBlogComments}}','1','1','0','1','1','-1','1130009281','4','1130050224','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('11','document','text/xml','RSS Feeds','[(site_name)] RSS 2.0  Feeds','','feed','1','0','0','0','0','','[[NewsFeed?newsfolder=`2`]]','1','0','8','0','0','1','1126101752','3','1128715646','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('14','document','text/html','QuickEdit','How to use the QuickEdit Feature','','quickedit','1','0','0','15','0','','<h2>Table of Contents</h2>\r\n<ul>\r\n    <li><a href=\"#who\">Who?</a></li>\r\n    <li><a href=\"#what\">What?</a></li>\r\n    <li><a href=\"#why\">Why?</a></li>\r\n    <li><a href=\"#how\">How?</a>\r\n    <ul>\r\n        <li><a href=\"#how-tag\">Tag method</a></li>\r\n        <li><a href=\"#how-html\">HTML method</a></li>\r\n        <li><a href=\"#how-links\">Custom links method</a></li>\r\n    </ul>\r\n    </li>\r\n    <li><a href=\"#faq\">FAQ</a>\r\n    <ul>\r\n        <li><a href=\"#custom_styles\">Can I use my own styles for the links?</a></li>\r\n        <li><a href=\"#no_add\">Why can\'t I add/publish/delete/move a page?</a></li>\r\n        <li><a href=\"#highlight\">The highlight feature is highlighting more than it should.</a></li>\r\n        <li><a href=\"#link_cache\">Will the edit links get cached?</a></li>\r\n        <li><a href=\"#not_visible\">How do I edit content that\'s not visible on the page?</a></li>\r\n        <li><a href=\"#link_cache\">Can I hide the links from certain people?</a></li>\r\n        <li><a href=\"#cant_see\">I don\'t see the links; what am I doing wrong?</a></li>\r\n    </ul>\r\n    </li>\r\n</ul>\r\n<a name=\"who\"></a>\r\n<h3>Who\'s responsible for the QuickEdit module?</h3>\r\n<p>QuickEdit was originally written by <a href=\"mailto:adam@obledisgn.com\">Adam Crownoble</a>. It is now a core module and is supported by the MODx community. If you have questions or comments about the module you can contact <a href=\"mailto:adam@obledesign.com\">Adam</a> directly or use the <a target=\"_blank\" href=\"http://www.modxcms.com/forums/\">MODx forums</a>.</p>\r\n<a name=\"what\"></a>\r\n<h3>What does QuickEdit do?</h3>\r\n<p>QuickEdit allows you to edit the content of your site right from the page. It\'s so simple, it makes editing a webpage about as complex as sending an email.</p>\r\n<a name=\"why\"></a>\r\n<h3>Why not just use the manager?</h3>\r\n<p>The manager is a very powerful tool but sometimes it\'s overkill for simple edits. Also, the manager can be very intimidating to the not-so-web-savvy.</p>\r\n<a name=\"how\"></a>\r\n<h3>How do I use QuickEdit?</h3>\r\n<p>There are currently three different methods for using QuickEdit links. Some are designed for ease, others are designed for flexibility. You can use any combination of the three methods in a page.</p>\r\n<a name=\"how-tag\"></a>\r\n<h3>Tag Method</h3>\r\n<p>This is the simplest method of all, and is therefore the recommended method.</p>\r\n<p>To use the tag method, just replace the typical <code>[*tv-name*]</code> style tags with <code>[*#tv-name*]</code> style tags Example: <code>[*#content*]</code> That\'s all there is to it. The module will take care of the rest.</p>\r\n<a name=\"how-html\"></a>\r\n<h3>HTML Method</h3>\r\n<p>The HTML method allows you to place the edit links wherever you like while still allowing QuickEdit to show or hide the links based on user permissions.</p>\r\n<p>To use the HTML method, simply insert custom &lt;quickedit&gt; tags wherever you want the links to be. The tags must be in the format <code>&lt;quickedit:content /&gt;</code>. Replace <strong>content</strong> with the name or ID of the template variable you want to edit.</p>\r\n<a name=\"how-links\"></a>\r\n<h3>Custom Links Method</h3>\r\n<p>This method is for advanced users only. We do not suggest that you use the custom links method but if you have very specific needs it may be the best choice for your situation.</p>\r\n<p>To use the custom links method just insert normal links anywhere in your template. Two example links are provided for you below. If you use this method you must realize that the links are like any other link and will be visible to any user or visitor.</p>\r\n<p> Javascript (recommended): <code>window.open(\'index.php?a=112&amp;id=[QuickEdit module id]&amp;doc=[*id*]&amp;var=content\', \'QuickEditor\', \'width=525, height=300, toolbar=0, menubar=0, status=0, alwaysRaised=1, dependent=1\');</code><br />  Link Tag: <code>&lt; href=&quot;index.php?a=112&amp;id=[QuickEdit module id]&amp;doc=[*id*]&amp;var=content&quot; target=&quot;_blank&quot;&gt;Edit&lt;/a&gt;</code> </p>\r\n<p><em>Be sure to replace each <strong>[QuickEdit module id]</strong> above with the actual numeric id of the QuickEdit module on your system.</em></p>\r\n<a name=\"faq\"></a>\r\n<h3>Frequently Asked Questions</h3>\r\n<a name=\"custom_styles\"></a>\r\n<h3>Can I use my own styles for the links?</h3>\r\n<p>Sure. QuickEdit uses the styles in the output.css file in the quick_edit module folder. To apply your own styles just replace the styles in the output.css file with your own styles. If you\'d rather store the styles somewhere else you can always just delete the content of output.css and use your own style sheets. QuickEdit uses two style classes to do it\'s styling: <strong>QuickEditLink</strong> and <strong>QuickEditParent</strong>. <strong>QuickEditLink</strong> defines the actual edit link while <strong>QuickEditParent</strong> defines the styles that are applied to the editable area when you hover over the links.</p>\r\n<a name=\"no_add\"></a>\r\n<h3>Why can\'t I add/publish/delete/move a page?</h3>\r\n<p>QuickEdit does not support anything other than simple edits at this point. We are planning on incorporating these and other features in future releases.</p>\r\n<a name=\"highlight\"></a>\r\n<h3>The highlight feature is highlighting more than it should.</h3>\r\n<p>Try putting the template variable in a span or div. Example: <code>&lt;div&gt;[*#longtitle*]&lt;/div&gt;</code></p>\r\n<a name=\"not_visible\"></a>\r\n<h3>How do I edit content that\'s not visible on the page?</h3>\r\n<p>You\'ll have to use the <a href=\"#how-html\">HTML Method</a> or <a href=\"#how-links\">Custom Link Method</a> to create these sort of links.</p>\r\n<a name=\"hide_links\"></a>\r\n<h3>Can I hide the links from certain users?</h3>\r\n<p>Of course, this is done dynamically just set the permissions on the Template Variables like normal.</p>\r\n<a name=\"link_cache\"></a>\r\n<h3>Will the edit links get cached?</h3>\r\n<p>No they won\'t. A visitor to the site who hasn\'t logged in will see a version of the page that should be no different than the way it would look without QuickEdit.</p>\r\n<a name=\"cant_see\"></a>\r\n<h3>I don\'t see the links; what am I doing wrong?</h3>\r\n<p>Did you follow the <a href=\"#how-tag\">Tag method</a>? Give this a try, it is the simplest way to get started.</p>\r\n<p>If the tag method didn\'t do it, click the <strong>Refresh site</strong> link from the manager to clear your cache. Cached pages can be an issue if they were cached before installing or enabling the QuickEdit plugin, from that point on the cache shouldn\'t be an issue.</p>\r\n<p>If you still don\'t see them then try to login as the admin user. Do you see them? Then your problem is with permissions. QuickEdit permissions can be tricky because there are a lot of things to check. First of all make sure that the user has Edit Documents, Save Documents, and Run Module rights. Then check that he has rights to the page. Then check the users rights to the QuickEdit module and to any Template Variables on the page.</p>\r\n<p>Still no luck? go to the <a target=\"_blank\" href=\"http://www.modxcms.com/forums\">MODx community forums</a> and do a quick search to see if your problem has already been addressed. If you don\'t find anything then post a new topic in the <a target=\"_blank\" href=\"http://modxcms.com/forums/index.php/board,10.0.html\">General Support</a> discussion board.</p>','1','1','9','1','1','1','1127939508','4','1130049076','0','0','0','QuickEdit','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('15','document','text/html','MODx Quickstart','','','quickstart','1','0','0','0','1','','','1','0','10','1','1','1','1127939818','1','1128374562','0','0','0','Quickstart Guide','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('16','document','text/html','Script.aculo.us','Script.aculo.us: Web 2.0 and AJAX platform','','script.aculo.us','1','0','0','15','0','','<quote>\r\n      <em>script.aculo.us</em> provides you with <em>easy-to-use</em>, <em>compatible</em> and, ultimately, totally cool <em>JavaScript libraries</em> to <strong>make your web sites and web applications fly, Web 2.0 style</strong>. \r\n</quote>\r\n<p> &mdash; <a href=\"http://script.aculo.us/\" target=\"_blank\">from script.aculo.us</a></p>\r\n\r\n<h3>So what\'s it mean to me?</h3>\r\n<p>Scriptaculous makes it easy to apply effects to page elements and to perform AJAX-style communications so you don\'t have to constantly reload pages for things like submitting forms. This mean much less data goes across the wires (or airwaves, if you\'re WiFi-enabled), and makes your website behave more like a desktop application.</p>\r\n\r\n<p>Of course you can go overboard with it and wind up with a cheesy mess of unusable code, but used properly, great things can happen.</p>\r\n\r\n<p>Scriptaculous offers some general categories of effects and capabilties:</p>\r\n<ul>\r\n<li>Numerous visual effects (see <a href=\"http://wiki.script.aculo.us/scriptaculous/show/CombinationEffectsDemo\" target=\"_blank\">effects demos</a>).</li>\r\n<li>Drag and drop sorting (see <a href=\"http://wiki.script.aculo.us/scriptaculous/show/SortableFloatsDemo\" target=\"_blank\">effects demos</a>).</li>\r\n<li>Auto completion in fields (see <a href=\"http://script.aculo.us/demos/ajax/autocompleter\" target=\"_blank\">effects demos</a>).</li>\r\n<li><a href=\"http://wiki.script.aculo.us/scriptaculous/show/Demos\" target=\"_blank\">And more...</a></li>\r\n</ul>\r\n\r\n<p> Scriptaculous also incorporates the robust and powerful <a href=\"http://prototype.conio.net/\" target=\"_blank\">Prototype Javascript Framework</a>.</p>','1','1','1','1','1','1','1128012596','1','1128012596','0','0','0','Script.aculo.us','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('32','document','text/html','Design Credit','Site Design Credits','','design-credit','1','0','0','0','0','','<p>The default site is built using a validating XHTML/CSS layout inspired by a variety of great individuals including:</p>\r\n<ul>\r\n<li>layout inspired via <a target=\"_blank\" href=\"http://www.simplebits.com/work/blogger/\">Dan Cederholm\'s Blogger work</a></li>\r\n<li>the &quot;best practices&quot; <a target=\"_blank\" href=\"http://www.subtraction.com/archives/2005/0822_free_form_fo.php\">forms styling of Khoi Vihn</a></li>\r\n<li>type styling guildlines from <a target=\"_blank\" href=\"http://www.markboulton.co.uk/journal/comments/five_simple_steps_to_better_typography_part_4/\">web type (and grid!) guru Mark Boulton</a></li>\r\n<li>XHTML/CSS inspirations and teachings (in alphabetical order): <a target=\"_blank\" href=\"http://www.positioniseverything.net/\">John Gallant</a>, <a target=\"_blank\" href=\"http://www.meyerweb.com/\">Eric Meyer</a>, <a target=\"_blank\" href=\"http://www.csszengarden.com/\">David Shea</a> and <a target=\"_blank\" href=\"http://www.alistapart.com/\">Jeffrey Zeldman</a></li>\r\n</ul>\r\n</p>\r\n','1','1','15','1','1','2','1130018563','2','1130018679','0','0','0','Design Credits','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('18','document','text/html','Just a pretend, older post','This post should in fact be archived','','article-1128398162','1','0','0','2','1','','<p>Not so exciting, after all, eh?<br /></p>\r\n{{FormBlogComments}}','1','1','2','1','1','-1','1128398162','1','1130020343','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('19','document','text/html','Mini-Blog HOWTO - User comments','','','usrcmt-9','1','0','0','9','0','','[+UID:1+]\r\n<div class=\"comment[+altrowclass+] commentAuthor\">\r\n<div class=\"commentNum\">      [+postnumber+]    </div>\r\n<div class=\"commentTitle\"> 		<strong>Here is another post</strong><span>siteadmin  7Oct2005 09:51AM</span> 	</div>\r\n<div class=\"content\"> 		It\'s by the blog\'s original author, and should be colored differently.<br /><br />Also note that when you\'re logged in and reading blogs, any posts that YOU have made will also be colored differently. 	</div>\r\n</div>\r\n<!--Comment-Spliter:9--> [+UID:5+]\r\n<div class=\"comment[+altrowclass+][+authorclass+]\">\r\n<div class=\"commentNum\">      [+postnumber+]    </div>\r\n<div class=\"commentTitle\"> 		<strong>This is another comment</strong><span>rthrash  7Oct2005 09:47AM</span> 	</div>\r\n<div class=\"content\"> 		Comments alternate row colors so they\'re easier to follow. 	</div>\r\n</div>\r\n<!--Comment-Spliter:9-->[+UID:5+]\r\n<div class=\"comment[+altrowclass+][+authorclass+]\">\r\n<div class=\"commentNum\">      [+postnumber+]    </div>\r\n<div class=\"commentTitle\"> 		<strong>rthrash</strong>  <span>6OCT2005 01:38PM</span> 	</div>\r\n<div class=\"content\"> 		Comments are really easy as well. Just make sure that your users are logged in and members of the \'Registered Users\' group, or the comment form won\'t show up. This group is the default for users that request an account.<br /><br /> + Login to the site.<br /> + Go to a detailed/full blog post page.<br /> + Comment away ... that\'s it!<br /><br />User Comments does not support HTML code, or any special formatting, for that matter. Create an account and login to come back here and try commenting for yourself!	</div>\r\n</div>\r\n<!--Comment-Spliter:9-->','1','0','0','1','0','0','1128399804','4','1130052104','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('22','document','text/html','DropMenu','DropMenu Examples','','dropmenu','1','0','0','15','0','','<p>The following examples cover usage of the default Navigation/Site Map snippet. It is highly customizable and can build virtually any type of CSS-stylable menu system. Drop Menu can be called multiple times on a page.</p>\r\n\r\n<h3>Examples</h3>\r\n<p>The styling you see for the main navigation in the sidebar on this default template is a simple indented list. It supports many things \"out of the box\", including:</p>\r\n<ul>\r\n<li>No links built for pages without content by default. These are great for creating \"category\" navigation headers.</li>\r\n<li>Unpublished pages and pages with Show In Menu unchecked do not show up by default in your menus (but this can be overridden).</li>\r\n<li>Pages that you are currently on recieve a class of \"here\" by default and are no longer built as links.</li>\r\n<li>A class of \"here\" is also added to each LI element back up the \"document heirarchy\" by default.</li>\r\n<li>Very simple CSS styling.</li>\r\n</ul>\r\n<code>&#91;!DropMenu!&#93;\r\n\r\n#sidebar ul {\r\n    padding: 5px 20px 1em;\r\n    margin: 0 0 1em -5px;\r\n}\r\n\r\n#sidebar ul ul { margin-bottom: 0; border-bottom: 1px solid #ddd; }\r\n\r\n#sidebar ul ul ul { border-bottom: none; margin-bottom: 0; }\r\n\r\n#sidebar ul li ul li { background: url(images/tictac_green.gif) no-repeat 0 6px; }\r\n</code>\r\n\r\n<p>The call for the <a href=\"[~7~]\">sitemap found on the 404 page</a> is only slighly different. It adds one parameter in order to show the description along with the page names/links:</p>\r\n\r\n<code>&#91;!DropMenu? &showDescription=`1`!&#93;</code>\r\n','1','1','2','1','1','1','1128954065','2','1128965975','0','0','0','','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('24','document','text/html','Other Tricks','Some other neat things done with this site','','other-tricks','1','0','0','0','0','','<ul>\r\n\r\n<li><strong>@BINDING for Login menu name.</strong> We created an @BINDING for the name of the Login menu item. This changes the menu name from Login to Logout based on your logged in state. The @BINDING as follows was placed in the default value as:\r\n<code>@EVAL if ($modx->getLoginUserID()) return \'Logout\'; else return \'Login\';</code></li>\r\n\r\n<li><strong>Scriptaculous highlight effect.</strong> We used some simple effect to highlight various things on the front/home page to demonstrate how\r\neasy it is to create a useful way  to draw attention to things. To see them in action on the home page, click the Integrated Site Search, Related Links or Newest Documents headers. Scriptaculous effects are also used on the QuickEditor.</li>\r\n\r\n<li><strong>Custom forms for WebuserLogin and Account Creation.</strong> To demonstrate how to link to custom forms, we customized the calls to the Webuser Registration system and the Login system.</li>\r\n\r\n<li><strong>Rich Text Editor for blog entries.</strong> To make it easier to format blog posts with simple text formatting, we modified the blog to use a custom RTE-enabled Template Variable (TV).</li>\r\n\r\n<li><strong>Smart-Summary logic.</strong> When splitting the full blog/news posts you simple insert a \"&lt;!-- splitter -->\" where you want the break to occur. In addition, if that leaves any important tags open, it will try to match them and close them so it doesn\'t mess up your site layout with unclosed OL, UL or DIV tags.</li>\r\n\r\n</ul> ','1','1','10','1','1','2','1129049909','2','1129052300','0','0','0','Other Tricks','0','0','0','0','0','0','0');


REPLACE INTO `{PREFIX}site_content` VALUES ('26','document','text/html','Editing Blogs and Comments','How to Edit Blogs and User Comments','','article-1129318719','1','0','0','2','0','','Blog entries are simply pages in the document tree in MODx. User Comments for an article are also stored as a child page of the original article, with special formatting.  If you cannot see any child docs for an entry that contains commments, edit the post from inside the manager and turn the post into a folder. You should then see the user comments doc inside the folder. Edit that document as you would any other document, looking for the specific post you want to edit. User comments are formatted as in the following example:  {{FormBlogComments}}','1','1','3','1','1','-1','1129318719','4','1130051008','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('37','document','text/html','[*loginName*]','The page you\'re trying to reach requires a login','','blog-login','1','0','0','0','0','','<p>In order to add a blog entry, you must be logged in as a Site Admin webuser. Also, commenting on posts requires a login. <a href=\"[~6~]\">Contact the site owner</a> for permissions to create new post, or <a href=\"[~5~]\">create a web user account</a> to automatically receive commenting privelleges. If you already have an account, please login below.</p>\r\n\r\n[!WebLogin? &formtpl=`FormLogin` &loginhomeid=`3`!]','1','1','99','0','0','1','1126037994','2','1130172125','0','0','0','','0','0','0','0','0','0','1');


REPLACE INTO `{PREFIX}site_content` VALUES ('33','document','text/html','Getting Help','Getting Help with MODx','','geting-help','1','0','0','0','0','','<p>The <a href=\"http://modxcms.com/modx-team.html\" target=\"_blank\">team behind MODx</a> strives to contantly add to and refine the documentation to help you get up to speed with MODx:</p>\r\n<ul>\r\n    <li>For basic instructions on integrating custom templates into MODx, please see the <a target=\"_blank\" href=\"http://modxcms.com/designer-guide.html\">Designer\'s Guide</a>. </li>\r\n    <li>For an introduction to working in MODx from the content editors perspectve, see the <a target=\"_blank\" href=\"http://modxcms.com/editor-guide.html\">Content Editor\'s Guide</a>. </li>\r\n    <li>For a detailed overview of the backend &quot;manager&quot; and setting up Users and Groups, please peruse the <a target=\"_blank\" href=\"http://modxcms.com/developers-guide.html\">Administration Guide</a>.</li>\r\n    <li>For developers, architecture and API documentation can be found in the <a target=\"_blank\" href=\"http://modxcms.com/administration-guide.html\">Developer\'s Guide</a>.</li>\r\n    <li>And if someone has installed this site for you, but you\'re curious as to the steps they went through, please see the <a target=\"_blank\" href=\"http://modxcms.com/getting-started.html\">Getting Started Guide</a>.</li>\r\n</ul>\r\n\r\n<p>And don\'t forget, you can always learn and ask questions at the <a href=\"http://www.modxcms.com/forums\" target=\"_blank\">MODx forums</a>. \r\n','1','1','13','1','1','2','1130019134','2','1130019254','0','0','0','Getting Help','0','0','0','0','0','0','0');


#
# Dumping data for table `site_htmlsnippets`
#


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('1','WebLoginSideBar','WebLogin Sidebar Template','0','0','0','<!-- #declare:separator <hr> --> \r\n<!-- login form section-->\r\n<form method=\"post\" name=\"loginfrm\" action=\"[+action+]\" style=\"margin: 0px; padding: 0px;\"> \r\n<input type=\"hidden\" value=\"[+rememberme+]\" name=\"rememberme\"> \r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tr>\r\n<td>\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n  <tr>\r\n	<td><b>User:</b></td>\r\n	<td><input type=\"text\" name=\"username\" tabindex=\"1\" onkeypress=\"return webLoginEnter(document.loginfrm.password);\" size=\"5\" style=\"width: 100px;\" value=\"[+username+]\" /></td>\r\n  </tr>\r\n  <tr>\r\n	<td><b>Password:</b></td>\r\n	<td><input type=\"password\" name=\"password\" tabindex=\"2\" onkeypress=\"return webLoginEnter(document.loginfrm.cmdweblogin);\" size=\"5\" style=\"width: 100px;\" value=\"\" /></td>\r\n  </tr>\r\n  <tr>\r\n	<td><label for=\"chkbox\" style=\"cursor:pointer\">Remember me:&nbsp; </label></td>\r\n	<td>\r\n	<table width=\"100%\"  border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n	  <tr>\r\n		<td valign=\"top\"><input type=\"checkbox\" id=\"chkbox\" name=\"chkbox\" tabindex=\"4\" size=\"1\" value=\"\" [+checkbox+] onClick=\"webLoginCheckRemember()\" /></td>\r\n		<td align=\"right\">									\r\n		<input type=\"submit\" value=\"[+logintext+]\" name=\"cmdweblogin\" /></td>\r\n	  </tr>\r\n	</table>\r\n	</td>\r\n  </tr>\r\n  <tr>\r\n	<td colspan=\"2\"><a href=\"#\" onclick=\"webLoginShowForm(2);return false;\">Forget Password?</a></td>\r\n  </tr>\r\n</table>\r\n</td>\r\n</tr>\r\n</table>\r\n</form>\r\n<hr>\r\n<!-- log out hyperlink section -->\r\n<a href=\'[+action+]\'>[+logouttext+]</a>\r\n<hr>\r\n<!-- Password reminder form section -->\r\n<form name=\"loginreminder\" method=\"post\" action=\"[+action+]\" style=\"margin: 0px; padding: 0px;\">\r\n<input type=\"hidden\" name=\"txtpwdrem\" value=\"0\" />\r\n<table border=\"0\">\r\n	<tr>\r\n	  <td>Enter the email address of your account <br />below to receive your password:</td>\r\n	</tr>\r\n	<tr>\r\n	  <td><input type=\"text\" name=\"txtwebemail\" size=\"24\" /></td>\r\n	</tr>\r\n	<tr>\r\n	  <td align=\"right\"><input type=\"submit\" value=\"Submit\" name=\"cmdweblogin\" />\r\n	  <input type=\"reset\" value=\"Cancel\" name=\"cmdcancel\" onclick=\"webLoginShowForm(1);\" /></td>\r\n	</tr>\r\n  </table>\r\n</form>\r\n\r\n','0');


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('2','FormBlog','Input Form for creating new blog entries','0','0','0','<form name=\"NewsPublisher\" method=\"post\" action=\"[~[*id*]~]\">\r\n    <fieldset>\r\n        <h3>Publishing Details</h3>\r\n        <p>Note: Leaving the Publish Date empty will immediately publish your blog entry.</p>\r\n        <input name=\"NewsPublisherForm\" type=\"hidden\" value=\"on\" />\r\n    	<label for=\"pagetitle\">Page title <abbr title=\"The title used on the browser window\">?</abbr>: <input name=\"pagetitle\" id=\"pagetitle\" type=\"text\" size=\"40\" value=\"[+pagetitle+]\" /></label>\r\n    	<label for=\"longtitle\">Headline <abbr title=\"The title used on the article\">?</abbr>: <input name=\"longtitle\" id=\"longtitle\" type=\"text\" size=\"40\" value=\"[+longtitle+]\" /></label>\r\n\r\n    	<label for=\"pub_date\">Published date: <input name=\"pub_date\" id=\"pub_date\" type=\"text\" value=\"[+pub_date+]\" size=\"40\" readonly=\"readonly\" />\r\n    	<a onclick=\"nwpub_cal1.popup();\" onmouseover=\"window.status=\'Select date\'; return true;\" onmouseout=\"window.status=\'\'; return true;\"><img src=\"manager/media/images/icons/cal.gif\" width=\"16\" height=\"16\" alt=\"Select date\" /></a>\r\n    	<a onclick=\"document.NewsPublisher.pub_date.value=\'\'; return true;\" onmouseover=\"window.status=\'Remove date\'; return true;\" onmouseout=\"window.status=\'\'; return true;\"><img src=\"manager/media/images/icons/cal_nodate.gif\" width=\"16\" height=\"16\" alt=\"Remove date\"></a></label>\r\n	</fieldset>\r\n	\r\n	<fieldset>\r\n    	<h3>The Content</h3>\r\n    	<p>The Summary field is optional, but is used as a short version for RSS feeds and summary views on the main blog page.</p>\r\n    	<label for=\"introtext\">Summary (optional, but encouraged):<textarea name=\"introtext\" cols=\"50\" rows=\"5\">[+introtext+]</textarea></label>\r\n    	<label for=\"content\">Content:[*blogContent*]</label>\r\n	</fieldset>\r\n	\r\n	<fieldset>\r\n    	<h3>You\'re Done</h3>\r\n		<label>Now... wasn\'t that easy?</label>\r\n    	<input name=\"send\" type=\"submit\" value=\"Blog it!\" class=\"button\" />\r\n	</fieldset>	\r\n</form>\r\n<script language=\"JavaScript\" src=\"manager/media/script/datefunctions.js\"></script>\r\n<script type=\"text/javascript\">\r\n		var elm_txt = {}; // dummy\r\n		var pub = document.forms[\"NewsPublisher\"].elements[\"pub_date\"];\r\n		var nwpub_cal1 = new calendar1(pub,elm_txt);\r\n		nwpub_cal1.path=\"manager/media/\";\r\n		nwpub_cal1.year_scroll = true;\r\n		nwpub_cal1.time_comp = true;	\r\n</script>','0');


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('5','FormBlogComments','Comment for to show up beneath a blog for registered user comments','0','0','0','<p style=\"margin-top: 1em;font-weight:bold\">Enter your comments in the space below (registered site users only):</p>\r\n\r\n[!NewsUserComments? &canpost=`Registered Users, Site Admins` &makefolder=`0` &postcss=`comment` &titlecss=`commentTitle` &numbercss=`commentNum` &altrowcss=`commentAlt` &authorcss=`commentAuthor` &ownercss=`commentMe` &sortorder=`0`!]','0');


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('4','FormSignup','For the weblogin signup','0','0','0','<!-- #declare:separator <hr> --> \r\n<!-- login form section-->\r\n<form method=\"post\" name=\"websignupfrm\" action=\"[+action+]\">\r\n    <fieldset>\r\n        <h3>User Details</h3>\r\n        <p>Items marked by * are required</p>\r\n		<label for=\"username\">User name:* <input type=\"text\" name=\"username\" id=\"username\" class=\"inputBox\" size=\"20\" maxlength=\"30\" value=\"[+username+]\" /></label>\r\n        <label for=\"fullname\">Full name: <input type=\"text\" name=\"fullname\" id=\"fullname\" class=\"inputBox\" size=\"20\" maxlength=\"100\" value=\"[+fullname+]\" /></label>\r\n		<label for=\"fullname\">Email address:* <input type=\"text\" name=\"email\" id=\"email\" class=\"inputBox\" size=\"20\" value=\"[+email+]\" /></label>\r\n	</fieldset>\r\n	\r\n	<fieldset>\r\n	    <h3>Password</h3>\r\n	    <label for=\"password\">Password:* <input type=\"password\" name=\"password\" id=\"password\" class=\"inputBox\" size=\"20\" /></label>\r\n	    <label for=\"confirmpassword\">Confirm password:* <input type=\"password\" name=\"confirmpassword\" id=\"confirmpassword\" class=\"inputBox\" size=\"20\" /></label>\r\n	</fieldset>\r\n	\r\n	<fieldset>\r\n		<h3>Optional Account Profile Info</h3>\r\n		<label for=\"country\">Country:</label>\r\n		<select size=\"1\" name=\"country\" id=\"country\">\r\n			<option value=\"\" selected=\"selected\">&nbsp;</option>\r\n			<option value=\"1\">Afghanistan</option>\r\n			<option value=\"2\">Albania</option>\r\n			<option value=\"3\">Algeria</option>\r\n			<option value=\"4\">American Samoa</option>\r\n			<option value=\"5\">Andorra</option>\r\n			<option value=\"6\">Angola</option>\r\n			<option value=\"7\">Anguilla</option>\r\n			<option value=\"8\">Antarctica</option>\r\n			<option value=\"9\">Antigua and Barbuda</option>\r\n			<option value=\"10\">Argentina</option>\r\n			<option value=\"11\">Armenia</option>\r\n			<option value=\"12\">Aruba</option>\r\n			<option value=\"13\">Australia</option>\r\n			<option value=\"14\">Austria</option>\r\n			<option value=\"15\">Azerbaijan</option>\r\n			<option value=\"16\">Bahamas</option>\r\n			<option value=\"17\">Bahrain</option>\r\n			<option value=\"18\">Bangladesh</option>\r\n			<option value=\"19\">Barbados</option>\r\n			<option value=\"20\">Belarus</option>\r\n			<option value=\"21\">Belgium</option>\r\n			<option value=\"22\">Belize</option>\r\n			<option value=\"23\">Benin</option>\r\n			<option value=\"24\">Bermuda</option>\r\n			<option value=\"25\">Bhutan</option>\r\n			<option value=\"26\">Bolivia</option>\r\n			<option value=\"27\">Bosnia and Herzegowina</option>\r\n			<option value=\"28\">Botswana</option>\r\n			<option value=\"29\">Bouvet Island</option>\r\n			<option value=\"30\">Brazil</option>\r\n			<option value=\"31\">British Indian Ocean Territory</option>\r\n			<option value=\"32\">Brunei Darussalam</option>\r\n			<option value=\"33\">Bulgaria</option>\r\n			<option value=\"34\">Burkina Faso</option>\r\n			<option value=\"35\">Burundi</option>\r\n			<option value=\"36\">Cambodia</option>\r\n			<option value=\"37\">Cameroon</option>\r\n			<option value=\"38\">Canada</option>\r\n			<option value=\"39\">Cape Verde</option>\r\n			<option value=\"40\">Cayman Islands</option>\r\n			<option value=\"41\">Central African Republic</option>\r\n			<option value=\"42\">Chad</option>\r\n			<option value=\"43\">Chile</option>\r\n			<option value=\"44\">China</option>\r\n			<option value=\"45\">Christmas Island</option>\r\n			<option value=\"46\">Cocos (Keeling) Islands</option>\r\n			<option value=\"47\">Colombia</option>\r\n			<option value=\"48\">Comoros</option>\r\n			<option value=\"49\">Congo</option>\r\n			<option value=\"50\">Cook Islands</option>\r\n			<option value=\"51\">Costa Rica</option>\r\n			<option value=\"52\">Cote D&#39;Ivoire</option>\r\n			<option value=\"53\">Croatia</option>\r\n			<option value=\"54\">Cuba</option>\r\n			<option value=\"55\">Cyprus</option>\r\n			<option value=\"56\">Czech Republic</option>\r\n			<option value=\"57\">Denmark</option>\r\n			<option value=\"58\">Djibouti</option>\r\n			<option value=\"59\">Dominica</option>\r\n			<option value=\"60\">Dominican Republic</option>\r\n			<option value=\"61\">East Timor</option>\r\n			<option value=\"62\">Ecuador</option>\r\n			<option value=\"63\">Egypt</option>\r\n			<option value=\"64\">El Salvador</option>\r\n			<option value=\"65\">Equatorial Guinea</option>\r\n			<option value=\"66\">Eritrea</option>\r\n			<option value=\"67\">Estonia</option>\r\n			<option value=\"68\">Ethiopia</option>\r\n			<option value=\"69\">Falkland Islands (Malvinas)</option>\r\n			<option value=\"70\">Faroe Islands</option>\r\n			<option value=\"71\">Fiji</option>\r\n			<option value=\"72\">Finland</option>\r\n			<option value=\"73\">France</option>\r\n			<option value=\"74\">France, Metropolitan</option>\r\n			<option value=\"75\">French Guiana</option>\r\n			<option value=\"76\">French Polynesia</option>\r\n			<option value=\"77\">French Southern Territories</option>\r\n			<option value=\"78\">Gabon</option>\r\n			<option value=\"79\">Gambia</option>\r\n			<option value=\"80\">Georgia</option>\r\n			<option value=\"81\">Germany</option>\r\n			<option value=\"82\">Ghana</option>\r\n			<option value=\"83\">Gibraltar</option>\r\n			<option value=\"84\">Greece</option>\r\n			<option value=\"85\">Greenland</option>\r\n			<option value=\"86\">Grenada</option>\r\n			<option value=\"87\">Guadeloupe</option>\r\n			<option value=\"88\">Guam</option>\r\n			<option value=\"89\">Guatemala</option>\r\n			<option value=\"90\">Guinea</option>\r\n			<option value=\"91\">Guinea-bissau</option>\r\n			<option value=\"92\">Guyana</option>\r\n			<option value=\"93\">Haiti</option>\r\n			<option value=\"94\">Heard and Mc Donald Islands</option>\r\n			<option value=\"95\">Honduras</option>\r\n			<option value=\"96\">Hong Kong</option>\r\n			<option value=\"97\">Hungary</option>\r\n			<option value=\"98\">Iceland</option>\r\n			<option value=\"99\">India</option>\r\n			<option value=\"100\">Indonesia</option>\r\n			<option value=\"101\">Iran (Islamic Republic of)</option>\r\n			<option value=\"102\">Iraq</option>\r\n			<option value=\"103\">Ireland</option>\r\n			<option value=\"104\">Israel</option>\r\n			<option value=\"105\">Italy</option>\r\n			<option value=\"106\">Jamaica</option>\r\n			<option value=\"107\">Japan</option>\r\n			<option value=\"108\">Jordan</option>\r\n			<option value=\"109\">Kazakhstan</option>\r\n			<option value=\"110\">Kenya</option>\r\n			<option value=\"111\">Kiribati</option>\r\n			<option value=\"112\">Korea, Democratic People&#39;s Republic of</option>\r\n			<option value=\"113\">Korea, Republic of</option>\r\n			<option value=\"114\">Kuwait</option>\r\n			<option value=\"115\">Kyrgyzstan</option>\r\n			<option value=\"116\">Lao People&#39;s Democratic Republic</option>\r\n			<option value=\"117\">Latvia</option>\r\n			<option value=\"118\">Lebanon</option>\r\n			<option value=\"119\">Lesotho</option>\r\n			<option value=\"120\">Liberia</option>\r\n			<option value=\"121\">Libyan Arab Jamahiriya</option>\r\n			<option value=\"122\">Liechtenstein</option>\r\n			<option value=\"123\">Lithuania</option>\r\n			<option value=\"124\">Luxembourg</option>\r\n			<option value=\"125\">Macau</option>\r\n			<option value=\"126\">Macedonia, The Former Yugoslav Republic of</option>\r\n			<option value=\"127\">Madagascar</option>\r\n			<option value=\"128\">Malawi</option>\r\n			<option value=\"129\">Malaysia</option>\r\n			<option value=\"130\">Maldives</option>\r\n			<option value=\"131\">Mali</option>\r\n			<option value=\"132\">Malta</option>\r\n			<option value=\"133\">Marshall Islands</option>\r\n			<option value=\"134\">Martinique</option>\r\n			<option value=\"135\">Mauritania</option>\r\n			<option value=\"136\">Mauritius</option>\r\n			<option value=\"137\">Mayotte</option>\r\n			<option value=\"138\">Mexico</option>\r\n			<option value=\"139\">Micronesia, Federated States of</option>\r\n			<option value=\"140\">Moldova, Republic of</option>\r\n			<option value=\"141\">Monaco</option>\r\n			<option value=\"142\">Mongolia</option>\r\n			<option value=\"143\">Montserrat</option>\r\n			<option value=\"144\">Morocco</option>\r\n			<option value=\"145\">Mozambique</option>\r\n			<option value=\"146\">Myanmar</option>\r\n			<option value=\"147\">Namibia</option>\r\n			<option value=\"148\">Nauru</option>\r\n			<option value=\"149\">Nepal</option>\r\n			<option value=\"150\">Netherlands</option>\r\n			<option value=\"151\">Netherlands Antilles</option>\r\n			<option value=\"152\">New Caledonia</option>\r\n			<option value=\"153\">New Zealand</option>\r\n			<option value=\"154\">Nicaragua</option>\r\n			<option value=\"155\">Niger</option>\r\n			<option value=\"156\">Nigeria</option>\r\n			<option value=\"157\">Niue</option>\r\n			<option value=\"158\">Norfolk Island</option>\r\n			<option value=\"159\">Northern Mariana Islands</option>\r\n			<option value=\"160\">Norway</option>\r\n			<option value=\"161\">Oman</option>\r\n			<option value=\"162\">Pakistan</option>\r\n			<option value=\"163\">Palau</option>\r\n			<option value=\"164\">Panama</option>\r\n			<option value=\"165\">Papua New Guinea</option>\r\n			<option value=\"166\">Paraguay</option>\r\n			<option value=\"167\">Peru</option>\r\n			<option value=\"168\">Philippines</option>\r\n			<option value=\"169\">Pitcairn</option>\r\n			<option value=\"170\">Poland</option>\r\n			<option value=\"171\">Portugal</option>\r\n			<option value=\"172\">Puerto Rico</option>\r\n			<option value=\"173\">Qatar</option>\r\n			<option value=\"174\">Reunion</option>\r\n			<option value=\"175\">Romania</option>\r\n			<option value=\"176\">Russian Federation</option>\r\n			<option value=\"177\">Rwanda</option>\r\n			<option value=\"178\">Saint Kitts and Nevis</option>\r\n			<option value=\"179\">Saint Lucia</option>\r\n			<option value=\"180\">Saint Vincent and the Grenadines</option>\r\n			<option value=\"181\">Samoa</option>\r\n			<option value=\"182\">San Marino</option>\r\n			<option value=\"183\">Sao Tome and Principe</option>\r\n			<option value=\"184\">Saudi Arabia</option>\r\n			<option value=\"185\">Senegal</option>\r\n			<option value=\"186\">Seychelles</option>\r\n			<option value=\"187\">Sierra Leone</option>\r\n			<option value=\"188\">Singapore</option>\r\n			<option value=\"189\">Slovakia (Slovak Republic)</option>\r\n			<option value=\"190\">Slovenia</option>\r\n			<option value=\"191\">Solomon Islands</option>\r\n			<option value=\"192\">Somalia</option>\r\n			<option value=\"193\">South Africa</option>\r\n			<option value=\"194\">South Georgia and the South Sandwich Islands</option>\r\n			<option value=\"195\">Spain</option>\r\n			<option value=\"196\">Sri Lanka</option>\r\n			<option value=\"197\">St. Helena</option>\r\n			<option value=\"198\">St. Pierre and Miquelon</option>\r\n			<option value=\"199\">Sudan</option>\r\n			<option value=\"200\">Suriname</option>\r\n			<option value=\"201\">Svalbard and Jan Mayen Islands</option>\r\n			<option value=\"202\">Swaziland</option>\r\n			<option value=\"203\">Sweden</option>\r\n			<option value=\"204\">Switzerland</option>\r\n			<option value=\"205\">Syrian Arab Republic</option>\r\n			<option value=\"206\">Taiwan</option>\r\n			<option value=\"207\">Tajikistan</option>\r\n			<option value=\"208\">Tanzania, United Republic of</option>\r\n			<option value=\"209\">Thailand</option>\r\n			<option value=\"210\">Togo</option>\r\n			<option value=\"211\">Tokelau</option>\r\n			<option value=\"212\">Tonga</option>\r\n			<option value=\"213\">Trinidad and Tobago</option>\r\n			<option value=\"214\">Tunisia</option>\r\n			<option value=\"215\">Turkey</option>\r\n			<option value=\"216\">Turkmenistan</option>\r\n			<option value=\"217\">Turks and Caicos Islands</option>\r\n			<option value=\"218\">Tuvalu</option>\r\n			<option value=\"219\">Uganda</option>\r\n			<option value=\"220\">Ukraine</option>\r\n			<option value=\"221\">United Arab Emirates</option>\r\n			<option value=\"222\">United Kingdom</option>\r\n			<option value=\"223\">United States</option>\r\n			<option value=\"224\">United States Minor Outlying Islands</option>\r\n			<option value=\"225\">Uruguay</option>\r\n			<option value=\"226\">Uzbekistan</option>\r\n			<option value=\"227\">Vanuatu</option>\r\n			<option value=\"228\">Vatican City State (Holy See)</option>\r\n			<option value=\"229\">Venezuela</option>\r\n			<option value=\"230\">Viet Nam</option>\r\n			<option value=\"231\">Virgin Islands (British)</option>\r\n			<option value=\"232\">Virgin Islands (U.S.)</option>\r\n			<option value=\"233\">Wallis and Futuna Islands</option>\r\n			<option value=\"234\">Western Sahara</option>\r\n			<option value=\"235\">Yemen</option>\r\n			<option value=\"236\">Yugoslavia</option>\r\n			<option value=\"237\">Zaire</option>\r\n			<option value=\"238\">Zambia</option>\r\n			<option value=\"239\">Zimbabwe</option>\r\n			</select>\r\n        </fieldset>\r\n        \r\n        <fieldset>\r\n            <h3>Bot-Patrol</h3>\r\n            <p>Enter the word/number combination shown in the image below.</p>\r\n            <label>Form code:* \r\n            <input type=\"text\" name=\"formcode\" class=\"inputBox\" size=\"20\" /></label>\r\n            <a href=\"[+action+]\"><img align=\"top\" src=\"manager/includes/veriword.php\" width=\"148\" height=\"60\" alt=\"If you have trouble reading the code, click on the code itself to generate a new random code.\" style=\"border: 1px solid #039\" /></a>\r\n        </fieldset>\r\n        \r\n        <fieldset>\r\n            <input type=\"submit\" value=\"Submit\" name=\"cmdwebsignup\" />\r\n	</fieldset>\r\n</form>\r\n\r\n<script language=\"javascript\" type=\"text/javascript\"> \r\n	var id = \"[+country+]\";\r\n	var f = document.websignupfrm;\r\n	var i = parseInt(id);	\r\n	if (!isNaN(i)) f.country.options[i].selected = true;\r\n</script>\r\n<hr>\r\n<!-- notification section -->\r\n<p class=\"message\">Signup completed successfully!<br />\r\nYour account was created. A copy of your signup information was sent to your email address.</p>\r\n','0');


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('3','FormLogin','Custom login form for Weblogins','0','0','0','<!-- #declare:separator <hr> --> \r\n<!-- login form section-->\r\n<form method=\"post\" name=\"loginfrm\" action=\"[+action+]\"> \r\n    <input type=\"hidden\" value=\"[+rememberme+]\" name=\"rememberme\" /> \r\n    <fieldset>\r\n        <h3>Your Login Details</h3>\r\n        <label for=\"username\">User: <input type=\"text\" name=\"username\" id=\"username\" tabindex=\"1\" onkeypress=\"return webLoginEnter(document.loginfrm.password);\" value=\"[+username+]\" /></label>\r\n    	<label for=\"password\">Password: <input type=\"password\" name=\"password\" id=\"password\" tabindex=\"2\" onkeypress=\"return webLoginEnter(document.loginfrm.cmdweblogin);\" value=\"\" /></label>\r\n    	<input type=\"checkbox\" id=\"checkbox_1\" name=\"checkbox_1\" tabindex=\"3\" size=\"1\" value=\"\" [+checkbox+] onclick=\"webLoginCheckRemember()\" /><label for=\"checkbox_1\" class=\"checkbox\">Remember me</label>\r\n    	<label>&nbsp;</label><input type=\"submit\" value=\"[+logintext+]\" name=\"cmdweblogin\" class=\"button\" />\r\n	</fieldset>\r\n    <div><a href=\"#\" onclick=\"webLoginShowForm(2);return false;\">Forget Your Password?</a></div>\r\n</form>\r\n<hr>\r\n<!-- log out hyperlink section -->\r\n<h4>You\'re already logged in</h4>\r\nDo you wish to <a href=\"[+action+]\" class=\"button\">[+logouttext+]</a>?\r\n<hr>\r\n<!-- Password reminder form section -->\r\n<form name=\"loginreminder\" method=\"post\" action=\"[+action+]\">\r\n    <fieldset>\r\n        <h3>It happens to everyone...</h3>\r\n        <input type=\"hidden\" name=\"txtpwdrem\" value=\"0\" />\r\n        <label for=\"txtwebemail\">Enter the email address of your account to reset your password: <input type=\"text\" name=\"txtwebemail\" id=\"txtwebemail\" size=\"24\" /></label>\r\n        <label>To return to the login form, press the cancel button.</label>\r\n    	<input type=\"submit\" value=\"Submit\" name=\"cmdweblogin\" class=\"button\" /> <input type=\"reset\" value=\"Cancel\" name=\"cmdcancel\" onclick=\"webLoginShowForm(1);\" class=\"button\" style=\"clear:none;display:inline\" />\r\n    </fieldset>\r\n</form>\r\n','0');


REPLACE INTO `{PREFIX}site_htmlsnippets` VALUES ('6','AboutMe','The short bio blurb','0','0','0','<p>Write about yourself here... To edit this text, login to the manager, and Edit the \"AboutMe\" chunk found under <strong>Resources</strong> &gt; Manage Resources &gt; Chunks (tab). Chunks make updating consistent \"blocks\" of content (like footers, menus or this text) used across multiple templates straightforward and efficient.</p>','0');


#
# Dumping data for table `modx_site_keywords`
#


REPLACE INTO `{PREFIX}site_keywords` VALUES ('2','MODx');


REPLACE INTO `{PREFIX}site_keywords` VALUES ('3','content management system');


REPLACE INTO `{PREFIX}site_keywords` VALUES ('4','Front End Editing');


REPLACE INTO `{PREFIX}site_keywords` VALUES ('5','login');


#
# Dumping data for table `site_snippets`
#


REPLACE INTO `{PREFIX}site_snippets` VALUES ('1','DateTime','Returns the date and time','0','0','0','#  DateTime\r\n#  Author: Ralph A. Dahlgren -- rad14701 -- 2005-04-14\r\n#  Usage: [!DateTime?timestamp=[*editedon*]&diff=2&format=d-m-Y H:i:s!]\r\n\r\n//  Default time offset (+/-) to use if not sent in snippet call\r\n$defaultDiff = 0;\r\n\r\n//   Default Date/Time format to use if not sent in snippet call based on date()\r\n//   Use the following for configuration options:\r\n//   a - \"am\" or \"pm\"\r\n//   A - \"AM\" or \"PM\"\r\n//   B - Swatch Internet time (000-999)\r\n//   d - Day of the month with a leading zero (01-31)\r\n//   D - Three characters that represents the day of the week (Mon-Sun)\r\n//   F - The full name of the month (January-December)\r\n//   g - The hour in 12-hour format without a leading zero (1-12)\r\n//   G - The hour in 24-hour format without a leading zero (0-23)\r\n//   h - The hour in 12-hour format with a leading zero (01-12)\r\n//   H - The hour in 24-hour format with a leading zero (00-23)\r\n//   i - The minutes with a leading zero (00-59)\r\n//   I - \"1\" if the date is in daylights savings time, otherwise \"0\"\r\n//   j - Day of the month without a leading zero (1-31)\r\n//   l - The full name of the day (Monday-Sunday)\r\n//   L - \"1\" if the year is a leap year, otherwise \"0\"\r\n//   m - The month as a number, with a leading zero (01-12)\r\n//   M - Three letters that represents the name of the month (Jan-Dec)\r\n//   n - The month as a number without a leading zero (1-12)\r\n//   O - The difference to Greenwich time (GMT) in hours\r\n//   r - An RFC 822 formatted date (e.g. \"Tue, 10 Apr 2005 18:34:07 +0300\")\r\n//   s - The seconds with a leading zero (00-59)\r\n//   S - The English ordinal suffix for the day of the month (st, nd, rd or th)\r\n//   t - The number of days in the given month (28-31)\r\n//   T - The local time zone (e.g. \"GMT\")\r\n//   U - The number of seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)\r\n//   w - The day of the week as a number (0-6, 0=Sunday)\r\n//   W - ISO-8601 week number of year, weeks starting on Monday\r\n//   Y - The year as a 4-digit number (e.g. 2003)\r\n//   y - The year as a 2-digit number (e.g. 03)\r\n//   z - The day of the year as a number (0-366)\r\n\r\n$defaultFormat = \"( l, F jS, Y g:i a )\";  #  ( Thursday, April 14th, 2005 8:00 pm )\r\n\r\n#  If timestamp such as [*editedon*] or [*createdon*] sent, use it, otherwise use time()\r\nif($timestamp == \"editedon\") $timestamp = $modx->documentObject[\'editedon\'];\r\nelseif($timestamp == \"createdon\") $timestamp = $modx->documentObject[\'createdon\'];\r\nelseif($timestamp == \"pub_date\") $timestamp = $modx->documentObject[\'pub_date\'];\r\nelseif($timestamp == \"unpub_date\") $timestamp = $modx->documentObject[\'unpub_date\'];\r\n$timestamp = isset($timestamp) ? $timestamp : time();\r\n\r\n#  Hours difference between server time and local time\r\n$diff = isset($diff) ? $diff : $defaultDiff;\r\n\r\n#  Your desired Date/Time format based on date()\r\n$format = isset($format) ? $format : $defaultFormat;\r\n\r\n#  Adjust time if required, format, and return\r\n$timeadjust = ($diff * 60 * 60);\r\n$output = date($format, $timestamp + $timeadjust);\r\nreturn $output;\r\n\r\n','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('6','GetStats','Fetches the visitor statistics totals from the database','0','0','0','/*\r\n *	GetStats \r\n *	Fetches the visitor statistics totals from the database\r\n *\r\n */\r\n \r\n\r\n$tmpArray = $modx->getSiteStats();\r\n\r\n$output = \"\r\n<table width=\'100%\' cellspacing=\'1\' bgcolor=\'#003399\'>\r\n    <tr class=\'fancyRow\'>\r\n        <td width=\'25%\'>&nbsp;</td>\r\n        <td width=\'25%\'><b>Page Impressions</b></td>\r\n        <td width=\'25%\'><b>Visits</b></td>\r\n        <td width=\'25%\'><b>Visitors</b></td>\r\n    </tr>\r\n    <tr>\r\n        <td class=\'fancyRow2\'><b>Today</b></td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'piDay\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'viDay\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'visDay\']).\"</td>\r\n    </tr>\r\n    <tr>\r\n        <td class=\'fancyRow2\'><b>This Month</b></td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'piMonth\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'viMonth\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'visMonth\']).\"</td>\r\n    </tr>\r\n    <tr>\r\n        <td class=\'fancyRow2\'><b>All Time</b></td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'piAll\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'viAll\']).\"</td>\r\n        <td bgcolor=\'white\'>\".number_format($tmpArray[\'visAll\']).\"</td>\r\n    </tr>\r\n</table>\r\n\";\r\n\r\nreturn $output;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('8','NewsFeed','Enable RSS2 news feed from your website.','0','0','0','/**\r\n*\r\n*	NewsFeed for MODx v3\r\n*	Created by Raymond Irving, August 2005\r\n*	Code made RSS valid and enhanced by Mark Kaplan, September-October 2005\r\n*	Tag-closing feature by Greg Matthews\r\n*\r\n*	Enable RSS2 news feed from your website\r\n*\r\n*	Snippet Parameters [default]:\r\n* \r\n*      &defaultauthor    - Default username to use when missing or not available. \r\n*                          Defaults to the initial admin user account. [string] \r\n*                          Example: &defaultauthor=`Admin <youremail@yoursite.com>`\r\n*\r\n*		&makerss	- set to 0 to generate a link to the feed. Defaults to 1\r\n*		\r\n*	(available when &makerss=1)\r\n*		&newsfolder	- Folder id where news items are to be stored. Example &newsfolder=`2`. If &newsfolder is missing the current document id will be used.\r\n*		&topitems	- set the top number of items to be listed in news feed. [20]\r\n*		&copyright	- set copyright information\r\n* 		&ttl		- set how often should feed readers check for new material (in seconds) -- mostly ignored by readers.\r\n*      &trunc         - truncate to summary posts? if set to false, shows entire post [true]\r\n*      &truncSplit    - use the special \"splitter\" format to truncate for summary posts [true]\r\n*      &truncAt       - the split-point splitter itself [<!-- splitter -->]\r\n*      &truncLen      - if you don\'t have a splitter or you turn that off explicitly, the number \r\n*                       of characters of the blog to show for summary if not using splitter [450] \r\n*                       However, if you have a summary of the post, it will use that instead. \r\n*      &pubOnly    - display published documents [true]\r\n*	(available when &makerss=0)\r\n*		&showlink	- set to 1 to show feed link. Defaults to 1 \r\n*		&linkid		- set the document id for the rss new feed. (available when &makerss=0)\r\n*/\r\n\r\n\r\n// get folder id where we should look for news else look in current document\r\n$folder = isset($newsfolder) ? intval($newsfolder):$modx->documentIdentifier;\r\n\r\n// get current document id\r\n$docid = $modx->documentIdentifier;\r\n\r\n// set subscribe mode\r\n$makerss = isset($makerss) ? $makerss:1;\r\n\r\n// set link id\r\n$linkid = isset($linkid) ? intval($linkid): 0;\r\n\r\n// set show link mode\r\n$showlink = isset($showlink) ? $showlink: 1;\r\n\r\n// set top items\r\n$topitems = isset($topitems) ? $topitems : 20;\r\n\r\n// set copyright info\r\n$copyright = isset($copyright) ? $copyright:\'\';\r\n\r\n// set ttl value\r\n$ttl = ($ttl) ? intval($ttl):120;\r\n\r\n// set lentoshow\r\n$lentoshow = isset($truncLen) ? $truncLen : 450;\r\n\r\n$trunc = isset($truc) ? $trunc : true;\r\n    // should there be summary/short version of the posts?\r\n\r\n$truncsplit = isset($trucSplit) ? $truncSplit : true;\r\n    // should the post be summarized at the \"splitter\"?\r\n\r\n$splitter = isset($trucAt) ? $truncAt : \"<!-- splitter -->\";\r\n    // where to split the text \r\n    \r\n$showPublishedOnly = isset($pubOnly) ? $pubOnly : true;\r\n    // allows you to show unpublished docs if needed for some reason...\r\n\r\n\r\n// functions start here\r\nfunction closeTags($text) { \r\n    $openPattern = \"/<([^\\/].*?)>/\";   \r\n    $closePattern = \"/<\\/(.*?)>/\"; \r\n    $endOpenPattern = \"/<([^\\/].*?)$/\"; \r\n    $endClosePattern = \"/<(\\/.*?[^>])$/\"; \r\n    $endTags=\'\'; \r\n     \r\n    //$text=preg_replace($endOpenPattern,\'\',$text); \r\n    //$text=preg_replace($endClosePattern,\'\',$text); \r\n    preg_match_all($openPattern,$text,$openTags); \r\n    preg_match_all($closePattern,$text,$closeTags); \r\n    \r\n    //print_r($openTags); \r\n    //print_r($closeTags); \r\n    \r\n    $c=0; \r\n    $loopCounter = count($closeTags[1]);  //used to prevent an infinite loop if the html is malformed \r\n    while($c<count($closeTags[1]) && $loopCounter) { \r\n        $i=0; \r\n        while($i<count($openTags[1])) { \r\n             \r\n            $tag = trim($openTags[1][$i]); \r\n             \r\n            if(strstr($tag,\' \')) { \r\n                $tag = substr($tag,0,strpos($tag,\' \'));    \r\n            } \r\n            //echo $tag.\'==\'.$closeTags[1][$c].\"\\n\"; \r\n            if($tag==$closeTags[1][$c]) { \r\n                $openTags[1][$i]=\'\'; \r\n                $c++; \r\n                break; \r\n            }    \r\n            $i++; \r\n        } \r\n        $loopCounter--; \r\n    } \r\n     \r\n    $results = $openTags[1]; \r\n     \r\n    if(is_array($results)) {  \r\n    $results = array_reverse($results); \r\n         \r\n        foreach($results as $tag) { \r\n    \r\n            $tag = trim($tag); \r\n             \r\n            if(strstr($tag,\' \')) { \r\n                $tag = substr($tag,0,strpos($tag,\' \'));    \r\n            }    \r\n            if(!stristr($tag,\'br\') && !stristr($tag,\'img\') && !empty($tag)) { \r\n                $endTags.= \'</\'.$tag.\'>\'; \r\n            } \r\n        }    \r\n    } \r\n    return $text.$endTags; \r\n}\r\n   \r\n// switch block\r\nswitch ($makerss) {\r\n	case true:	// generate rss2xml\r\n		$link = $modx->config[\'site_url\'].$modx->makeUrl($modx->documentIdentifier); // url to current page\r\n		$output .=  \'<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\'.\"\\n\".\r\n		\'<rss version=\"2.0\">\'.\"\\n\".\r\n		\'	<channel>\'.\"\\n\".\r\n		\'		<title>\'.$modx->documentObject[\'pagetitle\'].\'</title>\'.\"\\n\".\r\n		\'		<link>\'.$link.\'</link>\'.\"\\n\".\r\n		\'		<description>\'.$modx->documentObject[\'introtext\'].\'</description>\'.\"\\n\".\r\n		\'		<language>en</language>\'.\"\\n\".\r\n		\'		<copyright>\'.$copyright.\'</copyright>\'.\"\\n\".\r\n		\'		<ttl>\'.$ttl.\'</ttl>\'.\"\\n\";\r\n		\r\n		$callby = ($showPublishedOnly)? \'getActiveChildren\' : \'getAllChildren\';\r\n	\r\n		$ds = $modx->$callby($folder, \'createdon\', \'DESC\', $fields=\'id, pagetitle, description, introtext, content, createdon, createdby\');\r\n		\r\n		$limit=count($ds);\r\n		if($limit>0) { \r\n			$limit = $topitems<$limit ? $topitems : $limit; \r\n			for ($i = 0; $i < $limit; $i++) { \r\n				\r\n				if ($ds[$i][\'createdby\']<0) {\r\n					// get web user name\r\n					$tbl = $modx->getFullTableName(\"web_user_attributes\");\r\n					$sql = \"SELECT fullname, email FROM $tbl WHERE $tbl.id = \'\".abs($ds[$i][\'createdby\']).\"\'\"; \r\n				}\r\n				else {\r\n					// get manager user name\r\n					$tbl = $modx->getFullTableName(\"user_attributes\");\r\n					$sql = \"SELECT fullname, email  FROM $tbl WHERE $tbl.id = \'\".$ds[$i][\'createdby\'].\"\'\"; \r\n				}\r\n				\r\n    				$rs2 = $modx->dbQuery($sql);\r\n    				$limit2 = $modx->recordCount($rs2); \r\n    				if($limit2<1) { \r\n							// get manager user name\r\n						$btbl = $modx->getFullTableName(\"user_attributes\");\r\n						$bsql = \"SELECT fullname, email  FROM $btbl WHERE $btbl.id = \'1\'\"; \r\n						$brs = $modx->dbQuery($bsql);\r\n						$blimit = $modx->recordCount($brs);\r\n						$bdsuser = $modx->fetchRow($brs); \r\n    					$username = \"\".$bdsuser[\'fullname\'].\" <\".$bdsuser[\'email\'].\">\";\r\n								}\r\n    				else { \r\n    					$dsuser = $modx->fetchRow($rs2); \r\n    					$username = \"\".$dsuser[\'fullname\'].\" <\".$dsuser[\'email\'].\">\";\r\n    				} \r\n				\r\n		// determine and show summary\r\n				    \r\n		// contains the splitter and use splitter is on\r\nif ((strstr($ds[$i][\'content\'], $splitter)) && $truncsplit) {\r\n            $summary = array();\r\n            \r\n            // HTMLarea/XINHA encloses it in paragraph\'s\r\n            $summary = explode(\'<p>\'.$splitter.\'</p>\',$ds[$i][\'content\']);\r\n            \r\n            // For TinyMCE or if it isn\'t wrapped inside paragraph tags\r\n            $summary = explode($splitter,$summary[\'0\']); \r\n\r\n            $summary = $summary[\'0\'];\r\n            $summary = closeTags($summary);\r\n            \r\n        // fall back to the summary text    \r\n		} else if (strlen($ds[$i][\'introtext\'])>0) {\r\n			$summary = $ds[$i][\'introtext\'];\r\n			\r\n		// fall back to the summary text count	\r\n		// skipping this because of ease of breaking in the middle of an A tag... \r\n		// so it\'s not a good idea. If you must have this, then uncomment\r\n		// } else if(strlen($ds[$i][\'content\']) > $lentoshow) { \r\n		// 	$summary = substr($ds[$i][\'content\'], 0, $lentoshow).\'...\'; \r\n		//\r\n		\r\n		// and back to where we started if all else fails (short post)\r\n		} else { \r\n			$summary = $ds[$i][\'content\']; \r\n		}  \r\n		\r\n		// summary is turned off\r\n		if ($trunc == false) {\r\n		    $summary = $ds[$i][\'content\']; \r\n	    }\r\n				\r\n				\r\n				$allowedTags = \'<p><br><i><em><b><strong><pre><table><th><td><tr><img><span><div><h1><h2><h3><h4><h5><font><ul><ol><li><dl><dt><dd>\';\r\n	\r\n				// format content\r\n				$strippedsummary = $modx->stripTags($summary,$allowedTags);\r\n				$strippedsummary = str_replace(\'{{FormBlogComments}}\',\'\',$strippedsummary);\r\n\r\n				$link = $modx->config[\'site_url\'].$modx->makeUrl($ds[$i][\'id\']);\r\n				$output .= \'		<item>\'.\"\\n\".\r\n				\'			<title>\'.$ds[$i][\'pagetitle\'].\'</title>\'.\"\\n\".\r\n				\'			<link>\'.$link.\'</link>\'.\"\\n\".\r\n				\'			<description>\'.htmlspecialchars($strippedsummary).\'</description>\'.\"\\n\".\r\n				\'			<pubDate>\'.date(\"r\", $ds[$i][\'createdon\']).\'</pubDate>\'.\"\\n\".\r\n				\'			<guid>\'.$link.\'</guid>\'.\"\\n\".\r\n				\'			<author>\'.htmlspecialchars($username).\'</author>\'.\"\\n\".\r\n				\'			</item>\'.\"\\n\";\r\n			} \r\n		}\r\n		$output .= \'	</channel>\'.\"\\n\".\r\n		\'</rss>\';\r\n		break;\r\n	\r\n	default:	// defaul mode\r\n		$output = \'\';\r\n		$title = $modx->documentObject[\'pagetitle\'];\r\n		$link = $modx->config[\'site_url\'].$modx->makeUrl($linkid);\r\n		$modx->regClientCSS(\'<link rel=\"alternate\" type=\"application/rss+xml\" title=\"\'.$title.\'\" href=\"\'.$link.\'\" />\');\r\n        if($showlink) $output = \'<a href=\"\'.$link.\'\">\'.$title.\'</a>\';\r\n		break;\r\n}\r\n\r\nreturn $output;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('25','404form','Configurable Form for Site Feedback','0','0','0','// Email / Contact Form\r\n// Simple XHTML validating email form, that sends different subjects and messages. \r\n// people in a company.\r\n//\r\n// Version 1.0\r\n// September 9, 2005\r\n// ryan@vertexworks.com\r\n//\r\n\r\n// DO NOT ALTER THE FOLLOWING TWO LINES\r\n$subject_array = array();\r\n$recipient_array = array();\r\n\r\n///////////////////////////////////\r\n//  <-----  BEGIN CONFIG  ----->\r\n///////////////////////////////////\r\n// Edit only what\'s between the quotation marks in the lines below.\r\n// These will be the subjects that your users can choose from popup\r\n// lists. You can have as many as you want. Each one must be set up like so:\r\n// $subject_array[] = \"What You Want This Choice To Be\";\r\n// Make sure to remove empty ones that you aren\'t using. Just delete the entire line.\r\n\r\n// Generic email to use for all parts. You can edit\r\n// the individual instances for more control.\r\n// Can be set by using as follows:\r\n// [[ContactForm? &sendTo=`someone@someplace.com`]]\r\n$email = (isset($sendTo))? $sendTo : \'you@url.com\';\r\n\r\n// enter \"static\" in order to use the static subject line\r\n$subject_type = \"static\";\r\n$static_subject = \"[404 Inquiry] \".$modx->config[\'site_url\'];\r\n\r\n// Otherwise use an array of possible subjects\r\n$subject_array[] = \"Survey Info\";\r\n$subject_array[] = \"Company Info\";\r\n$subject_array[] = \"Other Info\";\r\n\r\n// Recipient ... add or remove lines as needed\r\n// Format (as few or as many as desired): \r\n// $recipient_array[\"Your Text Here\"] = \'someone@someplace.com\';\r\n\r\n\r\n// enter \"static\" in order to use the solo recipient\r\n$recipient_type = \"static\";\r\n$static_recipient = \"$email\";\r\n\r\n// Instructions \r\n$instructions = \"Please tell us what you were looking for, and please fill out all fields so we can contact you with any follow-up questions.\";\r\n\r\n// Success Message\r\n$success = \"Thanks for contacting [(site_url)]. Someone will get back to you soon. You may submit another message in the form below.\";\r\n\r\n// Class for containing Success Message <p>\r\n$successClass = \"message\";\r\n\r\n// Failure <p> class\r\n$failClass = \"error\";\r\n\r\n// Empy Field failure message\r\n$emptyFields = \"One of the fields was left blank. Please put something in all fields.\";\r\n\r\n// General failure message\r\n$generalFail = \"Sorry, there was an error! Please try again later.\";\r\n\r\n// Bad email failure message\r\n$emailFail = \"The email address you supplied ({$_POST[\'email\']}) does not appear to be valid. Please try again.\";\r\n\r\n// Debug mode for testing\r\n$debug = false;\r\n\r\n//  <-----  END CONFIG  ----->\r\n///////////////////////////////////\r\n\r\n// Get the page the form is on\r\n$formPage = $modx->documentIdentifier;\r\n\r\nif ($debug && $_POST) {\r\n	$SendMail .= \"POST variables from Document ID {$formPage}:\\n\";\r\n	foreach ($_POST as $key => $value) {\r\n		$SendMail .= \"\\t$key => $value\\n\";\r\n	}\r\n} \r\n\r\nif ($_POST[\'send\'] == \'true\') { \r\n    $to = ($recipient_type==\"static\") ? $static_recipient : $_POST[\'to\'];\r\n    $from = $_POST[\'name\'];\r\n    $from_email = $_POST[\'email\'];\r\n    $the_subject = ($subject_type==\"static\") ? \"$static_subject\" : $_POST[\'subject\'];\r\n    $message = $_POST[\'message\'];\r\n    if ( ($from == \'\')||($from_email == \'\')||($message == \'\') ) {\r\n        $SendMail .= \"<p class=\\\"$failClass\\\">$emptyFields</p>\";\r\n    } elseif (eregi(\"^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,3})$\", $from_email)) {\r\n        $subject = $the_subject;\r\n        $headers = \"From: $from <$from_email>\\r\\n\";\r\n        \r\n        // clean out potential tomfoolery...\r\n        $message = $modx->stripTags($message);\r\n        \r\n        $body = \"Name: $from\\nEmail: $from_email\\nMessage:\\n\\n\" . $message;\r\n        if (mail($to, $subject, $body, $headers)) {\r\n            $SendMail .= \"<p class=\\\"$successClass\\\">$success</p>\";\r\n            $SendMail .= ($debug) ? \"<p>$to\\n$headers\\n$subject\\n$body</p>\" : \'\';\r\n            $from=\"\";\r\n            $from_email=\"\";\r\n            $message=\"\";\r\n        } else {\r\n            $SendMail .= \"<p class=\'$failClass\'>$generalFail</p>\";\r\n            $send = \"false\";\r\n        }\r\n    } else {\r\n        $SendMail .= \"<p class=\\\"$failClass\\\">$emailFail</p>\";\r\n        $send = \"false\";\r\n    } \r\n} else {\r\n    $SendMail .= \"<p>$instructions</p>\";\r\n}\r\n\r\n$SendMail .=<<<EOD\r\n<div class=\"emailform\">\r\n    <form method=\"post\" name=\"EmailForm\" id=\"EmailForm\" action=\"[~{$formPage}~]\" >\r\n        <input type=\"hidden\" name=\"send\" value=\"true\" />\r\n        Your Name:<br />\r\n        <input type=\"text\" name=\"name\" id=\"name\" size=\"30\" value=\"$from\" /><br />\r\n\r\n        Your Email Address:<br />\r\n        <input type=\"text\" name=\"email\" id=\"email\" size=\"30\" value=\"$from_email\" /><br />\r\n\r\n        Help me, I\'m not finding what I\'m looking for:<br />\r\n        <textarea cols=\"60\" rows=\"10\" name=\"message\" id=\"message\">$message</textarea><br />\r\n\r\n        <input type=\"submit\" value=\"Send this Message\" />\r\n    </form>\r\n</div>\r\nEOD;\r\n\r\nreturn $SendMail;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('10','NewsPublisher','Publish news articles directly from the web.','0','0','0','/**\r\n *\r\n *	NewsPublisher for MODx \r\n *	Created by Raymond Irving, August 2005\r\n *	Patch for \'s and redirect to new post by Mark Kaplan, October 2005\r\n *\r\n *	Publish news articles directly from the web\r\n *\r\n *	Parameters:\r\n *		&folder			- folder id where comments are stored\r\n *		&makefolder		- set to 1 to automatically convert the parent document to a folder. Defaults to 0\r\n *		&postid			- document id to load after posting news item. Defaults to the page created\r\n *		&canpost		- comma delimitted web groups that can post comments. leave blank for public posting\r\n *		&badwords		- comma delimited list of words not allowed in post\r\n *		&template		- name of template to use for news post\r\n *		&headertpl		- header template (chunk name) to be inserted at the begining of the news content\r\n *		&footertpl		- footer template (chunk name) to be inserted at the end of the news content\r\n *		&formtpl		- form template (chunk name)\r\n *		&rtcontent		- name of a richtext content form field \r\n *		&rtsummary		- name of a richtext summary form field \r\n *		&showinmenu		- sets the flag to true or false (1|0) as to whether or not it shows in the menu. defaults to false (0)\r\n * 		&aliastitle		- set to 1 to use page title as alias suffix. Defaults to 0 - date created.\r\n *		&clearcache		- when set to 1 the system will automatically clear the site cache after publishing an article.\r\n *\r\n *	Version 1.2 Beta\r\n *\r\n */\r\n \r\n// get user groups that can post articles\r\n$postgrp = isset($canpost) ? explode(\",\",$canpost):array();\r\n$allowAnyPost = count($postgrp)==0 ? true : false;\r\n\r\n// get clear cache\r\n$clearcache	 = isset($clearcache) ? 1:0;\r\n\r\n// get alias title\r\n$aliastitle	 = isset($aliastitle) ? 1:0;\r\n\r\n// get folder id where we should store articles\r\n// else store in current document\r\n$folder = isset($folder) ? intval($folder):$modx->documentIdentifier;\r\n\r\n// set rich text content field\r\n$rtcontent = isset($rtcontent) ? $rtcontent:\'content\';\r\n\r\n// set rich text summary field\r\n$rtsummary = isset($rtsummary) ? $rtsummary:\'introtext\';\r\n\r\n// get header\r\n$header = isset($headertpl) ? \"{{\".$headertpl.\"}}\":\'\';\r\n\r\n// get footer\r\n$footer = isset($footertpl) ? \"{{\".$footertpl.\"}}\":\'\';\r\n\r\n// get postback status\r\n$isPostBack = isset($_POST[\'NewsPublisherForm\']) ? true:false;\r\n\r\n// get badwords\r\nif(isset($badwords)) {\r\n	$badwords = str_replace(\' \',\'\', $badwords);\r\n	$badwords = \"/\".str_replace(\',\',\'|\', $badwords).\"/i\";\r\n}\r\n\r\n// get menu status\r\n$hidemenu = isset($showinmenu) && $showinmenu==1 ? 0 : 1;\r\n\r\n// get template\r\n$template = isset($template) ? $modx->db->getValue(\'SELECT id FROM \'.$modx->getFullTableName(\'site_templates\').\' WHERE templatename=\\\'\'.mysql_escape_string($template).\'\\\'\'):$modx->config[\'default_template\'];\r\n\r\n// get form template\r\nif(isset($formtpl)) $formTpl = $modx->getChunk($formtpl);\r\nif(empty($formTpl)) $formTpl = \'<form name=\"NewsPublisher\" method=\"post\">\r\n	<input name=\"NewsPublisherForm\" type=\"hidden\" value=\"on\" />\r\n	Page title:<br /><input name=\"pagetitle\" type=\"text\" size=\"40\" value=\"[+pagetitle+]\" /><br />\r\n	Long title:<br /><input name=\"longtitle\" type=\"text\" size=\"40\" value=\"[+longtitle+]\" /><br />\r\n	Description:<br /><input name=\"description\" type=\"text\" size=\"40\" value=\"[+description+]\" /><br />\r\n	Published date:<br /><input name=\"pub_date\" type=\"text\" value=\"[+pub_date+]\" size=\"40\" readonly=\"readonly\" />\r\n	<a onClick=\"nwpub_cal1.popup();\" onMouseover=\"window.status=\\\'Select date\\\'; return true;\" onMouseout=\"window.status=\\\'\\\'; return true;\" style=\"cursor:pointer; cursor:hand\"><img align=\"absmiddle\" src=\"manager/media/images/icons/cal.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"Select date\" /></a>\r\n	<a onClick=\"document.NewsPublisher.pub_date.value=\\\'\\\'; return true;\" onMouseover=\"window.status=\\\'Remove date\\\'; return true;\" onMouseout=\"window.status=\\\'\\\'; return true;\" style=\"cursor:pointer; cursor:hand\"><img align=\"absmiddle\" src=\"manager/media/images/icons/cal_nodate.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"Remove date\"></a><br />\r\n	Unpublished date:<br /><input name=\"unpub_date\" type=\"text\" value=\"[+unpub_date+]\" size=\"40\" readonly=\"readonly\" />\r\n	<a onClick=\"nwpub_cal2.popup();\" onMouseover=\"window.status=\\\'Select date\\\'; return true;\" onMouseout=\"window.status=\\\'\\\'; return true;\" style=\"cursor:pointer; cursor:hand\"><img align=\"absmiddle\" src=\"manager/media/images/icons/cal.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"Select date\" /></a>\r\n	<a onClick=\"document.NewsPublisher.unpub_date.value=\\\'\\\'; return true;\" onMouseover=\"window.status=\\\'Remove date\\\'; return true;\" onMouseout=\"window.status=\\\'\\\'; return true;\" style=\"cursor:pointer; cursor:hand\"><img align=\"absmiddle\" src=\"manager/media/images/icons/cal_nodate.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"Remove date\"></a><br />\r\n	Summary:<br /><textarea name=\"introtext\" cols=\"50\" rows=\"5\">[+introtext+]</textarea><br />\r\n	Content:<br /><textarea name=\"content\" cols=\"50\" rows=\"8\">[+content+]</textarea><br />\r\n	<input name=\"send\" type=\"submit\" value=\"Submit\" />\r\n	</form>\r\n	<script language=\"JavaScript\" src=\"manager/media/script/datefunctions.js\"></script>\r\n	<script type=\"text/javascript\">\r\n		var elm_txt = {}; // dummy\r\n		var pub = document.forms[\"NewsPublisher\"].elements[\"pub_date\"];\r\n		var nwpub_cal1 = new calendar1(pub,elm_txt);\r\n		nwpub_cal1.path=\"manager/media/\";\r\n		nwpub_cal1.year_scroll = true;\r\n		nwpub_cal1.time_comp = true;	\r\n\r\n		var unpub = document.forms[\"NewsPublisher\"].elements[\"unpub_date\"];\r\n		var nwpub_cal2 = new calendar1(unpub,elm_txt);\r\n		nwpub_cal2.path=\"manager/media/\";\r\n		nwpub_cal2.year_scroll = true;\r\n		nwpub_cal2.time_comp = true;	\r\n</script>\';\r\n\r\n\r\n// switch block\r\nswitch ($isPostBack) {\r\n	case true:	// process post back\r\n		// remove magic quotes from POST\r\n		if(get_magic_quotes_gpc()){\r\n			$_POST = array_map(\"stripslashes\", $_POST);\r\n		}	\r\n		if(trim($_POST[\'pagetitle\'])==\'\') $modx->webAlert(\'Missing page title.\');\r\n		elseif($_POST[$rtcontent]==\'\') $modx->webAlert(\'Missing news content.\');\r\n		else {\r\n			// get created date\r\n			$createdon = time();\r\n\r\n			// set alias name of document used to store articles\r\n			if(!$aliastitle) $alias = \'article-\'.$createdon;\r\n			else {\r\n				$alias = $modx->stripTags($_POST[\'pagetitle\']);\r\n				$alias = strtolower($alias);\r\n				$alias = preg_replace(\'/&.+?;/\', \'\', $alias); // kill entities\r\n				$alias = preg_replace(\'/[^\\.%a-z0-9 _-]/\', \'\', $alias);\r\n				$alias = preg_replace(\'/\\s+/\', \'-\', $alias);\r\n				$alias = preg_replace(\'|-+|\', \'-\', $alias);\r\n				$alias = trim($alias, \'-\');			\r\n				$alias = \'article-\'.$modx->db->escape($alias);\r\n			}\r\n			\r\n			$user = $modx->getLoginUserName();\r\n			$userid = $modx->getLoginUserID();\r\n			if(!$user && $allowAnyPost) $user = \'anonymous\';\r\n\r\n			// check if user has rights\r\n			if(!$allowAnyPost && !$modx->isMemberOfWebGroup($postgrp)) {\r\n				return \'You are not allowed to publish articles\';\r\n			}\r\n\r\n			$allowedTags = \'<p><br><a><i><em><b><strong><pre><table><th><td><tr><img><span><div><h1><h2><h3><h4><h5><font><ul><ol><li><dl><dt><dd>\';\r\n			\r\n			// format content\r\n			$content = $modx->stripTags($_POST[$rtcontent],$allowedTags);\r\n			$content = str_replace(\'[+user+]\',$user,$content);\r\n			$content = str_replace(\'[+createdon+]\',strftime(\'%d-%b-%Y %H:%M\',$createdon),$content);\r\n			foreach($_POST as $n=>$v) {\r\n				if(!empty($badwords)) $v = preg_replace($badwords,\'[Filtered]\',$v); // remove badwords\r\n				$v = $modx->stripTags(htmlspecialchars($v));\r\n				$v = str_replace(\"\\n\",\'<br />\',$v);\r\n				$content = str_replace(\'[+\'.$n.\'+]\',$v,$content);\r\n			}\r\n\r\n			$title = mysql_escape_string($modx->stripTags($_POST[\'pagetitle\']));\r\n			$longtitle = mysql_escape_string($modx->stripTags($_POST[\'longtitle\']));\r\n			$description = mysql_escape_string($modx->stripTags($_POST[\'description\']));\r\n			$introtext = mysql_escape_string($modx->stripTags($_POST[$rtsummary],$allowedTags));\r\n			$pub_date = $_POST[\'pub_date\'];\r\n			$unpub_date = $_POST[\'unpub_date\'];\r\n			$published = 1;\r\n\r\n			// check published date\r\n			if($pub_date==\"\") {\r\n				$pub_date=\"0\";\r\n			} else {\r\n				list($d, $m, $Y, $H, $M, $S) = sscanf($pub_date, \"%2d-%2d-%4d %2d:%2d:%2d\");\r\n				$pub_date = strtotime(\"$m/$d/$Y $H:$M:$S\");\r\n				if($pub_date < $createdon) {\r\n					$published = 1;\r\n				}  elseif($pub_date > $createdon) {\r\n					$published = 0;	\r\n				}\r\n			}\r\n\r\n			// check unpublished date\r\n			if($unpub_date==\"\") {\r\n				$unpub_date=\"0\";\r\n			} else {\r\n				list($d, $m, $Y, $H, $M, $S) = sscanf($unpub_date, \"%2d-%2d-%4d %2d:%2d:%2d\");\r\n				$unpub_date = strtotime(\"$m/$d/$Y $H:$M:$S\");\r\n				if($unpub_date < $createdon) {\r\n					$published = 0;\r\n				}\r\n			}\r\n			\r\n			// set menu index\r\n			$mnuidx = $modx->db->getValue(\'SELECT MAX(menuindex)+1 as \\\'mnuidx\\\' FROM \'.$modx->getFullTableName(\'site_content\').\' WHERE parent=\\\'\'.$folder.\'\\\'\');\r\n			if($mnuidx<1) $mnuidx = 0;\r\n			\r\n			// post news content\r\n			$flds = array(\r\n				\'pagetitle\'	=> $title,\r\n				\'longtitle\'	=> $longtitle,\r\n				\'description\'=> $description,\r\n				\'introtext\'	=> $introtext,\r\n				\'alias\'		=> $alias,\r\n				\'parent\'	=> $folder, \r\n				\'createdon\' => $createdon,\r\n				\'createdby\' => ($userid>0 ? $userid * -1:0),\r\n				\'editedon\' 	=> \'0\',\r\n				\'editedby\' 	=> \'0\',\r\n				\'published\' => $published,\r\n				\'pub_date\'	 => $pub_date,\r\n				\'unpub_date\' => $unpub_date,\r\n				\'deleted\' 	=> \'0\',\r\n				\'hidemenu\' 	=> $hidemenu,\r\n				\'menuindex\'	=> $mnuidx,\r\n				\'template\' 	=> $template,\r\n				\'content\' 	=> mysql_escape_string($header.$content.$footer)\r\n			);\r\n			$redirectid = $modx->db->insert($flds,$modx->getFullTableName(\'site_content\'));\r\n			if(!empty($makefolder)) {\r\n				// convert parent into folder\r\n				$modx->db->update(array(\'isfolder\'=>\'1\'),$modx->getFullTableName(\'site_content\'),\'id=\\\'\'.$folder.\'\\\'\');\r\n			}\r\n\r\n			// empty cache\r\n			if($clearcache==1){\r\n				include_once $modx->config[\'base_path\'].\"manager/processors/cache_sync.class.processor.php\";\r\n				$sync = new synccache();\r\n				$sync->setCachepath(\"assets/cache/\");\r\n				$sync->setReport(false);\r\n				$sync->emptyCache(); // first empty the cache		\r\n			}\r\n\r\n			// get redirect/post id\r\n			$redirectid = $modx->db->getValue(\'SELECT id as \\\'redirectid\\\' FROM \'.$modx->getFullTableName(\'site_content\').\' WHERE createdon=\\\'\'.$createdon.\'\\\'\');\r\n			$postid = isset($postid) ? $postid:$redirectid;\r\n			\r\n			// redirect to post id\r\n			$modx->sendRedirect($modx->makeUrl($postid));\r\n		}\r\n	\r\n	default:	// display news form\r\n		// check if user has rights to post comments\r\n		if(!$allowAnyPost && !$modx->isMemberOfWebGroup($postgrp)) {\r\n			$formTpl = \'\';\r\n		}\r\n		else {\r\n			foreach($_POST as $n=>$v) {\r\n				$formTpl = str_replace(\'[+\'.$n.\'+]\',$v,$formTpl);\r\n			}	\r\n		}\r\n		// return form\r\n		return $message.$formTpl;\r\n		break;\r\n}\r\n','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('11','PoweredBy','A little link to MODx','0','0','0','/*\r\n *	PoweredBy \r\n *	A little link to MODx\r\n *\r\n */\r\n \r\n$version = $modx->getVersionData();\r\nreturn \"<div>Powered by MODx<b> \".$version[\'version\'].\"</b> \".( $version[\'code_name\']!=\"\" ? \"<i>(\".$version[\'code_name\'].\")</i>.</div>\":\"\");','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('13','PageTrail','Outputs the page trail, based on Bill Wilson\'s script','0','0','0','/*\r\n * PageTrail - updated to work with MODx\r\n *\r\n * Properties:\r\n *\r\n *	&sep 	- page trail separator\r\n *	&style	- inline style\r\n *	&class	- style sheet name\r\n */\r\n \r\n\r\n$sep = isset($sep) ? $sep :\" &raquo; \";\r\n$style = isset($style) ? \" style=\\\"$style\\\" \" :\"\";\r\n$class = isset($class) ? \" class=\\\"$class\\\" \" :\"\";\r\n\r\n// end config\r\n$ptarr = array();\r\n$pid = $etomite->documentObject[\'parent\'];\r\n$ptarr[] = \"<a $class $style href=\'[~\".$etomite->documentObject[\'id\'].\"~]\'>\".$etomite->documentObject[\'pagetitle\'].\"</a>\";\r\n\r\nwhile ($parent=$etomite->getPageInfo($pid)) {\r\n    $ptarr[] = \"<a $class $style href=\'[~\".$parent[\'id\'].\"~]\'>\".$parent[\'pagetitle\'].\"</a>\";\r\n    $pid = $parent[\'parent\'];\r\n}\r\n\r\n$ptarr = array_reverse($ptarr);\r\nreturn join($ptarr, $sep);','0','&sep=Separator;string; &style=Style;string; &class=Class;string;','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('14','WebLogin','Web User Login Snippet','0','0','0','# WebLogin 1.0\r\n# Created By Raymond Irving 2004\r\n#::::::::::::::::::::::::::::::::::::::::\r\n# Usage: 	\r\n#	Allows a web user to login to the website\r\n#\r\n# Params:	\r\n#	&loginhomeid 	- (Optional)\r\n#		redirects the user to first authorized page in the list.\r\n#		If no id was specified then the login home page id or \r\n#		the current document id will be used\r\n#\r\n#	&logouthomeid 	- (Optional)\r\n#		document id to load when user logs out	\r\n#\r\n#	&pwdreqid 	- (Optional)\r\n#		document id to load after the user has submited\r\n#		a request for a new password\r\n#\r\n#	&pwdactid 	- (Optional)\r\n#		document id to load when the after the user has activated\r\n#		their new password\r\n#\r\n#	&logintext		- (Optional) \r\n#		Text to be displayed inside login button (for built-in form)\r\n#\r\n#	&logouttext 	- (Optional)\r\n#		Text to be displayed inside logout link (for built-in form)\r\n#	\r\n#	&formtpl			- (Optional)\r\n#		Chunk name or document id to as a template\r\n#				  \r\n#	Note: Templats design:\r\n#			section 1: login template\r\n#			section 2: logout template \r\n#			section 3: password reminder template \r\n#\r\n#			See weblogin.tpl for more information\r\n#\r\n# Examples:\r\n#\r\n#	[[WebLogin? &loginhomeid=`8` &logouthomeid=`1`]] \r\n#\r\n#	[[WebLogin? &loginhomeid=`8,18,7,5` &tpl=`Login`]] \r\n\r\n# Set Snippet Paths \r\n$snipPath  = (($modx->insideManager())? \"../\":\"\");\r\n$snipPath .= \"assets/snippets/\";\r\n\r\n# check if inside manager\r\nif ($m = $modx->insideManager()) {\r\n	return \'\'; # don\'t go any further when inside manager\r\n}\r\n\r\n# deprecated params - only for backward compatibility\r\nif($loginid) $loginhomeid=$loginid;\r\nif($logoutid) $logouthomeid = $logoutid;\r\nif($template) $tpl = $template;\r\nif($tpl) $formtpl = $tpl;\r\n\r\n# Snippet customize settings\r\n$liHomeId	= isset($loginhomeid)? explode(\",\",$loginhomeid):array($modx->config[\'login_home\'],$modx->documentIdentifier);\r\n$loHomeId	= isset($logouthomeid)? $logouthomeid:$modx->documentIdentifier;\r\n$pwdReqId	= isset($pwdreqid)? $pwdreqid:0;\r\n$pwdActId	= isset($pwdactid)? $pwdactid:0;\r\n$loginText	= isset($logintext)? $logintext:\'Login\';\r\n$logoutText	= isset($logouttext)? $logouttext:\'Logout\';\r\n$tpl			= isset($formtpl)? $formtpl:\"\";\r\n\r\n# System settings\r\n$isLogOut		= $_REQUEST[\'webloginmode\']==\'lo\' ? 1:0;\r\n$isPWDActivate	= $_REQUEST[\'webloginmode\']==\'actp\' ? 1:0;\r\n$isPostBack		= count($_POST) && isset($_POST[\'cmdweblogin\']);\r\n$isPWDReminder	= $isPostBack && $_REQUEST[\'txtpwdrem\']==\'1\' ? 1:0;\r\n\r\n$cookieKey = substr(md5($site_id.\"Web-User\"),0,15);\r\n\r\n# Start processing\r\ninclude_once $snipPath.\"weblogin/weblogin.common.inc.php\";\r\ninclude_once (\"manager/includes/crypt.class.inc.php\");\r\n\r\nif ($isPWDActivate || $isPWDReminder || $isLogOut || $isPostBack) {\r\n	# include the logger class\r\n	include_once \"manager/includes/log.class.inc.php\";\r\n	include_once $snipPath.\"weblogin/weblogin.processor.inc.php\";\r\n}\r\n\r\ninclude_once $snipPath.\"weblogin/weblogin.inc.php\";\r\n\r\n# Return\r\nreturn $output;\r\n\r\n','0','&loginhomeid=Login Home Id;string; &logouthomeid=Logout Home Id;string; &logintext=Login Button Text;string; &logouttext=Logout Button Text;string; &tpl=Template;string;','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('15','WebChangePwd','Web User Change Password Snippet','0','0','0','# WebChangePwd 1.0\r\n# Created By Raymond Irving April, 2005\r\n#::::::::::::::::::::::::::::::::::::::::\r\n# Usage: 	\r\n#	Allows a web user to change his/her password from the website\r\n#\r\n# Params:	\r\n#\r\n#	&tpl			- (Optional)\r\n#		Chunk name or document id to use as a template\r\n#				  \r\n#	Note: Templats design:\r\n#			section 1: change pwd template\r\n#			section 2: notification template \r\n#\r\n# Examples:\r\n#\r\n#	[[WebChangePwd? &tpl=`ChangePwd`]] \r\n\r\n# Set Snippet Paths \r\n$snipPath  = (($modx->insideManager())? \"../\":\"\");\r\n$snipPath .= \"assets/snippets/\";\r\n\r\n# check if inside manager\r\nif ($m = $modx->insideManager()) {\r\n	return \'\'; # don\'t go any further when inside manager\r\n}\r\n\r\n\r\n# Snippet customize settings\r\n$tpl		= isset($tpl)? $tpl:\"\";\r\n\r\n# System settings\r\n$isPostBack		= count($_POST) && isset($_POST[\'cmdwebchngpwd\']);\r\n\r\n# Start processing\r\ninclude_once $snipPath.\"weblogin/weblogin.common.inc.php\";\r\ninclude_once $snipPath.\"weblogin/webchangepwd.inc.php\";\r\n\r\n# Return\r\nreturn $output;\r\n\r\n\r\n\r\n','0','&tpl=Template;string;','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('16','WebSignup','Web User Signup Snippet','0','0','0','# WebSignup 1.1\r\n# Created By Raymond Irving April, 2005\r\n#::::::::::::::::::::::::::::::::::::::::\r\n# Usage: 	\r\n#	Allows a web user to signup for a new web account from the website\r\n#	This snippet provides a basic set of form fields for the signup form\r\n#	You can customize this snippet to create your own signup form\r\n#\r\n# Params:	\r\n#\r\n#	&tpl		- (Optional) Chunk name or document id to use as a template\r\n#	&groups		- Web users groups to be assigned to users\r\n#				  \r\n#	Note: Templats design:\r\n#			section 1: signup template\r\n#			section 2: notification template \r\n#\r\n# Examples:\r\n#\r\n#	[[WebSignup? &formtpl=`SignupForm` &groups=`NewsReaders,WebUsers`]] \r\n\r\n# Set Snippet Paths \r\n$snipPath  = (($modx->insideManager())? \"../\":\"\");\r\n$snipPath .= \"assets/snippets/\";\r\n\r\n# check if inside manager\r\nif ($m = $modx->insideManager()) {\r\n	return \'\'; # don\'t go any further when inside manager\r\n}\r\n\r\n# Snippet customize settings\r\n$tpl = isset($formtpl)? $formtpl:\"\";\r\n\r\n# setup web groups\r\n$groups = isset($groups) ? explode(\',\',$groups):array();\r\nfor($i=0;$i<count($groups);$i++) $groups[$i] = trim($groups[$i]);\r\n\r\n# System settings\r\n$isPostBack = count($_POST) && isset($_POST[\'cmdwebsignup\']);\r\n\r\n# Start processing\r\ninclude_once $snipPath.\"weblogin/weblogin.common.inc.php\";\r\ninclude_once $snipPath.\"weblogin/websignup.inc.php\";\r\n\r\n# Return\r\nreturn $output;\r\n','0','&tpl=Template;string;','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('17','NewsUserComments','Add user comments to documents.','0','0','0','/**\r\n *\r\n *	UserComments for MODx\r\n *	Created by Raymond Irving, July 2005\r\n *	Updated October 4, 2005\r\n *\r\n *	Add user comments to documents\r\n *\r\n *	Parameters:\r\n *		&displaytpl		- display template (chunk name)\r\n *		&formtpl		- form template (chunk name)\r\n *\r\n *		&canpost		- comma delimitted web groups that can post comments. leave blank for public posting\r\n *		&canview		- comma delimitted web groups that can view comments. leave blank for public viewing\r\n *		&badwords		- comma delimited list of words not allowed in post\r\n *		&makefolder		- set to 1 to automatically convert the parent document to a folder. Defaults to 0\r\n *		&folder			- folder id where comments are stored\r\n *		&tagid			- a unique id used to identify or tag user comments on a page where multiple comments are required. \r\n *		&freeform		- set this option to 1 to use the [+UserComments.Form+] placholder to relocate the comment form. \r\n *\r\n *		&postcss		- sets the css class used to format the comment block DIV\r\n *		&titlecss		- sets the css class used to format the comment title DIV\r\n *		&codecss		- sets the css class used to format code tags\r\n *		&numbecss		- sets the css class used to format the comment number DIV\r\n *		&authorcss		- sets the css class used identify author\'s comments\r\n *		&ownercss		- sets the css class used identify the owner\'s comments\r\n *		&altrowcss		- sets the css class used identify author\'s comments\r\n * \r\n *		&dateformat		- sets php date format for new comments (see http://php.net/strftime for formatting options)\r\n *		&sortorder		- sort the comments in either ascending order (when set to 0) or descending order (when set to 1). Defaults to descending (1)\r\n *		&recentposts	- set the number of recent posts to be displayed. set to 0 to show all post. Defaults to 0\r\n *\r\n *	Version 1.0 Beta\r\n *\r\n */\r\n \r\n// redirect to host document if an attempt was \r\n// made to display the document containing the comments\r\nif(isset($hostid)) {\r\n	$url = $modx->makeUrl($hostid);\r\n	$modx->sendRedirect($url);\r\n	exit;\r\n}\r\n\r\n// get user groups that can post & view comments\r\n$postgrp = isset($canpost) ? explode(\",\",$canpost):array();\r\n$viewgrp = isset($canview) ? explode(\",\",$canview):array();\r\n$allowAnyPost = count($postgrp)==0 ? true : false;\r\n$allowAnyView = count($viewgrp)==0 ? true : false;\r\n\r\n// get current document id\r\n$docid = $modx->documentIdentifier;\r\n\r\n// get folder id where we should store comments \r\n// else store in current document\r\n$folder = isset($folder) ? intval($folder):$docid;\r\n\r\n// get free form option\r\n$freeform = isset($freeform) && $freeform==1 ? 1:0;\r\n\r\n// get tagid\r\n$tagid = isset($tagid) ? preg_replace(\"/[^A-z0-9_\\-]/\",\'\',$tagid):\'\';\r\n\r\n// set alias name of document used to store comments\r\n$alias = \'usrcmt-\'.$docid.($tagid ? \'-\'.$tagid:\'\');\r\n\r\n// get sort order\r\n$sortorder = isset($sortorder) ? $sortorder : 1;\r\n\r\n// get comment block style/class\r\n$postcss = isset($postcss) ? \' class=\"\'.$postcss.\'[+altrowclass+][+authorclass+]\"\' : \' style=\"font-size:11px;line-height: 17px;white-space:normal;width:100%;background-color:#eee;color: #111;padding:5px;margin-bottom:10px;\" class=\"[+altrowclass+][+authorclass+]\"\';\r\n\r\n// get post title class\r\n$titlecss = isset($titlecss) ? \' class=\"\'.$titlecss.\'\"\' : \' style=\"width:100%;background-color:#c0c0c0;padding:2px;margin-bottom:5px;\"\';\r\n\r\n// get post number class\r\n$numbercss = isset($numbercss) ? \' class=\"\'.$numbercss.\'\"\' : \' style=\"float:right; padding: 0 0 20px 20px;font-size:24px;color:#ccc;font-weight:bold;\"\';\r\n\r\n// get code style/class\r\n$codecss = isset($codecss) ? \' class=\"\'.$codecss.\'\"\' : \' style=\"background-color:#eee;border-top:2px solid #e0e0e0;margin:0;\"\';\r\n\r\n// get author class\r\n$authorcss = isset($authorcss) ? \' \'.$authorcss : \'\';\r\n\r\n// get owner\'s class\r\n$ownercss = isset($ownercss) ? \' \'.$ownercss : \'\';\r\n\r\n// get alt row style/class\r\n$altrowcss = isset($altrowcss) ? \' \'.$altrowcss : \'\';\r\n\r\n// get date format\r\n$dateformat = isset($dateformat) ? $dateformat : \'%e%b%Y %I:%M%p\';\r\n\r\n// set recent post value\r\n$recentposts = isset($recentposts) ? $recentposts : 0;\r\n\r\n// get badwords\r\nif(isset($badwords)) {\r\n	$badwords = str_replace(\' \',\'\', $badwords);\r\n	$badwords = \"/\".str_replace(\',\',\'|\', $badwords).\"/i\";\r\n}\r\n\r\n// set splitter\r\n$splitter = \'<!--Comment-Spliter:\'.$docid.\'-->\';\r\n\r\n// get postback status\r\n$isPostBack = isset($_POST[\'UserCommentForm\'.$tagid]) ? true:false;\r\n\r\n// get display template\r\nif(isset($displaytpl)) $displayTpl = $modx->getChunk($displaytpl);\r\nif(empty($displaytpl)) $displayTpl = \'\r\n[+UID:[+uid+]+]<div[+postclass+]>\r\n   <div[+numberclass+]>\r\n     [+postnumber+]\r\n   </div>\r\n	<div[+titleclass+]>\r\n		<strong>[+subject+]</strong><span>[+user+] [+createdon+]</span>\r\n	</div>\r\n	<div class=\"content\">\r\n		[+comment+]\r\n	</div>\r\n\r\n</div>\r\n\';\r\n\r\n// get form template\r\nif(isset($formtpl)) $formTpl = $modx->getChunk($formtpl);\r\nif(empty($formTpl)) $formTpl = \'\r\n<form method=\"post\" action=\"[~[*id*]~]\">\r\n	<input name=\"[+tagname+]\" type=\"hidden\" value=\"on\" />\r\n	Subject:<br /><input name=\"subject\" type=\"text\" size=\"40\" value=\"\" /><br />\r\n	Comment:<br /><textarea name=\"comment\" cols=\"50\" rows=\"8\"></textarea><br />\r\n	<input name=\"send\" type=\"submit\" value=\"Submit\" />\r\n</form>\r\n\';\r\n\r\n\r\n// switch block\r\nswitch ($isPostBack) {\r\n	case true:	// process post backs\r\n		if($_POST[\'comment\']!=\'\') {\r\n			\r\n			// get user\'s id and name\r\n			$uid = $modx->getLoginUserID();\r\n			$user = $modx->getLoginUserName();\r\n			if(!$user && $allowAnyPost) $user = \'anonymous\';\r\n\r\n			// check if user has rights\r\n			if(!$allowAnyPost && !$modx->isMemberOfWebGroup($postgrp)) {\r\n				return \'You are not allowed to post comments\';\r\n			}\r\n\r\n			$createdon = time();\r\n\r\n// format comment title, classes and/or styles\r\n			$comment = str_replace(\'[+user+]\',$user,$displayTpl);\r\n			$comment = str_replace(\'[+uid+]\',$uid,$comment);\r\n			$comment = str_replace(\'[+postclass+]\',$postcss,$comment);\r\n			$comment = str_replace(\'[+titleclass+]\',$titlecss,$comment);\r\n			$comment = str_replace(\'[+numberclass+]\',$numbercss,$comment);\r\n			$comment = str_replace(\'[+createdon+]\',strftime($dateformat,$createdon),$comment);			\r\n			// check for author\'s comments\r\n			if($uid && ($uid*-1)==$modx->documentObject[\'createdby\']) {\r\n				$comment = str_replace(\'[+authorclass+]\',$authorcss,$comment);\r\n			}\r\n            \r\n            // deal with code tags and bad words\r\n			foreach($_POST as $n=>$v) {\r\n				if(!empty($badwords)) $v = preg_replace($badwords,\'[Filtered]\',$v); // remove badwords\r\n				$v = $modx->stripTags(htmlspecialchars($v));\r\n				if($n==\'comment\' && strpos($v,\'[code]\')!==false){\r\n					// preserve code\r\n					preg_match_all(\"|\\[code\\](.*)\\[/code\\]|Uis\",$v,$matches);\r\n					for ($i=0;$i<count($matches[0]);$i++) {\r\n						$tag = $matches[0][$i];\r\n						$text = $matches[1][$i];\r\n						$v = str_replace($tag,\'<pre\'.$codecss.\'>\'.$text.\'</pre>\',$v);\r\n					}\r\n				}\r\n				$v = str_replace(\"\\r\",\'\',$v);\r\n				$v = str_replace(\"\\n\",\'<br />\',$v);\r\n				$comment = str_replace(\'[+\'.$n.\'+]\',$v,$comment);\r\n			}\r\n\r\n			$comment = str_replace($splitter,\'\',$comment); // remove splitter from comment\r\n\r\n			// save comment\r\n			$sql = \'SELECT pagetitle FROM \'.$modx->getFullTableName(\'site_content\').\' WHERE parent=\\\'\'.$folder.\'\\\' AND alias=\\\'\'.$alias.\'\\\' LIMIT 1\';\r\n			if($modx->db->getValue($sql)) {\r\n				// update comments\r\n				$sql = 	\' UPDATE \'.$modx->getFullTableName(\'site_content\').\r\n						\' SET content = CONCAT(\\\'\'.$comment.$splitter.\'\\\',content)\'.\r\n						\' WHERE parent=\\\'\'.$folder.\'\\\' AND alias=\\\'\'.$alias.\'\\\'\';\r\n				$modx->db->query($sql);\r\n			}\r\n			else {\r\n				// create new comment page\r\n				$doc = $modx->getDocument($docid);\r\n				$title = mysql_escape_string($doc[\'pagetitle\']).\' - User comments\';\r\n				$flds = array(\r\n					\'pagetitle\'	=> $title,\r\n					\'alias\'		=> $alias,\r\n					\'parent\'	=> $folder, \r\n					\'createdon\' => $createdon,\r\n					\'createdby\' => \'0\',\r\n					\'editedon\' 	=> \'0\',\r\n					\'editedby\' 	=> \'0\',\r\n					\'published\' => \'1\',\r\n					\'deleted\' 	=> \'0\',\r\n					\'hidemenu\' 	=> \'1\',\r\n					\'template\' 	=> \'0\',\r\n					\'content\' 	=> $comment.$splitter.\'[[\'.$modx->getSnippetName().\'? &hostid=`\'.$docid.\'`]]\'\r\n				);\r\n				$modx->db->insert($flds,$modx->getFullTableName(\'site_content\'));\r\n				if(!empty($makefolder)) {\r\n					// convert parent into folder\r\n					$modx->db->update(array(\'isfolder\'=>\'1\'),$modx->getFullTableName(\'site_content\'),\'id=\\\'\'.$folder.\'\\\'\');\r\n				}\r\n			}\r\n		}\r\n	\r\n	default:	// display comments\r\n		// check if user has rights to view comments\r\n		if(!$allowAnyView && !$modx->isMemberOfWebGroup($viewgrp)) {\r\n			$comment = \'\';\r\n		}\r\n		else {\r\n\r\n			$uid = $modx->getLoginUserID();\r\n\r\n			// get comments\r\n			$ds = $modx->db->select(\'content\',$modx->getFullTableName(\'site_content\'),\' parent=\\\'\'.$folder.\'\\\' AND alias=\\\'\'.$alias.\'\\\'\');\r\n			$content = $modx->db->getValue($ds);\r\n\r\n			// split content into separate comments\r\n			$parts = explode($splitter,$content);\r\n			array_pop($parts);\r\n			\r\n			// count comments\r\n			$count = count($parts);			\r\n			$modx->setPlaceholder(\"UserComments.Count\",$count);\r\n\r\n			// handle recent post\r\n			$offset = 0;\r\n			if($recentposts>0) {\r\n				$parts = array_slice($parts,0,$recentposts);\r\n				$offset = $count-$recentposts;\r\n				$count = $recentposts;\r\n			}\r\n			\r\n			// prepare comments\r\n			if($sortorder==0) $parts = array_reverse($parts);\r\n			for($i=0;$i<$count;$i++) {\r\n				$part = $parts[$i];\r\n				$num = ($sortorder==1) ? $count-$i:$i+1;\r\n				$part = str_replace(\'[+postnumber+]\',$num+$offset,$part);\r\n				if($altrowcss && ($i % 2)==0) $part = str_replace(\'[+altrowclass+]\',$altrowcss,$part);\r\n				// check for owner\'s comments\r\n				if($uid && strpos($part,\'[+UID:\'.$uid.\'+]\')!==false) $part = str_replace(\'[+authorclass+]\',$ownercss,$part);\r\n				$parts[$i] = $part;\r\n			}\r\n			\r\n			$comments = implode(\"\",$parts);\r\n			\r\n		}\r\n		// check if user has rights to post comments\r\n		if(!$allowAnyPost && !$modx->isMemberOfWebGroup($postgrp)) {\r\n			$formTpl = \'\';\r\n		}\r\n		else{\r\n			$formTpl = str_replace(\'[+tagname+]\',\'UserCommentForm\'.$tagid,$formTpl);\r\n		}\r\n\r\n		// return comments along with form\r\n		return $comments.($freeform ? $modx->setPlaceholder(\'UserComments.Form\',$formTpl):$formTpl);\r\n		break;\r\n}\r\n','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('19','DropMenu','Menuzilla','0','0','0','// ###########################################\r\n// DropMenu                                  #\r\n// ###########################################\r\n// Configurable menu / navigation builder using UL tags\r\n// Offers optional DIV wrappers for top level and nested menus (useful for hover zones)\r\n// as well as configurable classes for the DIV, UL, and LI elements.  It even\r\n// marks ancestors of and the current element with a hereClass (indicating you are here \r\n// and in this area of the site).  Also applies .last CSS class to final LI in each UL.\r\n//\r\n// Developed by Vertexworks.com and Opengeek.com\r\n// Feel free to use if you keep this header and credits in place\r\n//\r\n// Inspired by List Site Map by Jaredc, SimpleList by Bravado, \r\n// and ListMenuX by OpenGeek\r\n//\r\n// Configuration parameters:\r\n// \r\n// &menuName        - name of a placeholder for placing the output in the layout\r\n// &topnavClass     - CSS class for styling the class assigned to the outermost UL\r\n// \r\n// TO DO: configuration parameters above, more usage examples, CSS examples, output indenting\r\n\r\n// ###########################################\r\n// Usage Examples                            #\r\n// ###########################################\r\n// Creates menu with wrapping DIV with id=myMenu, starting at the site root, two levels deep,\r\n// with descriptions next to the links, and nested UL elements with class=nestedLinks; output\r\n// of menu can be placed in layout using placeholder named myMenu ( e.g. [ +myMenu+ ] )\r\n// [[DropMenu? &menuName=`myMenu` &startDoc=`0` &levelLimit=`2` &topdiv=`true` &showDescription=`true` &subnavClass=`nestedLinks`]]\r\n//\r\n// Creates topMenu from site root, including only 1 level, with class=topMenubar applied to the top level UL\r\n// and class=activeLink applied to current page LI\r\n// [[DropMenu? &menuName=`topMenu` &startDoc=`0` &levelLimit=`1` &topnavClass=`topMenubar` &here=`activeLink`]]\r\n//\r\n// Creates dropmenu 3 levels deep, with DIV wrappers around all nested lists styled with class=hoverZone\r\n// and currentPage LI styled with class=currentPage\r\n// [[DropMenu? &levelLimit=3 &subdiv=true &subdivClass=hoverZone &subnavClass=menuZone &here=currentPage]]\r\n//\r\n// Creates dropmenu of infinite levels, ordered by menutitle in descending order\r\n// [[DropMenu?orderBy=menutitle&orderDesc=true]]\r\n\r\n// ###########################################\r\n// Configuration parameters                  #\r\n// ###########################################\r\n\r\n// $phMode [ true | false ]\r\n// Whether you want it to output a [+placeholder+] or simply return the output.\r\n// Defaults to false.\r\n$phMode = false;\r\n\r\n// $menuName [ string ]\r\n// Sets the name of the menu, placeholder, and top level DIV id (if topdiv \r\n// option is true). Set to \"dropmenu\" by default.\r\n$phName = (!isset($phName)) ? \'dropmenu\' : \"$phName\";\r\n\r\n// $siteMapRoot [int]\r\n// The parent ID of your root. Default 0. Can be set in \r\n// snippet call with startDoc (to doc id 10 for example):\r\n// [[DropMenu?startDoc=10]]\r\n$siteMapRoot = 0;\r\n\r\n// $removeNewLines [ true | false ]\r\n// If you want new lines removed from code, set to true. This is generally\r\n// better for IE when lists are styled vertically. \r\n$removeNewLines = (!isset($removeNewLines)) ? false : ($removeNewLines==true);\r\n\r\n// $maxLevels [ int ]\r\n// Maximum number of levels to include. The default 0 will allow all\r\n// levels. Also settable with snippet variable levelLimit:\r\n// [[DropMenu?levelLimit=2]]\r\n$maxLevels = 0;\r\n\r\n\r\n// $textOfLinks [ string ]\r\n// What database field do you want the actual link text to be?\r\n// The default is pagetitle because it is always a valid (not empty)\r\n// value, but if you prefer it can be any of the following:\r\n// menutitle, id, pagetitle, description, parent, alias, longtitle, introtext\r\n// TO DO: set text to be first non-empty of an array of options\r\n$textOfLinks = (!isset($textOfLinks)) ? \'menutitle\' : \"$textOfLinks\";\r\n\r\n// $titleOfLinks [ string ]\r\n// What database field do you want the title of your links to be?\r\n// The default is pagetitle because it is always a valid (not empty)\r\n// value, but if you prefer it can be any of the following:\r\n// menutitle, id, pagetitle, description, parent, alias, longtitle, introtext\r\n$titleOfLinks = (!isset($titleOfLinks)) ? \'description\' : \"$titleOfLinks\";\r\n\r\n// $pre [ string ]\r\n// Text to append before links inside of LIs\r\n$pre = (!isset($pre)) ? \'\' : \"$pre\";\r\n\r\n// $post [ string ]\r\n// Text to append before links inside of LIs\r\n$post = (!isset($post)) ? \'\' : \"$post\";\r\n\r\n// $selfAsLink [ true | false ]\r\n// Define if the current page should be a link (true) or not (false)\r\n$selfAsLink = (!isset($selfAsLink)) ? false : ($selfAsLink==true);\r\n\r\n// $hereClass [ string ]\r\n// CSS Class for LI and A when they are the currently selected page, as well\r\n// as any ancestors of the current page (YOU ARE HERE)\r\n$hereClass = (!isset($hereClass)) ? \'here\' : $hereClass;\r\n\r\n\r\n\r\n// $showDescription [true | false]\r\n// Specify if you would like to include the description\r\n// with the page title link.\r\n$showDescription = (!isset($showDescription)) ? false : ($showDescription==true);\r\n\r\n// $descriptionField [ string ]\r\n// What database field do you want the description to be?\r\n// The default is description. If you specify a field, it will attempt to use it\r\n// first then fall back until it finds a non-empty field in description, introtext,\r\n// then longtitle so it really tries not be empty. It can be any of the following:\r\n// menutitle, id, pagetitle, description, parent, alias, longtitle, introtext\r\n// TO DO: set description to the first non-empty of an array of options\r\n$descriptionField = (!isset($descriptionField)) ? \'description\' : \"$descriptionField\";\r\n\r\n\r\n// $topdiv [ true | false ]\r\n// Indicates if the top level UL is wrapped by a containing DIV block\r\n$topdiv = (!isset($topdiv)) ? false : ($topdiv==true);\r\n\r\n// $topdivClass [ string ]\r\n// CSS Class for DIV wrapping top level UL\r\n$topdivClass = (!isset($topdivClass)) ? \'topdiv\' : \"$topdivClass\";\r\n\r\n// $topnavClass [ string ]\r\n// CSS Class for the top-level (root) UL\r\n$topnavClass = (!isset($topnavClass)) ? \'topnav\' : \"$topnavClass\";\r\n\r\n\r\n\r\n// $useCategoryFolders [ true | false ]\r\n// If you want folders without any content to render without a link to be used\r\n// as \"category\" pages (defaults to true). In order to use Category Folders, \r\n// the template must be set to (blank) or it won\'t work properly.\r\n$useCategoryFolders = (!isset($useCategoryFolders)) ? true : \"$useCategoryFolders\";\r\n\r\n// $categoryClass [ string ]\r\n// CSS Class for folders with no content (e.g., category folders)\r\n$categoryClass = (!isset($categoryClass)) ? \'category\' : \"$categoryClass\";\r\n\r\n\r\n\r\n// $subdiv [ true | false ]\r\n// Indicates if nested UL\'s should be wrapped by containing DIV blocks\r\n// This is useful for creating \"hover zones\" \r\n// (see http://positioniseverything.net/css-dropdowns.html for a demo)\r\n// TO CONSIDER: Setting a subdiv class at all turns on hover DIVs?\r\n$subdiv = (!isset($subdiv)) ? false : ($subdiv==true);\r\n\r\n// $subdivClass [ string ]\r\n// CSS Class for DIV blocks wrapping nested UL elements\r\n$subdivClass = (!isset($subdivClass)) ? \'subdiv\' : \"$subdivClass\";\r\n\r\n\r\n\r\n// $orderBy [ string ]\r\n// Document field to sort menu by\r\n$orderBy = (!isset($orderBy)) ? \'menuindex\' : \"$orderBy\";\r\n\r\n// $orderDesc [true | false]\r\n// Order results in descending order?  default is false\r\n$orderDesc = (!isset($orderDesc)) ? false : ($orderDesc==true);\r\n\r\n// ###########################################\r\n// End config, the rest takes care of itself #\r\n// ###########################################\r\n\r\n$debugMode = false;\r\n\r\n// Initialize\r\n$MakeMap = \"\";\r\n$siteMapRoot = (isset($startDoc)) ? $startDoc : $siteMapRoot;\r\n$maxLevels = (isset($levelLimit)) ? $levelLimit : $maxLevels;\r\n$ie = ($removeNewLines) ? \'\' : \"\\n\";\r\n\r\n// Overcome single use limitation on functions\r\nglobal $MakeMap_Defined;\r\n\r\nif (!isset ($MakeMap_Defined)) {\r\n	function filterHidden($var) {\r\n		return (!$var[\'hidemenu\']==1);\r\n	}\r\n	function filterEmpty($var) {\r\n	    return (!empty($var));\r\n	}\r\n	function MakeMap($modx, $listParent, $listLevel, $description, $titleOfLinks, $maxLevels, $inside, $pre, $post, $selfAsLink, $ie, $activeLinkIDs, $topdiv, $topdivClass, $topnavClass, $subdiv, $subdivClass, $subnavClass, $hereClass, $useCategoryFolders, $categoryClass, $showDescription, $descriptionField, $textOfLinks, $orderBy, $orderDesc, $debugMode) {\r\n\r\n		$children = $modx->getActiveChildren($listParent, $orderBy, (!$orderDesc) ? \'ASC\' : \'DESC\', \'id, pagetitle, description, isfolder, parent, alias, longtitle, menutitle, hidemenu, introtext, content_dispo, contentType, type, template\');\r\n		// filter out the content that is set to be hidden from menu snippets\r\n		$children = array_filter($children, \"filterHidden\");\r\n		$numChildren = count($children);\r\n\r\n		if (is_array($children) && !empty($children)) {\r\n\r\n			// determine if it\'s a top category or not\r\n			$toplevel = !$inside;\r\n\r\n			// build the output\r\n			$topdivcls = (!empty($topdivClass)) ? \' class=\"\'.$topdivClass.\'\"\' : \'\';\r\n			$topdivblk = ($topdiv) ? \"<div$topdivcls>\" : \'\';\r\n			$topnavcls = (!empty($topnavClass)) ? \' class=\"\'.$topnavClass.\'\"\' : \'\';\r\n			$subdivcls = (!empty($subdivClass)) ? \' class=\"\'.$subdivClass.\'\"\' : \'\';\r\n			$subdivblk = ($subdiv) ? \"<div$subdivcls>$ie\" : \'\';\r\n			$subnavcls = (!empty($subnavClass)) ? \' class=\"\'.$subnavClass.\'\"\' : \'\';\r\n			$output = ($toplevel) ? \"$topdivblk<ul$topnavcls>$ie\" : \"$ie$subdivblk<ul$subnavcls>$ie\";\r\n\r\n			//loop through and process subchildren\r\n			foreach ($children as $child) {\r\n				// figure out if it\'s a containing category folder or not \r\n				$numChildren --;\r\n				$isFolder = $child[\'isfolder\'];\r\n			    $itsEmpty = ($isFolder && ($child[\'template\'] == \'0\'));\r\n				$itm = \"\";\r\n\r\n                // if menutitle is blank fall back to pagetitle for menu link\r\n                $textOfLinks = (empty($child[menutitle])) ? \'pagetitle\' : \"$textOfLinks\"; \r\n\r\n			    // If at the top level\r\n				if (!$inside) \r\n				{\r\n					$itm .= ((!$selfAsLink && ($child[\'id\'] == $modx->documentIdentifier)) || ($itsEmpty && $useCategoryFolders)) ? \r\n					        $pre.$child[$textOfLinks].$post . (($debugMode) ? \' self|cat\' : \'\') : \r\n					        \'<a href=\"[~\'.$child[\'id\'].\'~]\" title=\"\'.$child[$titleOfLinks].\'\">\'.$pre.$child[$textOfLinks].$post.\'</a>\';\r\n					$itm .= ($debugMode) ? \' top\' : \'\';\r\n				}\r\n				\r\n				// it\'s a folder and it\'s below the top level\r\n				elseif ($isFolder && $inside) \r\n				{\r\n				    \r\n					$itm .= ($itsEmpty && $useCategoryFolders) ?\r\n					        $pre.$child[$textOfLinks].$post . (($debugMode) ? \'subfolder T\': \'\') :\r\n					        \'<a href=\"[~\'.$child[\'id\'].\'~]\" title=\"\'.$child[$titleOfLinks].\'\">\'.$pre.$child[$textOfLinks].$post.\'</a>\'. (($debugMode) ? \' subfolder F\' :\'\');        					\r\n				}\r\n				\r\n				// it\'s a document inside a folder\r\n				else \r\n				{\r\n					$itm .= ($child[\'alias\'] > \'0\' && !$selfAsLink && ($child[\'id\'] == $modx->documentIdentifier)) ? $child[$textOfLinks] : \'<a href=\"[~\'.$child[\'id\'].\'~]\" title=\"\'.$child[$titleOfLinks].\'\">\'.$child[$textOfLinks].\'</a>\';\r\n					$itm .= ($debugMode) ? \' doc\' : \'\';\r\n				}\r\n				$itm .= ($debugMode)? \"$useCategoryFolders $isFolder $itsEmpty\" : \'\';\r\n   					\r\n				// loop back through if the doc is a folder and has not reached the max levels\r\n				if ($isFolder && (($maxLevels == 0) || ($maxLevels > $listLevel +1))) {\r\n					$itm .= MakeMap($modx, $child[\'id\'], $listLevel +1, $description, $titleOfLinks, $maxLevels, true, $pre, $post, $selfAsLink, $ie, $activeLinkIDs, $topdiv, $topdivClass, $topnavClass, $subdiv, $subdivClass, $subnavClass, $hereClass, $useCategoryFolders, $categoryClass, $showDescription, $descriptionField, $textOfLinks, $orderBy, $orderDesc, $debugMode);\r\n				}\r\n\r\n				if ($itm && !$selfAsLink && ($child[\'id\'] == $modx->documentIdentifier)) {\r\n					$output .= \"    <li class=\\\"$hereClass\". ($numChildren == 0 ? \' last\' : \'\').\"\\\">$itm</li>$ie\";\r\n				}\r\n				elseif ($itm) {\r\n					if ($numChildren == 0) {\r\n						$class = \'last\';\r\n					}\r\n					if (is_array($activeLinkIDs)) {\r\n						if (in_array($child[\'id\'], $activeLinkIDs)) {\r\n							$class .= ($class ? \' \' : \'\').$hereClass;\r\n						}\r\n					}\r\n					// it\'s an empty folder and using Category Folders\r\n					if ($useCategoryFolders && $itsEmpty) {\r\n						$class .= ($class ? \' \' : \'\').$categoryClass;\r\n					}\r\n					if ($class) {\r\n						$class = \' class=\"\'.$class.\'\"\';\r\n					}\r\n					\r\n					// TO DO: set description to the first non-empty of an array of options\r\n					if ($showDescription && (!empty($child[\'$descriptionField\']))) {\r\n					    $desc = \" &ndash; \".$child[\'$descriptionField\'];\r\n					} elseif ($showDescription && (!empty($child[\'description\']))) {\r\n					    $desc = \' &ndash; \' . $child[\'description\'];\r\n					} elseif ($showDescription && (!empty($child[\'introtext\']))) {\r\n					    $desc = \' &ndash; \' . $child[\'introtext\'];\r\n					} elseif ($showDescription && (!empty($child[\'longtitle\']))) {\r\n					    $desc = \' &ndash; \' . $child[\'longtitle\'];\r\n					} else {\r\n					    $desc = \'\';\r\n					}\r\n					\r\n					$output .= \"<li$class>$itm$desc</li>$ie\";\r\n					$class = \'\';\r\n				}\r\n			}\r\n			$output .= \"</ul>$ie\";\r\n			$output .= ($toplevel) ? (($topdiv) ? \"</div>$ie\" : \"\") : (($subdiv) ? \"</div>$ie\" : \"\");\r\n		}\r\n		return $output;\r\n	}\r\n	$MakeMap_Defined = true;\r\n}\r\n\r\n$currentID = $modx->documentIdentifier;\r\n$parentID = $currentID;\r\n\r\n// find the parent docs of the current \"you-are-here\" doc\r\n// used in the logic to mark parents as such also\r\nwhile ($parentID != $siteMapRoot && $parentID != 0) {\r\n	$parent = $modx->getParent($parentID, 0);\r\n	if ($parent) {\r\n		$parentID = $parent[\'id\'];\r\n		$activeLinkIDs[] = $parentID;\r\n	} else {\r\n		$parentID = 0;\r\n	}\r\n}\r\n\r\nif ($phMode) {\r\n    // output to a [+placeholder+]\r\n    $modx->setPlaceholder($phName, MakeMap($modx, $siteMapRoot, 0, $showDescription, $titleOfLinks, $maxLevels, false, $pre, $post, $selfAsLink, $ie, $activeLinkIDs, $topdiv, $topdivClass, $topnavClass, $subdiv, $subdivClass, $subnavClass, $hereClass, $useCategoryFolders, $categoryClass, $showDescription, $descriptionField, $textOfLinks, $orderBy, $orderDesc, $debugMode));\r\n\r\n} else {\r\n    // return the output a \"usual\"\r\n    return MakeMap($modx, $siteMapRoot, 0, $showDescription, $titleOfLinks, $maxLevels, false, $pre, $post, $selfAsLink, $ie, $activeLinkIDs, $topdiv, $topdivClass, $topnavClass, $subdiv, $subdivClass, $subnavClass, $hereClass, $useCategoryFolders, $categoryClass, $showDescription, $descriptionField, $textOfLinks, $orderBy, $orderDesc, $debugMode);\r\n\r\n}','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('20','ListRelated','List related pages based on keywords','0','0','0','// --------------------\r\n// Snippet: ListRelated\r\n// --------------------\r\n// Version: 1.0 beta 1\r\n// Date: September 6, 2005\r\n// ryan@vertexworks.com\r\n//\r\n// This snippet was designed to show a list of pages that are\r\n// related based on specified keywords, or those used in the\r\n// current page\r\n//\r\n// Based on ListRelated by Jaredc and updated for MODx.\r\n// jaredc@honeydewdesign.com\r\n//\r\n// Needs to be updated to support Webuser Logins Menu Items\r\n// and also possibly \"in menu\" items.\r\n//\r\n\r\n// Configuration Settings\r\n\r\n   // LR_keywords [ string ]\r\n   // This is a comma separated list of keywords that can be set\r\n   // from the snippet parameter ONLY. Ex:\r\n   // [[ListRelated?LR_keywords=fun,functional,good stuff]]\r\n   // If no snippet variable is set, related pages will be found\r\n   // based on the host page\'s keywords.\r\n\r\n   // $maxRelated [ int ]\r\n   // The maximum number of related pages you want to have. Can also\r\n   // be set/overridden as the snippet variable \"LR_max\" as in:\r\n   // [[ListRelated?LR_max=5]]\r\n   $maxRelated = 10;\r\n\r\n   // $relatedListTitle [ string ]\r\n   // Give your related list of links a title if you desire- otherwise\r\n   // set as an empty string \'\'. Can also be declared in snippet call\r\n   // with \"LR_title\" like:\r\n   // [[ListRelated?LR_title=Other links you might like]]\r\n   $relatedListTitle = \'Related links:\';\r\n\r\n   // $linkToSearch [ true | false ]\r\n   // If you would like to have a link at the end of your list for more\r\n   // links based on search results of the current keywords.\r\n   // FUTURE FEATURE - NOT CURRENTLY USED\r\n   $linkToSearch = false;\r\n\r\n   // $removeNewlines [ true | false ]\r\n   // As always, with lists, it\'s best NOT to have new lines and whitespace\r\n   // with IE. For debugging and reading source code, set to false, for live\r\n   // implementation and styling, try setting to true.\r\n   $removeNewlines = true;\r\n   \r\n   // $sortBy [ \'date\' | \'pagetitle\' ]\r\n   // Field you would like to sort by. Options include:\r\n   // date       - dates will be sorted by pub_date if it exists, else createdon\r\n   // pagetitle  - page title\r\n   // Can also be set in snippet call with $LR_sortBy (see example under $sortDir)\r\n   $sortBy = \'date\';\r\n   \r\n   // $sortDir [ \'ASC\' | \'DESC\' ]\r\n   // Choose to sort in ascending (ASC) or descending (DESC) order. Can be set\r\n   // in snippet call with $LR_sortDir:\r\n   // [[ListRelated?LR_sortBy=date&LR_sortDir=DESC]]\r\n   $sortDir = \'DESC\';\r\n\r\n   // $nonefound [ \'string\' ]\r\n   // What to return when no related  records are found.\r\n   $nonefound = \'<p>No related pages or links.</p>\';\r\n\r\n// Styles\r\n\r\n   // .LR_listTitle     class for list title\r\n   // .LR_linksList     class for ul element\r\n\r\n// ***********************************\r\n// END CONFIG SETTINGS\r\n// THE REST SHOULD TAKE CARE OF ITSELF\r\n// ***********************************\r\n\r\n// assign IE variable\r\n$newline = ($removeNewlines)? \'\':\"\\n\";\r\n\r\n// assign appropriate default or passed variables\r\n$maxRelated = (isset($LR_max))? $LR_max : $maxRelated;\r\n$relatedListTitle = (isset($LR_title))? $LR_title : $relatedListTitle ;\r\n$sortBy = (isset($LR_sortBy))? $LR_sortBy: $sortBy ;\r\n$sortDir = (isset($LR_sortDir))? $LR_sortDir :$sortDir ;\r\n\r\n// Make array of keywords from snippet or from current page. Snippet\r\n// variables have priority.\r\n\r\nif (isset($LR_keywords)){\r\n  $kArray= explode(\",\",$LR_keywords);\r\n} else {\r\n  $kArray = $modx->getKeywords();\r\n}\r\n\r\n// if there are keywords, make the list\r\n$relatedOutput = \'\';\r\nif ($kArray) {\r\n  $keyString = \'\';\r\n  foreach ($kArray as $key){\r\n    $keyString .= \"\'\".$key.\"\',\";\r\n  } \r\n  $keyString = substr($keyString,0,strlen($keyString)-1);\r\n\r\n  // make sql statement for retreiving similar pages\r\n  $pre= $modx->dbConfig[\'dbase\'].\".\".$modx->dbConfig[\'table_prefix\'];\r\n\r\n  $relatedSql = \"\r\n    SELECT DISTINCT content.id, content.pagetitle, \r\n      IF(content.pub_date > 0, content.pub_date, content.createdon) AS date\r\n    FROM \r\n    \".$pre.\"site_content AS content,\r\n    \".$pre.\"keyword_xref AS xref,\r\n    \".$pre.\"site_keywords AS keywords\r\n    WHERE keywords.keyword IN (\".$keyString.\")\r\n    AND xref.keyword_id = keywords.id\r\n    AND content.id = xref.content_id\r\n    AND content.id != \".$modx->documentObject[\'id\'].\"\r\n    ORDER BY \". $sortBy . \' \' . $sortDir .\"\r\n    LIMIT \".$maxRelated.\";\";\r\n\r\n  $relatives = $modx->dbQuery($relatedSql);\r\n  $relativeCount = $modx->recordCount($relatives);\r\n  $relArray = array();\r\n  for($i=0;$i<$relativeCount;$i++)  {\r\n    array_push($relArray,$modx->fetchRow($relatives));\r\n  }\r\n\r\n  // start output if we have results\r\n  if ($relativeCount) {\r\n    $relatedOutput .= ($relatedListTitle )?\'<span class=\"LR_listTitle\">\' . $relatedListTitle . \'</span>\' : \'\' ;\r\n    $relatedOutput .= \'<ul class=\"LR_linksList\">\'.$newline;\r\n    for ($li=0;$li<$relativeCount;$li++){\r\n      $relatedOutput .= \'<li><a href=\"[~\' . $relArray[$li][\'id\'] . \'~]\">\' . $relArray[$li][\'pagetitle\'] . \'</a></li>\'.$newline;\r\n    }\r\n    $relatedOutput .= \'</ul>\'.$newline;\r\n  } \r\n}\r\nif (empty($relatedOutput)) {\r\n  // there are no related records for this page\r\n  $relatedOutput .= $nonefound.$newline;\r\n}\r\n\r\nreturn $relatedOutput;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('21','ListIndexer','Shows the most recent documents, highly flexible','0','0','0','// --------------------\r\n// Snippet: ListIndexer\r\n// --------------------\r\n// Version: 1.0\r\n// Date: 10 Oct 2005\r\n//\r\n// Derived from ListIndex 0.6j by jaredc@honeydewdesign.com\r\n// Now supports Show In Menu\r\n//\r\n// This snippet was designed to be a VERY flexible way\r\n// of showing what has been recently added. You can use\r\n// this snippet to show news from one folder, or what has\r\n// been recently added site wide. You can even show what\'s\r\n// new in a \'section\' (everything under a defined folder)!\r\n//\r\n\r\n// Configuration Settings\r\n\r\n   // Set the following snippet defaults the way you would normally\r\n   // use this snippet, then use snippet variables in other situations\r\n   // to override the default behaviors.\r\n\r\n   // GENERAL OPTIONS\r\n\r\n   // $rootFolder [ NULL | string (comma separated page id\'s) ]\r\n   // Decide which folder to pull recent documents from.\r\n   // If you want to specify a few folders, comma separate them.\r\n   // The default NULL will set current page as root. Using 0\r\n   // would search site wide. Can be set with snippet parameter\r\n   // $LIn_root like:\r\n   // [[ListIndexer?LIn_root=3,6,88]] \r\n   $rootFolder = NULL;\r\n\r\n   // $descendentDepth [ int ]\r\n   // How many levels below the root folder(s) do you want to\r\n   // include? Can be overridden in snippet call with LIn_depth:\r\n   // [[ListIndexer?LIn_depth=2]]\r\n   // Uncomment one of these common two or create your own:\r\n   // $descendentDepth = 1; // just children of root folder(s)\r\n   $descendentDepth = 0; // all decendents of root folder(s)\r\n\r\n   // $seeThruUnpub [ true | false ]\r\n   // When using descendents, do you want to consider files below\r\n   // an unpublished (hidden) folder? Usually no. But you decide.\r\n   // Snippet parameter: LIn_seeThru\r\n   // [[ListIndexer?LIn_seeThru=1]]\r\n   $seeThruUnpub = false;\r\n\r\n   // $seeShowInMenu [ true | false ]\r\n   // When using descendents, do you want to consider files flagged\r\n   // to be hidden from the menus? Usually no. But you decide.\r\n   // Snippet parameter: LIn_seeShowInMenu\r\n   // [[ListIndexer?LIn_seeShowInMenu=1]]\r\n   $seeShowInMenu = false;\r\n\r\n   // $mode [ \'short\' | \'full\' ]\r\n   // Defines whether this list should be a full, paged\r\n   // list of all documents, or a short list of the most\r\n   // recent few (how many will be defined next). Can be\r\n   // overridden in snippet call with $LIn_mode:\r\n   // [[ListIndexer?LIn_mode=full]]\r\n   $mode = \'short\';\r\n   \r\n   // $sortBy [ \'alpha\' | \'date\' | \'menuindex\' ]\r\n   // The default date will sort by most recent items first, but\r\n   // by using the \'alpha\' option, and using full mode, you could\r\n   // use this to create an index, or directory.\r\n   // Settable with snippet call $LIn_sort:\r\n   // [[ListIndexer?LIn_sort=alpha]]\r\n   $sortBy = \'date\';\r\n   \r\n   // $sortDir [ \'ASC\' | \'DESC\' ]\r\n   // Sort direction ascending or descending. Is applied to whatever $sortBy\r\n   // field you have chosen above. If left blank, menuindex and alpha will sort\r\n   // ASC and date DESC.\r\n   // $LIn_dir in snippet call:\r\n   // [[ListIndexer?LIn_dir=ASC&LIn_sortBy=menuindex]]\r\n   $sortDir = \'\';\r\n\r\n   // WHAT TO DISPLAY\r\n\r\n   // $defaultTitle [ string ]\r\n   // If you want a default title for your list\r\n   // you can declare it here. Or use an empty\r\n   // string to leave this off. This can be overridden\r\n   // in the snippet call with the variable $LIn_title:\r\n   // [[ListIndexer?LIn_title=Some new title]]\r\n   $defaultTitle = \'\';\r\n\r\n   // $shortDesc [ true | false ]\r\n   // Show the description on the short list, or not. Snippet\r\n   // parameter $LIn_sDesc:\r\n   // [[ListIndexer?LIn_sDesc=0]]\r\n   $shortDesc = true;\r\n\r\n   // $fullDesc [ true | false ]\r\n   // Show the description on the full list, or not. Snippet\r\n   // parameter $LIn_fDesc:\r\n   // [[ListIndexer?LIn_fDesc=0]]\r\n   $fullDesc = true;\r\n\r\n   // $linkToIndex [ int ]\r\n   // If you have a page set up as an \'index\' for all the \r\n   // documents in this list, you can link to it by specifying \r\n   // its id- can also be set in snippet call with LIn_link:\r\n   // [[ListIndexer?LIn_link=8]]\r\n   // The default 0 will eliminate this link\r\n   $linkToIndex = 0;\r\n\r\n   // $indexText [ string ]\r\n   // If you want a link to an index (probably a page running this\r\n   // snippet in \"full\" mode), you can declare what you want that\r\n   // link to say here. Or in the snippet call with LIn_indexText:\r\n   // [[ListIndexer?LIn_indexText=Financial News Index]]\r\n   $indexText = \'Index\';\r\n\r\n   // $showCreationDate [ true | false ]\r\n   // Decide to include date of creation in output or not. From\r\n   // snippet call $LIn_showDate use 1 (true) or 0 (false)\r\n   // [[ListIndexer?LIn_showDate=1]]\r\n   $showCreationDate = true;\r\n\r\n   // $dateFormat [ string ]\r\n   // Used to define how date will be displayed (if using date)\r\n   // Y = 4 digit year     y = 2 digit year\r\n   // M = Jan - Dec        m = 01 - 12\r\n   // D = Sun - Sat        d = 01 -31\r\n   // Other standard PHP characters may be used\r\n   $dateFormat = \'Y.m.d\';\r\n\r\n   // $shortQty [ int ]\r\n   // Number of entries to list in the short list. Can be\r\n   // overridden in snippet call with $LIn_sQty:\r\n   //[[ListIndexer?LIn_sQty=3]]\r\n   $shortQty = 3;\r\n\r\n   // PAGING\r\n\r\n   // $fullQty [ int ]\r\n   // Number of entries PER PAGE to list in the full list\r\n   // Can be overridden in snippet call with $LIn_fQty:\r\n   // [[ListIndexer?LIn_fQty=20]]\r\n   // To show all set to 0 here or in snippet call\r\n   $fullQty = 10;\r\n   \r\n   // $pageSeparator [ string ]\r\n   // What you want your page number links to be separated by.\r\n   // You NEED to include spaces if you want them. They are NOT\r\n   // created automatically to facilitate styling ability.\r\n   // For instance, \" | \" will render links like:\r\n   // 1 | 2 | 3 | 4\r\n   $pageSeparator = \" | \";\r\n   \r\n   // $pgPosition [ \'top\' | \'bottom\' | \'both\']\r\n   // Pick where you want your pagination links to appear.\r\n   $pgPosition = \'both\';\r\n\r\n   // PERFORMANCE\r\n\r\n   // $useFastUrls [ true | false ]\r\n   // IMPORTANT- using fast urls will reduce database queries\r\n   // and improve performance WHEN IN FULL MODE ONLY and \r\n   // should NOT be used when multiple instances of this snippet\r\n   // appear on the same page. With snippet call LIn_fast use 1\r\n   // (true) or 0 (false)\r\n   // [[ListIndexer?LIn_fast=0]]\r\n   $useFastUrls = false;\r\n\r\n   // $newLinesForLists [ true | false ]\r\n   // Depending on how you want to style your list, you may\r\n   // or may not want your <li>s on new lines. Generally, if you\r\n   // are displaying then inline (horizontal, you do not want new\r\n   // lines, but standard vertical block styling you do. This is\r\n   // for IE, real browsers don\'t care.\r\n   $newLinesForLists = true;\r\n\r\n// Styles\r\n//\r\n// The following are the styles included in this snippet. It is up\r\n// to you to include these styles in your stylesheet to get them to\r\n// look the way you want.\r\n\r\n   // div.LIn_title {}          List title div\r\n   // ul.LIn_fullMode {}        UL class\r\n   // ul.LIn_shortMode {}       UL class\r\n   // span.LIn_date {}          Span surrounding pub/created date\r\n   // span.LIn_desc {}          Span surrounding description\r\n   // div.LIn_pagination        Div surrounding pagination links\r\n   // span.LIn_currentPage {}   Span surrounding current page of\r\n   //                           pagination (which wouldn\'t be css-able\r\n   //                           by virtue of its <a> tag)\r\n\r\n\r\n// **********************************************************************\r\n// END CONFIG SETTINGS\r\n// THE REST SHOULD TAKE CARE OF ITSELF\r\n// **********************************************************************\r\n\r\n// Take care of IE list issue\r\n$ie = ($newLinesForLists)? \"\\n\" : \'\' ;\r\n\r\n// Use snippet call defined variables if set\r\n$activeTitle = (isset($LIn_title))? $LIn_title : $defaultTitle ;\r\n$mode = (isset($LIn_mode))? $LIn_mode : $mode ;\r\n$descendentDepth = (isset($LIn_depth))? $LIn_depth : $descendentDepth ;\r\n$seeThruUnpub = (isset($LIn_seeThru))? $LIn_seeThru : $seeThruUnpub ;\r\n$seeShowInMenu = (isset($LIn_seeShowInMenu))? $LIn_seeShowInMenu : $seeShowInMenu ;\r\n$linkToIndex = (isset($LIn_link))? $LIn_link : $linkToIndex ;\r\n$rootFolder = (isset($LIn_root))? $LIn_root : $rootFolder ;\r\n$shortQty = (isset($LIn_sQty))? $LIn_sQty : $shortQty ;\r\n$fullQty = (isset($LIn_fQty))? $LIn_fQty : $fullQty ;\r\n$showCreationDate = (isset($LIn_showDate))? $LIn_showDate : $showCreationDate ;\r\n$indexText = (isset($LIn_indexText))? $LIn_indexText : $indexText ;\r\n$useFastUrls = (isset($LIn_fast))? $LIn_fast : $useFastUrls ;\r\n$sortBy = (isset($LIn_sort))? $LIn_sort : $sortBy;\r\n$shortDesc = (isset($LIn_sDesc))? $LIn_sDesc : $shortDesc ;\r\n$fullDesc = (isset($LIn_fDesc))? $LIn_fDesc : $fullDesc ;\r\n$sortDir = (isset($LIn_dir))? $LIn_dir : $sortDir ;\r\nif ($sortDir == \'\') $sortDir = ($sortBy == \'date\')? \'DESC\' : \'ASC\' ;\r\n\r\n\r\n// Make useful variable shortcut for the content table\r\n$tbl = $modx->dbConfig[\'dbase\'] . \".\" . $modx->dbConfig[\'table_prefix\'] . \"site_content\";\r\n\r\n// Initialize output\r\n$output = \'\';\r\n\r\n// ---------------------------------------------------\r\n// ---------------------------------------------------\r\n// Query db for parent folders, or not. First check to\r\n// see if a querystring cheat has been provided- this\r\n// should speed things up considerably when using this\r\n// in full mode. (a.k.a. fastUrls)\r\n// ---------------------------------------------------\r\n// ---------------------------------------------------\r\nif ((!$_GET[\'LIn_f\'] && $useFastUrls) || !$useFastUrls ){\r\n  // Only run all the database queries if we don\'t already\r\n  // know the folders AND fastUrls are desired.\r\n\r\n  // ---------------------------------------------------\r\n  // Seed list of viable parents\r\n  // ---------------------------------------------------\r\n\r\n  if ($rootFolder == NULL){\r\n    $rootFolder = $modx->documentIdentifier;\r\n  }\r\n  // Set root level parent array\r\n  $seedArray = explode(\',\',$rootFolder);\r\n  $parentsArray = array();\r\n  foreach($seedArray AS $seed){\r\n    $parentsArray[\'level_0\'][] = $seed;\r\n  }\r\n\r\n  // ---------------------------------------------------\r\n  // Make array of all allowed parents\r\n  // ---------------------------------------------------\r\n\r\n  // Process valid parents\r\n  $levelCounter = 1;\r\n\r\n  while (((count($parentsArray) < $descendentDepth) || ($descendentDepth == 0)) && ($levelCounter <= count($parentsArray)) && ($levelCounter < 10)){\r\n\r\n    // Find all decendant parents for this level\r\n    $pLevel = \'level_\'.($levelCounter - 1);\r\n    $tempLevelArray = $parentsArray[$pLevel];\r\n\r\n    foreach($tempLevelArray AS $p){\r\n\r\n      // Get children who are parents (isfolder = 1)\r\n      $validParentSql = \"\";\r\n      $validParentSql .= \"SELECT id FROM $tbl WHERE \";\r\n      $validParentSql .= \"isfolder = 1 AND parent = $p \";\r\n      $validParentSql .= \"AND $tbl.deleted=0 \";\r\n      $validParentSql .= ($seeThruUnpub)? \";\" : \"AND $tbl.published = 1;\";\r\n\r\n      // Run statement\r\n      $rsTempParents = $modx->dbQuery($validParentSql);\r\n      // Get number of results\r\n      $countTempParents = $modx->recordCount($rsTempParents);\r\n\r\n      // If there are results, put them in an array\r\n      $tempValidArray = false;\r\n      if ($countTempParents){\r\n        for ($i=0;$i<$countTempParents;$i++){\r\n          $tempId = $modx->fetchRow($rsTempParents);\r\n          $tempValidArray[] = $tempId[\'id\'];\r\n        } // end while\r\n      } // end if\r\n\r\n	  // populate next level of array \r\n	  if ($tempValidArray){\r\n	    foreach($tempValidArray AS $kid){\r\n	      $kidLevel = \'level_\'.$levelCounter;\r\n	      $parentsArray[$kidLevel][] = $kid;\r\n	    } // end foreach\r\n\r\n	  } // end if\r\n    } // end foreach\r\n\r\n    // Do next level\r\n    $levelCounter++;\r\n\r\n  } // end while\r\n\r\n  // Finalize list of parents\r\n  $validParents = \'\';\r\n  foreach ($parentsArray AS $level){\r\n    foreach ($level AS $validP){\r\n      $validParents .= $validP . \',\';\r\n    }\r\n  }\r\n\r\n  // Remove trailing comma\r\n  $validParents = substr($validParents,0,strlen($validParents)-1);\r\n\r\n} else {\r\n  $validParents = $_GET[\'LIn_f\'];\r\n}\r\n\r\n// ---------------------------------------------------\r\n// Make appropriate SQL statement to pull recent items\r\n// ---------------------------------------------------\r\n\r\n// Initialize\r\n$recentSql = \"\";\r\n$recentSql .= \"SELECT id, pagetitle, description\";\r\n// Include pub_date or createdon date if date is desired\r\n$recentSql .= ($showCreationDate)? \", IF(pub_date > 0, pub_date, createdon) AS pubDate \": \" \" ;\r\n$recentSql .= \"FROM $tbl \";\r\n$recentSql .= \"WHERE \";\r\n// Look everywhere, or just under valid parents\r\n$recentSql .= (($rootFolder == 0) && $seeThruUnpub && ($descendentDepth == 0))? \"\" : \"parent IN ($validParents) AND \" ;\r\n// Published\r\n$recentSql .= \"$tbl.published = 1 \";\r\n// Show In Menu\r\n$recentSql .= ($seeShowInMenu)? \" \" : \" AND $tbl.hidemenu=0 \" ;\r\n// Not deleted\r\n$recentSql .= \"AND $tbl.deleted=0 \";\r\n// Choose sort method\r\nswitch ($sortBy){\r\n  case \'alpha\':\r\n    $recentSql .= \"ORDER BY pagetitle \";\r\n    break;\r\n  case \'menuindex\':\r\n    $recentSql .= \"ORDER BY menuindex \";\r\n    break;\r\n  default:\r\n    $recentSql .= \"ORDER BY IF(pub_date>0, pub_date, createdon) \";\r\n    break;\r\n}\r\n// Provide a sort direction\r\n$recentSql .= $sortDir;\r\n\r\n// If this is a short list, just pull a limited number\r\n$recentSql .= ($mode == \'short\')? \" LIMIT $shortQty;\" : \";\" ;\r\n\r\n// Run statement\r\n$rsRecent = $modx->dbQuery($recentSql);\r\n// Count records\r\n$recentLimit = $modx->recordCount($rsRecent);\r\n\r\n// ---------------------------------------------------\r\n// Generate pagination string if needed\r\n// ---------------------------------------------------\r\n$offset = ($_GET[\'LIn_o\'] && ($mode == \'full\'))? $_GET[\'LIn_o\'] : 0 ;\r\n$pagination = \'\';\r\n\r\n// Don\'t bother unless there are enough records to justify it\r\nif ( ($mode == \'full\') && ($recentLimit > $fullQty) && ($fullQty) ){\r\n  $fullUrl = $_SERVER[\'REQUEST_URI\'];\r\n  $urlPieces = parse_url($fullUrl);\r\n  $urlPath = $urlPieces[\'path\'];\r\n  $otherQs = \'\';\r\n\r\n  if ($urlPieces[\'query\']){\r\n    foreach($_GET AS $qsKey=>$qsValue){\r\n	  if (($qsKey != \'LIn_o\') && ($qsKey != \'LIn_f\')){\r\n	    $otherQs .= \'&\'.$qsKey.\'=\'.$qsValue;\r\n	  }\r\n	}\r\n  } \r\n  \r\n  $fastUrl = $urlPath.\'?LIn_f=\'.$validParents.$otherQs;\r\n\r\n  // Determine number of pages needed to show results\r\n  $totalPages = ceil($recentLimit/$fullQty);\r\n  \r\n  // Make links\r\n  for ($j = 0 ; $j < $totalPages; $j++){\r\n    // only include links to OTHER pages, not current page\r\n    if($offset == $j*$fullQty){\r\n	  $pagination .= \'<span class=\"LIn_currentPage\">\'.($j+1) .\'</span>\';\r\n	} else {\r\n      $pagination .= \'<a href=\"\'.$fastUrl.\'&LIn_o=\'.($j*$fullQty).\'\" title=\"\'.($j+1).\'\">\'.($j+1) .\'</a>\';\r\n	}\r\n	if ($j < $totalPages-1){\r\n	  $pagination .= $pageSeparator;\r\n	}\r\n  }\r\n  \r\n  // Make final pagination link set in it\'s own div\r\n  $pagination = \'<div class=\"LIn_pagination\">\'.\"\\n\".$pagination.\"\\n</div>\\n\";\r\n  \r\n}\r\n\r\n\r\n// ---------------------------------------------------\r\n// Create title if wanted\r\n// ---------------------------------------------------\r\n\r\nif ($activeTitle){\r\n  $output .= \'<div class=\"LIn_title\">\'.$activeTitle.\'</div>\'.\"\\n\";\r\n}\r\n\r\n// ---------------------------------------------------\r\n// Create list of recent items\r\n// ---------------------------------------------------\r\n\r\n// Include pagination\r\n$output .= ($pgPosition == \'top\' || $pgPosition == \'both\')? $pagination : \'\' ;\r\n\r\n$output .= \'<ul class=\"LIn_\'.$mode.\'Mode\">\' . $ie;\r\n\r\n$recentCounter = $offset;\r\nif ($mode == \'short\') {\r\n  $recentCounterLimit = min($shortQty,$recentLimit);\r\n} else {\r\n  $recentCounterLimit = ($fullQty)? min(($fullQty+$offset),$recentLimit) : $recentLimit ;\r\n}\r\n\r\nwhile (($recentCounter < $recentCounterLimit) && rsRecent && ($recentLimit > 0)){\r\n  mysql_data_seek($rsRecent,$recentCounter);\r\n  $recentRecord = $modx->fetchRow($rsRecent);\r\n  $output .= \'<li>\';\r\n  // Link to page\r\n  $output .= \'<a href=\"[~\'.$recentRecord[\'id\'].\'~]\" title=\"\'.strip_tags($recentRecord[\'pagetitle\']).\'\">\'.$recentRecord[\'pagetitle\'].\'</a> \';\r\n  // Date if desired\r\n  if ($showCreationDate){\r\n    $output .= \'<span class=\"LIn_date\">\'.date($dateFormat,$recentRecord[\'pubDate\']).\'</span> \';\r\n  }\r\n  // Description if desired\r\n  if ((($mode == \'short\') && ($shortDesc)) || (($mode == \'full\') && ($fullDesc))){\r\n   $output .= \'<span class=\"LIn_desc\">\'.$recentRecord[\'description\'].\'</span>\';\r\n  }\r\n  // wrap it up\r\n  $output .= \'</li>\' . $ie;\r\n  $recentCounter ++;\r\n}\r\n\r\n$output .= \'</ul>\' . $ie;\r\n\r\n$output .= ($pgPosition == \'bottom\' || $pgPosition == \'both\')? $pagination : \'\' ;\r\n\r\n// ---------------------------------------------------\r\n// Link to index\r\n// ---------------------------------------------------\r\n\r\nif ($linkToIndex) {\r\n\r\n  $output .= \'<div class=\"LIn_index\">\';\r\n  $output .= \'<a href=\"[~\'.$linkToIndex.\'~]\" title=\"\'.$indexText.\'\">\'.$indexText.\'</a>\';\r\n  $output .= \'</div>\';\r\n\r\n}\r\n\r\n// ---------------------------------------------------\r\n// Send to browser\r\n// ---------------------------------------------------\r\n\r\nreturn $output;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('22','ContactForm','Configurable Contact Form','0','0','0','// Email / Contact Form\r\n// Simple XHTML validating email form, that sends different subjects and messages. \r\n// people in a company.\r\n//\r\n// Version 1.0\r\n// September 9, 2005\r\n// ryan@vertexworks.com\r\n//\r\n\r\n// DO NOT ALTER THE FOLLOWING TWO LINES\r\n$subject_array = array();\r\n$recipient_array = array();\r\n\r\n///////////////////////////////////\r\n//  <-----  BEGIN CONFIG  ----->\r\n///////////////////////////////////\r\n// Edit only what\'s between the quotation marks in the lines below.\r\n// These will be the subjects that your users can choose from popup\r\n// lists. You can have as many as you want. Each one must be set up like so:\r\n// $subject_array[] = \"What You Want This Choice To Be\";\r\n// Make sure to remove empty ones that you aren\'t using. Just delete the entire line.\r\n\r\n// Generic email to use for all parts. You can edit\r\n// the individual instances for more control.\r\n// Defaults to the built-in email notification account which is set in the System Configuration.\r\n// Can be set by using as follows:\r\n// [[ContactForm? &sendTo=`ryan@vertexworks.com`]]\r\n$email = (isset($sendTo))? $sendTo : \'[(emailsender)]\';\r\n\r\n\r\n// enter \"static\" in order to use the static subject line\r\n$subject_type = \"static\";\r\n$static_subject = \"[Web Inquiry] \".$modx->config[\'site_url\'];\r\n\r\n// Otherwise use an array of possible subjects\r\n$subject_array[] = \"Survey Info\";\r\n$subject_array[] = \"Company Info\";\r\n$subject_array[] = \"Other Info\";\r\n\r\n// Recipient ... add or remove lines as needed\r\n// Format (as few or as many as desired): \r\n// $recipient_array[\"Your Text Here\"] = \'someone@someplace.com\';\r\n$recipient_array[\"General Inquiries\"] = \"$email\";\r\n$recipient_array[\"Press or Interview Request\"] = \"$email\";\r\n$recipient_array[\"Partnering Opportunities\"] = \"$email\";\r\n\r\n// enter \"static\" in order to use the solo recipient\r\n$recipient_type = \"\";\r\n$static_recipient = \"$email\";\r\n\r\n// Instructions \r\n$instructions = \"Please select the type of message you\'d like to send so we can route it properly. All fields are required.\";\r\n\r\n// Success Message\r\n$success = \"Thanks for contacting [(site_url)]. Someone will get back to you soon. You may submit another message in the form below.\";\r\n\r\n// Class for containing Success Message <p>\r\n$successClass = \"message\";\r\n\r\n// Failure <p> class\r\n$failClass = \"error\";\r\n\r\n// Empy Field failure message\r\n$emptyFields = \"One of the fields was left blank. Please put something in all fields.\";\r\n\r\n// General failure message\r\n$generalFail = \"Sorry, there was an error! Please try again later.\";\r\n\r\n// Bad email failure message\r\n$emailFail = \"The email address you supplied ({$_POST[\'email\']}) does not appear to be valid. Please try again.\";\r\n\r\n// Debug mode for testing\r\n$debug = false;\r\n\r\n//  <-----  END CONFIG  ----->\r\n///////////////////////////////////\r\n\r\nif ($debug && $_POST) {\r\n	$SendMail .= \"POST variables from Document ID [*id*]:\\n\";\r\n	foreach ($_POST as $key => $value) {\r\n		$SendMail .= \"\\t$key => $value\\n\";\r\n	}\r\n} \r\n\r\nif ($_POST[\'send\'] == \'true\') { \r\n    $to = ($recipient_type==\"static\") ? $static_recipient : $_POST[\'to\'];\r\n    $from = $_POST[\'name\'];\r\n    $from_email = $_POST[\'email\'];\r\n    $the_subject = ($subject_type==\"static\") ? \"$static_subject\" : $_POST[\'subject\'];\r\n    $message = $_POST[\'message\'];\r\n    if ( ($from == \'\')||($from_email == \'\')||($message == \'\') ) {\r\n        $SendMail .= \"<p class=\\\"$failClass\\\">$emptyFields</p>\";\r\n    } elseif (eregi(\"^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,3})$\", $from_email)) {\r\n        $subject = $the_subject;\r\n        $headers = \"From: $from <$from_email>\\r\\n\";\r\n        \r\n        // clean out potential tomfoolery...\r\n        $message = $modx->stripTags($message);\r\n        \r\n        $body = \"Name: $from\\nEmail: $from_email\\nMessage:\\n\\n\" . $message;\r\n        if (mail($to, $subject, $body, $headers)) {\r\n            $SendMail .= \"<p class=\\\"$successClass\\\">$success</p>\";\r\n            $SendMail .= ($debug) ? \"<p>$to\\n$headers\\n$subject\\n$body</p>\" : \'\';\r\n            $from=\"\";\r\n            $from_email=\"\";\r\n            $message=\"\";\r\n        } else {\r\n            $SendMail .= \"<p class=\'$failClass\'>$generalFail</p>\";\r\n            $send = \"false\";\r\n        }\r\n    } else {\r\n        $SendMail .= \"<p class=\\\"$failClass\\\">$emailFail</p>\";\r\n        $send = \"false\";\r\n    } \r\n} else {\r\n    $SendMail .= \"<p>$instructions</p>\";\r\n}\r\n\r\n$SendMail .=<<<EOD\r\n<div class=\"emailform\">\r\n\r\n\r\n\r\n    <form method=\"post\" name=\"EmailForm\" id=\"EmailForm\" action=\"[*id*]\" >\r\n        <fieldset>\r\n            <h3>[(sitename)] Contact Form</h3>\r\n            <input type=\"hidden\" name=\"send\" value=\"true\" />\r\n            <label for=\"name\">Your Name: <input type=\"text\" name=\"name\" id=\"name\" size=\"30\" value=\"$from\" /></label>\r\n\r\n            <label for=\"email\">Your Email Address: <input type=\"text\" name=\"email\" id=\"email\" size=\"30\" value=\"$from_email\" /></label>\r\n\r\n            <label for=\"to\">Regarding:</label> \r\n            <select name=\"to\" id=\"to\">\r\nEOD;\r\n\r\n        foreach ($recipient_array as $key=>$value) {\r\n            $SendMail .= \"<option value=\\\"{$value}\\\">{$key}</option>\\n\";\r\n        }\r\n\r\n$SendMail .=<<<EOD\r\n            </select>\r\n\r\n            <label for=\"message\">Message: \r\n            <textarea cols=\"50\" rows=\"10\" name=\"message\" id=\"message\">$message</textarea>\r\n            </label>\r\n            \r\n            <label>&nbsp;</label><input type=\"submit\" value=\"Send this Message\" class=\"button\" />\r\n        </fieldset>\r\n    </form>\r\n</div>\r\nEOD;\r\n\r\nreturn $SendMail;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('24','FlexSearchForm','Splits Search and Results Pages','0','0','0','// -----------------------\r\n// Snippet: FlexSearchForm\r\n// -----------------------\r\n// Version: 0.6j\r\n// Date: 2005.02.01\r\n// jaredc@honeydewdesign.com\r\n//\r\n// This snippet was designed to create a search form\r\n// that is highly flexible in how it is presented. It\r\n// can be used as both a small, subtle, persistent\r\n// search field element, as well as present the search\r\n// results. All elements are branded with classes\r\n// for easy CSS styling.\r\n\r\n// CONFIGURE\r\n\r\n  // MAIN SNIPPET SETUP OPTIONS\r\n  // --------------------------\r\n\r\n   // $searchStyle [ \'relevance\' | \'partial\' ]\r\n   // This option allows you to decide to use a faster,\r\n   // relevance sorted search (\'relevance\') which WILL NOT\r\n   // inlclude partial matches. Or use a slower, but\r\n   // more inclusive search (\'partial\') that will include\r\n   // partial matches. Results will NOT be sorted based on\r\n   // relevance.\r\n   //\r\n   // This option contributed by Rich from Snappy Graffix Media to \r\n   // allow partial matching and LIKE matching of the search term.\r\n   // sam@snappygraffix.com\r\n   $searchStyle = \'relevance\';\r\n   \r\n   // $useAllWords [ true | false ]\r\n   // If you want only documents which contain ALL words in the \r\n   // search string, set to true. Otherwise, the search will return\r\n   // all pages with ONE or more of the search words (which can be \r\n   // a LOT more pages).\r\n   $useAllWords = true;\r\n\r\n   // $showSearchWithResults [1 | 0]\r\n   // If you would like to turn off the search\r\n   // form when showing results you can set\r\n   // this to false. Can also be set in template\r\n   // by using the snippet variable: FSF_showForm\r\n   // like this (1=true, 0=false):\r\n   // [[FlexSearchForm?FSF_showForm=0]]\r\n   $showSearchWithResults = 1;\r\n\r\n   // $resultsPage [int]\r\n   // The default behavior is to show the results on\r\n   // the current page, but you may define the results\r\n   // page any way you like. The priority is:\r\n   //\r\n   // 1- snippet variable - set in page template like this:\r\n   //    [[FlexSearchForm?FSF_landing=int]]\r\n   //    where int is the page id number of the page you want\r\n   //    your results on\r\n   // 2- querystring variable FSF_form\r\n   // 3- variable set here\r\n   // 4- use current page\r\n   //\r\n   // This is VERY handy when you want to put the search form in\r\n   // a discrete and/or small place on your page- like a side\r\n   // column, but don\'t want all your results to show up there!\r\n   // Set to results page or leave 0 as default\r\n   $resultsPage = 0;\r\n\r\n   // $showResults [1 | 0] (as passed in snippet variable ONLY)\r\n   // You can define whether this snippet will show the results\r\n   // of the search with it. Do this by assigning the snippet\r\n   // variable FSF_showResults as:\r\n   // [[FlexSearchForm?FSF_showResults=0]]\r\n   //\r\n   // This is useful in situations where you want to show the\r\n   // search results in a different place than the search form.\r\n   // In that type of situation, you would include two of these\r\n   // snippets on the same page, one showing results, and one\r\n   // showing the form.\r\n   //\r\n   // Default is true.\r\n\r\n   // $grabMax [ int ]   \r\n   // Set to the max number of records you would like on\r\n   // each page. Set to 0 if unlimited.\r\n   $grabMax = 10;\r\n\r\n   // $pageLinkSeparator [ string ]\r\n   // What you want, if anything, between your page link numbers\r\n   $pageLinkSeparator = \" | \";\r\n\r\n   // $stripHTML [ true | false ]\r\n   // Allow HTML characters in the search? Probably not.\r\n   $stripHTML = true;\r\n		\r\n   // $stripSnip [ true | false ]\r\n   // Strip out snippet calls etc from the search string?\r\n   $stripSnip = true;\r\n   \r\n   // $stripSnippets [ true | false ]\r\n   // Strip out snippet names so users will not be able to \"search\"\r\n   // to see what snippets are used in your content. This is a \r\n   // security benefit, as users will not be able to search for what pages\r\n   // use specific snippets.\r\n   $stripSnippets = true;\r\n   \r\n   // $xhtmlStrict [ true | false ]\r\n   // If you want this form to validate as XHTML Strict compliance, then\r\n   // this needs to be true, but IE has a fieldset bug that I don\'t know\r\n   // a workaround for. So you can set this to false to avoid it.\r\n   $xhtmlStrict = false;\r\n\r\n   // $minChars [ int ]\r\n   // Minimum number of characters to require for a word to be valid for\r\n   // searching. MySQL will typically NOT search for words with less than\r\n   // 4 characters (relevance mode). If you have $useAllWords = true and\r\n   // a three or fewer word appears in the search string, the results will\r\n   // always be 0. Setting this drops those words from the search in THAT\r\n   // CIRCUMSTANCE ONLY (relevance mode, useAllWords=true).\r\n   $minChars = 4;\r\n\r\n\r\n  // LANGUAGE AND LABELS\r\n  // --------------------------\r\n\r\n   // $resultsIntroFailure\r\n   // If nothing is found for the search. You should give the user\r\n   // some indication that the search was a failure.\r\n   $resultsIntroFailure = \'There were no search results. Please try using more general terms to get more results.\';\r\n\r\n   // $searchButtonText [string]\r\n   // Label the search button what\r\n   // you wish\r\n   $searchButtonText = \'Go!\';\r\n   \r\n   // $boxText [ string ]\r\n   // What, if anything, you want to have in the search box when the\r\n   // form first loads. When clicked, it will disappear. This uses \r\n   // JavaScript. If you don\'t want this feature or the JavaScript,\r\n   // just set to empty string: \'\'\r\n   $boxText = \'Search here...\';\r\n\r\n   // $introMessage [ string ]\r\n   // This is the text that will show up if the person arrives\r\n   // at the search page without having done a search first.\r\n   // You can leave this as an empty string if you like.\r\n   $introMessage = \'Please enter a search term to begin your search.\';\r\n   \r\n   // $resultsFoundTextSingle, $resultsFoundTextMultiple [ string patttern ]\r\n   // The string that will tell the user how many results were found.\r\n   // two variables will be provided at runtime:\r\n   // %d    The number of results found (integer)\r\n   // %s    The search string itself.\r\n   $resultsFoundTextSingle = \'%d result found for \"%s\".\';\r\n   $resultsFoundTextMultiple = \'%d results found for \"%s\".\';\r\n   \r\n   // $paginationTextSinglePage and $paginationTextMultiplePages [ string ]\r\n   // The text that comes before the links to other pages. In this\r\n   // example, \"Result pages: \" was the $paginationTextMultiplePages:\r\n   // Result pages: 1 | 2 | 3 | 4\r\n   // Page numbers will only appear if there is more than one page.\r\n   $paginationTextSinglePage = \'\';\r\n   $paginationTextMultiplePages = \'Result pages: \';\r\n\r\n// Styles\r\n// These styles are included in this snippet:\r\n//\r\n// .FSF_form{}\r\n// .FSF_input {}\r\n// .FSF_submit {}\r\n//\r\n// .FSF_SearchResults {}\r\n// .FSF_resultsIntroFailure{}\r\n// .FSF_result {}\r\n// .FSF_resultLink {}\r\n// .FSF_resultDescription {}\r\n// .FSF_pagination\r\n// .FSF_intro\r\n\r\n// -------------\r\n// End configure\r\n// -------------\r\n\r\n// establish whether to show the form or not\r\n$showSearchWithResults = (isset($FSF_showForm))? $FSF_showForm : $showSearchWithResults;\r\n\r\n// establish whether to show the results or not\r\n$showResults = (isset($FSF_showResults))? $FSF_showResults : true;\r\n\r\n// establish results page\r\nif (isset($FSF_landing)){ // set in snippet\r\n  $searchAction = \"[~\".$FSF_landing.\"~]\";\r\n} elseif ($resultsPage > 0){ // locally set\r\n  $searchAction = \"[~\".$resultsPage.\"~]\";\r\n}  else { //otherwise\r\n  $searchAction = \"[~\".$modx->documentIdentifier.\"~]\";\r\n}\r\n\r\n// Set newline variable\r\n$newline = \"\\n\";\r\n\r\n// Initialize search string\r\n$searchString = \'\';\r\n\r\n// CLEAN SEARCH STRING\r\nif ( isset($_POST[\'search\']) || isset($_GET[\'FSF_search\']) ){\r\n  // Prefer post to get\r\n  $searchString = (isset($_POST[\'search\']))? $_POST[\'search\'] : urldecode($_GET[\'FSF_search\']) ;\r\n  // block sensitive search patterns\r\n  $searchString =\r\n  (\r\n  $searchString != \"{{\" &&\r\n  $searchString != \"[[\" &&\r\n  $searchString != \"[!\" &&\r\n  $searchString != \"[(\" &&\r\n  $searchString != \"[~\" &&\r\n  $searchString != \"[*\" \r\n  )\r\n  ?\r\n  $searchString : \"\" ;\r\n\r\n  // Remove dangerous tags and such\r\n\r\n  // Strip HTML too\r\n  if ($stripHTML){\r\n    $searchString = strip_tags($searchString);\r\n  }\r\n\r\n  // Regular expressions of things to remove from search string\r\n  $modRegExArray[] = \'~\\[\\[(.*?)\\]\\]~\';   // [[snippets]]\r\n  $modRegExArray[] = \'~\\[!(.*?)!\\]~\';     // [!noCacheSnippets!]\r\n  $modRegExArray[] = \'!\\[\\~(.*?)\\~\\]!is\'; // [~links~]\r\n  $modRegExArray[] = \'~\\[\\((.*?)\\)\\]~\';   // [(settings)]\r\n  $modRegExArray[] = \'~{{(.*?)}}~\';       // {{chunks}}\r\n  $modRegExArray[] = \'~\\[\\*(.*?)\\*\\]~\';   // [*attributes*]\r\n  \r\n  // Remove modx sensitive tags\r\n  if ($stripSnip){\r\n    foreach ($modRegExArray as $mReg){\r\n      $searchString = preg_replace($mReg,\'\',$searchString);\r\n    }\r\n  }\r\n\r\n  // Remove snippet names\r\n  if ($stripSnippets && $searchString != \'\'){\r\n    // get all the snippet names\r\n    $tbl = $modx->dbConfig[\'dbase\'] . \".\" . $modx->dbConfig[\'table_prefix\'] . \"site_snippets\";\r\n    $snippetSql = \"SELECT $tbl.name FROM $tbl;\";\r\n    $snippetRs = $modx->dbQuery($snippetSql);\r\n    $snippetCount = $modx->recordCount($snippetRs);\r\n    $snippetNameArray = array();\r\n    for ($s = 0; $s < $snippetCount; $s++){\r\n      $thisSnippetRow = $modx->fetchRow($snippetRs);\r\n      $snippetNameArray[] = strtolower($thisSnippetRow[\'name\']);\r\n    }\r\n    // Split search into strings\r\n    $searchWords = explode(\' \',$searchString);\r\n    $cleansedWords = \'\';\r\n    foreach($searchWords as $word){\r\n      if ($word != \'\' && \r\n          !in_array(strtolower($word),$snippetNameArray) &&\r\n            ((!$useAllWords) ||\r\n            ($searchStyle == \'partial\') ||\r\n            (strlen($word) >= $minChars && $useAllWords && $searchStyle == \'relevance\'))\r\n         ){\r\n        $cleansedWords .= $word.\' \';\r\n      }\r\n    }\r\n    // Remove last space\r\n    $cleansedWords = substr($cleansedWords,0,(strlen($cleansedWords)-1));\r\n    \r\n    $searchString = $cleansedWords;\r\n  }\r\n\r\n} // End cleansing search string\r\n\r\n// check querystring\r\n$validSearch = ($searchString != \'\')? true : false ;\r\n\r\n//check for offset\r\n$offset = (isset($_GET[\'FSF_offset\']))? $_GET[\'FSF_offset\'] : 0;\r\n\r\n// initialize output\r\n$searchForm = \'\';\r\n\r\n// establish form\r\nif (($validSearch && ($showSearchWithResults)) || $showSearchWithResults){\r\n  $SearchForm .= \'<form class=\"FSF_form\" action=\"\'.$searchAction.\'\" method=\"post\">\';\r\n  $SearchForm .= ($xhtmlStrict)? \'<fieldset><legend>Search</legend>\' : \'\' ;\r\n  // decide what goes in search box\r\n  $searchBoxVal = ($searchString == \'\' && $boxText != \'\')? $boxText : $searchString ;\r\n  $SearchForm .= \'<input class=\"FSF_input\" type=\"text\" name=\"search\" value=\"\'.$searchBoxVal.\'\"  \';\r\n  $SearchForm .= ($boxText)? \'onfocus=\"this.value=(this.value==\\\'\'.$boxText.\'\\\')? \\\'\\\' : this.value ;\" />\' : \'/>\';\r\n  $SearchForm .= \'<input class=\"FSF_submit\" type=\"submit\" name=\"sub\" value=\"\'.$searchButtonText.\'\" />\';\r\n  $SearchForm .= ($xhtmlStrict)? \'</fieldset>\' : \'\';\r\n  $SearchForm .= \'</form>\'.$newline;\r\n}\r\n\r\nif ($showResults) {\r\n  if($validSearch) {\r\n    $search = explode(\" \", $searchString);\r\n    $tbl = $modx->dbConfig[\'dbase\'] . \".\" . $modx->dbConfig[\'table_prefix\'] . \"site_content\";\r\n\r\n    if ($searchStyle == \'partial\'){\r\n      $sql = \"SELECT id, pagetitle, description \";\r\n      $sql .= \"FROM $tbl \";\r\n      $sql .= \"WHERE \";\r\n      if (count($search)>1 && $useAllWords){\r\n        foreach ($search as $searchTerm){\r\n          $sql .= \"(pagetitle LIKE \'%$searchString%\' OR description LIKE \'%$searchString%\' OR content LIKE \'%$searchTerm%\') AND \";\r\n        }\r\n      } else {\r\n        $sql .= \"(pagetitle LIKE \'%$searchString%\' OR description LIKE \'%$searchString%\' OR content LIKE \'%$searchString%\') AND \";\r\n      }\r\n      $sql .= \"$tbl.published = 1 AND $tbl.searchable=1 AND $tbl.deleted=0;\";\r\n    } else {\r\n      $sql = \"SELECT id, pagetitle, description \";\r\n      $sql .= \"FROM $tbl WHERE \";\r\n      if (count($search)>1 && $useAllWords){\r\n        foreach ($search as $searchTerm){\r\n          $sql .= \"MATCH (pagetitle, description, content) AGAINST (\'$searchTerm\') AND \";\r\n        }\r\n      } else {\r\n        $sql .= \"MATCH (pagetitle, description, content) AGAINST (\'$searchString\') AND \";\r\n      }\r\n      $sql .= \"$tbl.published = 1 AND $tbl.searchable=1 AND $tbl.deleted=0;\";\r\n    }\r\n\r\n    $rs = $modx->dbQuery($sql);\r\n    $limit = $modx->recordCount($rs);\r\n\r\n    if($limit>0) {\r\n      $SearchForm .= \'<div class=\"FSF_searchResults\">\'.$newline;\r\n\r\n      // pagination\r\n      if ($grabMax > 0){\r\n        $numResultPages = ceil($limit/$grabMax);\r\n        $resultPageLinks = \'<span class=\"FSF_pages\">\';\r\n        $resultPageLinks .= ($limit>$grabMax)? $paginationTextMultiplePages : $paginationTextSinglePage ;\r\n        $resultPageLinkNumber = 1;\r\n        for ($nrp=0;$nrp<$limit && $limit > $grabMax;$nrp+=$grabMax){\r\n          if($offset == ($resultPageLinkNumber-1)*$grabMax){\r\n            $resultPageLinks .= $resultPageLinkNumber;\r\n          } else {\r\n            $resultPageLinks .= \'<a href=\"[~\' . $modx->documentObject[\'id\'] . \'~]&FSF_offset=\' . $nrp . \'&FSF_search=\' . urlencode($searchString) . \'\">\' . $resultPageLinkNumber . \'</a>\';\r\n          }\r\n          $resultPageLinks .= ($nrp+$grabMax < $limit)? $pageLinkSeparator : \'\' ;\r\n          $resultPageLinkNumber++;\r\n        }\r\n        $resultPageLinks .= \"</span>\".$newline;\r\n        $SearchForm .= \'<p class=\"FSF_pagination\">\';\r\n        $resultsFoundText = ($limit > 1)? $resultsFoundTextMultiple : $resultsFoundTextSingle ;\r\n        $SearchForm .= sprintf($resultsFoundText,$limit,$searchString);\r\n        $SearchForm .= \'<br />\'.$resultPageLinks.\"</p>\".$newline;\r\n      } // end if grabMax\r\n\r\n      // search results\r\n      $useLimit = ($grabMax > 0)? $offset+$grabMax : $limit;\r\n      for ($y = $offset; ($y < $useLimit) && ($y<$limit); $y++) {\r\n        $moveToRow = mysql_data_seek($rs,$y);\r\n        $SearchFormsrc=$modx->fetchRow($rs);\r\n        $SearchForm.=\'<div class=\"FSF_result\">\'.$newline;\r\n        $SearchForm.=\'<a class=\"FSF_resultLink\" href=\"[~\'.$SearchFormsrc[\'id\'].\'~]\" title=\"\' . $SearchFormsrc[\'pagetitle\'] . \'\">\' . $SearchFormsrc[\'pagetitle\'] . \"</a>\".$newline;\r\n        $SearchForm.=$SearchFormsrc[\'description\']!=\'\' ? \'<span class=\"FSF_resultDescription\">\' . $SearchFormsrc[\'description\'] . \"</span>\".$newline : \"\" ;\r\n        $SearchForm.=\'</div><!--end FlexSearchResult-->\'.$newline;\r\n      }\r\n      $SearchForm.=\'<p class=\"FSF_pagination\">\'.$resultPageLinks.\'</p>\';\r\n      $SearchForm.=\'</div><!--end FlexSearchResults-->\'.$newline;\r\n    } else {\r\n      $SearchForm.=\'<p class=\"FSF_resultsIntroFailure\">\'.$resultsIntroFailure.\'</p>\';\r\n    } // end if records found\r\n\r\n  } else if (!$validSearch && isset($_POST[\'sub\'])) {\r\n\r\n    // message to show if search was performed but for something invalid\r\n    $SearchForm .= \'<p class=\"FSF_resultsIntroFailure\">\'.$resultsIntroFailure.\'</p>\';\r\n    \r\n  } else { // end if validSearch\r\n\r\n    $SearchForm .= \'<p class=\"FSF_intro\">\'.$introMessage.\'</p>\';\r\n\r\n  } // end if not validSearch\r\n} // end if showResults\r\n\r\nreturn $SearchForm;','0','','');


REPLACE INTO `{PREFIX}site_snippets` VALUES ('27','NewsLister','summarize and list posts (news, blogs, etc.)','0','0','0','/**\r\n *	NewsListing \r\n *	Displays posts (articles, blogs, news items and so on).\r\n *\r\n *  Modified by Raymond Irving, Greg Matthews Mark Kaplan and Ryan Thrash:\r\n *      21-Oct-2005 footer/header removed from summaries\r\n *      12-Oct-2005 malformed tag-closing mojo and more cleanups\r\n *      11-Oct-2005 many updates inc. showPublishedOnly, summary splitter, configs and default template format\r\n *      22-Sept-2005 add &linktext support\r\n *      22-Sept-2005 add template support. Fields - [+title+],[+summary+],[+author+],[+date+],[+linkurl+]\r\n *      19-April-2005 add introtext field support\r\n *  \r\n *  TO DO: \r\n *      A BETTER NAME!!!\r\n *      support multiple calls per page\r\n *      nicer formatting, including classes and maybe a template chunk, on summary post \"show more\" links\r\n *      comment counts where applicable\r\n *      restore splitting at specified length, but not in the middle of an Anchor or Image or other tag\r\n *      evaluate date formats/server offsets\r\n *      query optimizations\r\n *      show in menu if needed ?\r\n *\r\n *  Credits:\r\n *      tag-closing mojo by Greg Matthews\r\n *      enhancements Raymond Irving, Mark Kaplan, Ryan Thrash, LePrince, mrruben5, lloyd_barrett\r\n *      original code Alex\r\n *\r\n *  Snippet parameters [default] :\r\n *      &startID       - the folder containing the posts [the document called from]\r\n *      &summarize     - number of posts to list partially/fully [3]\r\n *      &total         - max number of posts to retrieve [100] \r\n *                     \r\n *      &trunc         - truncate to summary posts? if set to false, shows entire post [true]\r\n *      &truncSplit    - use the special \"splitter\" format to truncate for summary posts [true]\r\n *      &truncAt       - the split-point splitter itself [<!-- splitter -->]\r\n *      &truncLen      - if you don\'t have a splitter or you turn that off explicitly, the number \r\n *                       of characters of the blog to show for summary if not using splitter [450] \r\n *                       However, if you have a summary of the post, it will use that instead. \r\n *                       DEPRECATED ... see below...\r\n *      &truncText     - text for the summary \"show more\" link\r\n *                     \r\n *      &comments      - whether or not the posts have comments [false]  \r\n *      &commText      - comments link text [\"Read Comments\"]  \r\n *                     \r\n *      &tpl           - name of the chunk to use for the summary view template  \r\n *      &dateformat    - the format for the summary date (see http://php.net/strftime ) [%d-%b-%y %H:%M]\r\n *      &pubOnly       - only show Published posts [true]\r\n *      &menuOnly      - only show docs with \"show in menu\" checked [true] TO BE IMPLEMENTED\r\n *      &emptytext     - text to use when no news items are found\r\n *      &archivetext   - text to use for the Post Archives listing [\"Older Items\"]\r\n *      \r\n */\r\n \r\n$resourceparent = isset($startID) ? $startID : $modx->documentIdentifier;\r\n    // the folder that contains post entries \r\n\r\n$nrposts = isset($summarize) ? $summarize : 3;\r\n    // number of posts of which to show a summary \r\n    // remainder (to nrtotal) go as an arhived/other posts list\r\n         \r\n$nrtotal = isset($total) ? $total : 100;\r\n    // total number of posts to retrieve \r\n\r\n$trunc = isset($truc) ? $trunc : true;\r\n    // should there be summary/short version of the posts?\r\n\r\n$truncsplit = isset($trucSplit) ? $truncSplit : true;\r\n    // should the post be summarized at the \"splitter\"?\r\n\r\n$splitter = isset($trucAt) ? $truncAt : \"<!-- splitter -->\";\r\n    // where to split the text \r\n\r\n//$lentoshow = isset($trucLen) ? $truncLen : 450;\r\n    // how many characters to show of blogs \r\n    // DEPRECATED: too easy to split in middle of an A tag, use splitter, above\r\n    // but left here to uncomment if you feel so inclined\r\n\r\n$tpl = isset($tpl) ? $modx->getChunk($tpl):\'\r\n    <div class=\"summaryPost\">\r\n        <h3>[+title+]</h3>\r\n        <div>[+summary+]</div>\r\n        <p>&nbsp;&nbsp;&nbsp;&nbsp;[+link+]</p>\r\n        <div style=\"text-align:right;\">by <strong>[+author+]</strong> on [+date+]</div>\r\n    </div>\r\n\';\r\n    // optional user defined chunk name to format the summary posts\r\n\r\n$showPublishedOnly = isset($pubOnly) ? $pubOnly : true;\r\n    // allows you to show unpublished docs if needed for some reason...\r\n\r\n$showInMenuOnly = isset($menuOnly) ? $menuOnly : true;\r\n    // allows you to show docs marked not to show in the menus \r\n    // if needed for some reason...\r\n    // TO BE IMPLEMENTED\r\n    \r\n$linktext = isset($truncText)? $truncText : \"More on this story >\";\r\n    // text to be displayed in news link\r\n\r\n$emptytext = isset($emptytext)? $emptytext : \'<p>No entries found.</p>\';\r\n    // text to be displayed when there are no results\r\n\r\n$comments = isset($comments)? $comments : false;\r\n    // can the posts have comments?\r\n\r\n$commText = isset($commText)? $commText : \'Comments\';\r\n    // text to be used for the comments link\r\n\r\n$date = isset($dateformat)? $dateformat :\"%d-%b-%y %H:%M\";\r\n    // format for the summary post date format\r\n\r\n$archtxt = isset($archivetext)? $archivetext :\"Older Items\";\r\n    // text to use for the Post Archives listing\r\n\r\n$commentschunk = isset($commentschunk)? \'{{\'.$commentschunk.\'}}\' : \'\';\r\n    // if you\'re using comments, the name of the chunk used to format them\r\n\r\n$debug = false;\r\n    // for testing only\r\n\r\n$output = \'\';\r\n    // initialize the blog variable \r\n\r\n$callby = ($showPublishedOnly)? \'getActiveChildren\' : \'getAllChildren\';\r\n\r\n$resource = $modx->$callby($resourceparent, \'createdon\', \'DESC\', $fields=\'id, pagetitle, description, introtext, content, createdon, createdby, hidemenu\');\r\n$limit = count($resource);\r\n$output .= ($limit < 1)? $emptytext.\"\\n\" : \'\';  \r\n$limit = min( $limit, $nrtotal ); \r\n\r\n// uncomment the following line for some very rudimentary debugging output\r\n// $output .= \"Number supposed to be summarized (nrposts/count): $nrposts<br />Total supposed to be returned (nrtotal/total): $nrtotal<br />Count of total in db (count/limit): $limit<br /><br />\";\r\n\r\n// function used to clean all the open HTML tags inside summary posts\r\n// useful so it won\'t break layouts due to there being open tags like \r\n// OL, UL, DIV, H1 or maybe even A tags for example\r\nfunction closeTags($text) { \r\n    $openPattern = \"/<([^\\/].*?)>/\";   \r\n    $closePattern = \"/<\\/(.*?)>/\"; \r\n    $endOpenPattern = \"/<([^\\/].*?)$/\"; \r\n    $endClosePattern = \"/<(\\/.*?[^>])$/\"; \r\n    $endTags=\'\'; \r\n     \r\n    preg_match_all($openPattern,$text,$openTags); \r\n    preg_match_all($closePattern,$text,$closeTags); \r\n    \r\n    if ($debug) {\r\n        print_r($openTags); \r\n        print_r($closeTags); \r\n    }\r\n    \r\n    $c=0; \r\n    $loopCounter = count($closeTags[1]);  //used to prevent an infinite loop if the html is malformed \r\n    while($c<count($closeTags[1]) && $loopCounter) { \r\n        $i=0; \r\n        while($i<count($openTags[1])) { \r\n             \r\n            $tag = trim($openTags[1][$i]); \r\n             \r\n            if(strstr($tag,\' \')) { \r\n                $tag = substr($tag,0,strpos($tag,\' \'));    \r\n            } \r\n            if ($debug) { echo $tag.\'==\'.$closeTags[1][$c].\"\\n\"; } \r\n            if($tag==$closeTags[1][$c]) { \r\n                $openTags[1][$i]=\'\'; \r\n                $c++; \r\n                break; \r\n            }    \r\n            $i++; \r\n        } \r\n        $loopCounter--; \r\n    } \r\n     \r\n    $results = $openTags[1]; \r\n     \r\n    if(is_array($results)) {  \r\n    $results = array_reverse($results); \r\n         \r\n        foreach($results as $tag) { \r\n    \r\n            $tag = trim($tag); \r\n             \r\n            if(strstr($tag,\' \')) { \r\n                $tag = substr($tag,0,strpos($tag,\' \'));    \r\n            }    \r\n            if(!stristr($tag,\'br\') && !stristr($tag,\'img\') && !empty($tag)) { \r\n                $endTags.= \'</\'.$tag.\'>\'; \r\n            } \r\n        }    \r\n    } \r\n    return $text.$endTags; \r\n}\r\n\r\nif ($nrposts > 0) { \r\n	for ($x = 0; $x < $nrposts; $x++) { \r\n		if ($resource[$x][\'createdby\']<0) {\r\n			// get web user name\r\n			$tbl = $modx->getFullTableName(\"web_users\");\r\n			$sql = \"SELECT username FROM $tbl WHERE $tbl.id = \'\".abs($resource[$x][\'createdby\']).\"\'\"; \r\n		}\r\n		else {\r\n			// get manager user name\r\n			$tbl = $modx->getFullTableName(\"manager_users\");\r\n			$sql = \"SELECT username FROM $tbl WHERE $tbl.id = \'\".$resource[$x][\'createdby\'].\"\'\";\r\n		}\r\n\r\n        //perform the query\r\n		$rs2 = $modx->dbQuery($sql);\r\n		$limit2 = $modx->recordCount($rs2); \r\n		if($limit2<1) { \r\n			$username = \"anonymous\"; \r\n		}\r\n		else { \r\n			$resourceuser = $modx->fetchRow($rs2); \r\n			$username = $resourceuser[\'username\']; \r\n		} \r\n		// determine and show summary\r\n		\r\n		// summary is turned off\r\n		if (!$trunc) {\r\n		    $summary = $resource[$x][\'content\']; \r\n		    \r\n		// contains the splitter and use splitter is on\r\n		} else if ((strstr($resource[$x][\'content\'], $splitter)) && $truncsplit) {\r\n            $summary = array();\r\n            \r\n            // HTMLarea/XINHA encloses it in paragraph\'s\r\n            $summary = explode(\'<p>\'.$splitter.\'</p>\',$resource[$x][\'content\']);\r\n            \r\n            // For TinyMCE or if it isn\'t wrapped inside paragraph tags\r\n            $summary = explode($splitter,$summary[\'0\']); \r\n\r\n            $summary = $summary[\'0\'];\r\n            $summary = closeTags($summary);\r\n            \r\n        // fall back to the summary text    \r\n		} else if (strlen($resource[$x][\'introtext\'])>0) {\r\n			$summary = $resource[$x][\'introtext\'];\r\n			\r\n		// fall back to the summary text count	\r\n		// skipping this because of ease of breaking in the middle of an A tag... \r\n		// so it\'s not a good idea. If you must have this, then uncomment\r\n		// } else if(strlen($resource[$x][\'content\']) > $lentoshow) { \r\n		// 	$summary = substr($resource[$x][\'content\'], 0, $lentoshow).\'...\'; \r\n		\r\n		// and back to where we started if all else fails (short post)\r\n		} else { \r\n			$summary = $resource[$x][\'content\']; \r\n		}  \r\n\r\n		$summary = str_replace($commentschunk,\'\',$summary); \r\n\r\n        // add the link to the full post (permalink)\r\n        $link = \'<a href=\"[~\'.$resource[$x][\'id\'].\'~]\">\'.$linktext.\'</a>\';\r\n		\r\n		$fields = array(\'[+title+]\',\'[+summary+]\',\'[+link+]\',\'[+author+]\',\'[+date+]\');\r\n		$values = array($resource[$x][\'pagetitle\'],$summary,$link,$username,strftime($date, $resource[$x][\'createdon\']));\r\n		\r\n		$output .= str_replace($fields,$values,$tpl); \r\n	} \r\n} \r\n\r\nif($limit>$nrposts) { \r\n   $output .= \"<h3>$archtxt</h3>\";\r\n   $output .= \"<ul class=\\\"archivelist\\\">\";\r\n   for ($x = $nrposts; $x < $limit; $x++) { \r\n      $output .= \"<li><a href=\'[~\".$resource[$x][\'id\'].\"~]\'>\".$resource[$x][\'pagetitle\'].\"</a></li>\";\r\n   } \r\n   $output .= \"</ul>\";\r\n}\r\n\r\nreturn $output;','0','','');


#
# Dumping data for table `site_templates`
#


REPLACE INTO `{PREFIX}site_templates` VALUES ('1','Default Template','Default template','0','0','','0','<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\r\n<head>\r\n	<title>[(site_name)] | [*pagetitle*]</title>\r\n\r\n	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\r\n\r\n	<link rel=\"stylesheet\" href=\"assets/templates/default/site.css\" type=\"text/css\" media=\"screen\" />\r\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS 2.0\" href=\"[(site_url)][~11~]\" />\r\n        <base href=\"[(site_url)]\" />\r\n\r\n<!--[if lte IE 6]>\r\n\r\n  <style type=\"text/css\" media=\"screen, tv, projection\">\r\n        body { behavior: url(assets/js/csshover.htc); } /* hover:anything support */\r\n        #content { margin-left: 22px; } /* to avoid the BMH */\r\n        a,  a:link { border-bottom-style: solid } /* becuase IE just doesn\'t dot */\r\n  </style>\r\n\r\n  <script type=\"text/javascript\" src=\"assets/js/sleight.js\"></script>\r\n\r\n<![endif]-->\r\n\r\n        <script src=\"manager/media/script/scriptaculous/prototype.js\" type=\"text/javascript\"></script>\r\n        <script src=\"manager/media/script/scriptaculous/scriptaculous.js\" type=\"text/javascript\"></script>\r\n\r\n</head>\r\n<body>\r\n\r\n<div id=\"page\">\r\n\r\n\r\n<div id=\"header\">\r\n	<div id=\"search\"><a name=\"search\"></a>\r\n		[!FlexSearchForm? &FSF_showResults=`0` &FSF_landing=`8`!]\r\n	</div>\r\n	<h1><a href=\"[~[(site_start)]~]\" title=\"[(site_name)]\">[(site_name)]</a></h1>\r\n</div>\r\n<!-- close #header -->\r\n\r\n	<div id=\"content\">\r\n\r\n		<div class=\"post\">\r\n			<h4 class=\"date-header\">[!DateTime? &format=`d-M-Y h:i A`!]</h4>\r\n			<h3 id=\"post-\">[*longtitle*]</h3>\r\n				[*#content*]\r\n		</div>\r\n		<!-- close .post (main column content) -->\r\n\r\n		<div id=\"navlist\"><a name=\"navlist\"></a>\r\n			<h3>Related Links:</h3>\r\n			[[ListRelated? &LR_title=`Other pages possibly of interest...`]]\r\n		</div>\r\n		<!-- close #navlist -->\r\n\r\n	</div>\r\n	<!-- close #content -->\r\n\r\n	<div id=\"sidebar\">\r\n		<ul>\r\n			<li><h2>About Me:</h2>\r\n			{{AboutMe}}\r\n			</li>\r\n\r\n			<li id=\"dropmenu\"><a name=\"dropmenu\"></a><h2>Pages:</h2>\r\n			[!DropMenu!]\r\n			</li>\r\n\r\n			<li id=\"recentdocs\"><a name=\"recentdocs\"></a><h2>Most Recent:</h2>\r\n                	[[ListIndexer?LIn_root=0]]\r\n			</li>\r\n\r\n			<li><h2>Meta:</h2>\r\n				<ul>\r\n				    <li><a href=\"http://validator.w3.org/check/referer\" title=\"This page validates as XHTML 1.0 Transitional\">Valid <abbr title=\"eXtensible HyperText Markup Language\">XHTML</abbr></a></li>\r\n                	<li><a href=\"http://jigsaw.w3.org/css-validator/check/referer\" title=\"This page uses valid Cascading Stylesheets\" rel=\"external\">Valid <abbr title=\"W3C Cascading Stylesheets\">css</abbr></a></li>\r\n				    <li><a href=\"http://modxcms.com/\" title=\"Powered by MODx, Do more with less.\">MOD<strong>x</strong></a></li>\r\n		        </ul>\r\n			</li>\r\n\r\n		</ul>\r\n	</div>\r\n	<!-- close #sidebar -->\r\n\r\n<div class=\"clear\">&nbsp;</div>\r\n\r\n<div id=\"footer\">\r\n	<p>\r\n		[(site_name)] is powered by\r\n		<a href=\"http://modxcms.com/\" title=\"Powered by MODx, Do more with less.\"><strong>MOD</strong>x</a>\r\n		<br /><a href=\"[~11~]\" title=\"Link to our Blog RSS Feeds\">Blog Entries (RSS)</a><br />\r\n<strong>MOD</strong>x-theme by <a href=\"http://www.liquidthemes.com\">liquidthemes</a><br />\r\nMySQL: [^qt^], [^q^] request(s), PHP: [^p^], total: [^t^], document retrieved from [^s^].\r\n	</p>\r\n</div>\r\n<!-- close #footer -->\r\n\r\n</div>\r\n<!-- close #page -->\r\n\r\n</body>\r\n</html>','0');
                                      

#
# Dumping data for table `site_tmplvars`
#


REPLACE INTO `{PREFIX}site_tmplvars` VALUES ('3','text','loginName','loginName','Conditional name for the Login menu item','0','0','0','','0','','','@EVAL if ($modx->getLoginUserID()) return \'Logout\'; else return \'Login\';');
                                     

REPLACE INTO `{PREFIX}site_tmplvars` VALUES ('2','richtext','blogContent','blogContent','RTE for the new blog entries','0','0','0','','0','richtext','&w=383px&h=450px&edt=FCKEditor','');
                                     

#
# Dumping data for table `site_tmplvar_templates`
#


REPLACE INTO `{PREFIX}site_tmplvar_templates` VALUES ('3','1');


REPLACE INTO `{PREFIX}site_tmplvar_templates` VALUES ('2','1');


#
# Dumping data for table `web_groups`
#


REPLACE INTO `{PREFIX}web_groups` VALUES ('12','2','5');


REPLACE INTO `{PREFIX}web_groups` VALUES ('14','1','1');


REPLACE INTO `{PREFIX}web_groups` VALUES ('15','2','2');


REPLACE INTO `{PREFIX}web_groups` VALUES ('7','2','3');


REPLACE INTO `{PREFIX}web_groups` VALUES ('10','2','4');


REPLACE INTO `{PREFIX}web_groups` VALUES ('13','2','6');


#
# Dumping data for table `web_user_attributes`
#


REPLACE INTO `{PREFIX}web_user_attributes` VALUES ('1','1','Site Admin','0','you@yourdomain.com','','','0','0','0','25','1129049624','1129063123','0','f426f3209310abfddf2ee00e929774b4','0','0','','','','','','');


#
# Dumping data for table `web_users`
#


REPLACE INTO `{PREFIX}web_users` VALUES ('1','siteadmin','5f4dcc3b5aa765d61d8327deb882cf99','');


#
# Dumping data for table `webgroup_access`
#


REPLACE INTO `{PREFIX}webgroup_access` VALUES ('1','1','2');


#
# Dumping data for table `webgroup_names`
#


REPLACE INTO `{PREFIX}webgroup_names` VALUES ('1','Site Admins');


REPLACE INTO `{PREFIX}webgroup_names` VALUES ('2','Registered Users');

